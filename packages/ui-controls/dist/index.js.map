{"version":3,"file":"index.js","sources":["../src/services/popups/popup-service.jsx","../src/services/popups/context-menu/context-menu.jsx"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport cx from 'classnames';\n\nimport './popup-service.css';\n\nlet _dialogOpen = false;\nconst _popups = [];\n\nfunction specialKeyHandler(e) {\n\n    if (e.keyCode === 27 /* ESC */) {\n        if (_popups.length) {\n            closeAllPopups();\n            console.log('unmount the open popup(s)');\n        } else if (_dialogOpen) {\n            console.log('unmount the open dialog');\n            ReactDOM.unmountComponentAtNode(document.body.querySelector('.react-dialog'));\n        }\n    }\n}\n\nfunction outsideClickHandler(e) {\n\n    if (_popups.length) {\n        // onsole.log(`Popup.outsideClickHandler`);\n        const popupContainers = document.body.querySelectorAll('.react-popup');\n        for (let i = 0; i < popupContainers.length; i++) {\n            if (popupContainers[i].contains(e.target)) {\n                return;\n            }\n        }\n        console.log(`close all popups`);\n        closeAllPopups();\n    }\n}\n\nfunction closeAllPopups() {\n    if (_popups.length) {\n\n        // onsole.log(`closeAllPopups`);\n        const popupContainers = document.body.querySelectorAll('.react-popup');\n        for (let i = 0; i < popupContainers.length; i++) {\n            console.log(`unmountComponentAtNode`);\n            ReactDOM.unmountComponentAtNode(popupContainers[i]);\n        }\n        popupClosed('*');\n    }\n}\n\nfunction dialogOpened() {\n    if (_dialogOpen === false) {\n        console.log('PopupService, dialog opened');\n        _dialogOpen = true;\n        window.addEventListener('keydown', specialKeyHandler, true);\n    }\n}\n\nfunction dialogClosed() {\n    if (_dialogOpen) {\n        console.log('PopupService, dialog closed');\n        _dialogOpen = false;\n        window.removeEventListener('keydown', specialKeyHandler, true);\n    }\n}\n\nfunction popupOpened(name/*, group*/) {\n    if (_popups.indexOf(name) === -1) {\n        _popups.push(name);\n        //onsole.log('PopupService, popup opened ' + name + '  popups : ' + _popups);\n        if (_dialogOpen === false) {\n            window.addEventListener('keydown', specialKeyHandler, true);\n            window.addEventListener('click', outsideClickHandler, true);\n        }\n    }\n}\n\nfunction popupClosed(name/*, group=null*/) {\n    if (_popups.length) {\n\n        if (name === '*') {\n            _popups.length = 0;\n        } else {\n            const pos = _popups.indexOf(name);\n            if (pos !== -1) {\n                _popups.splice(pos, 1);\n            }\n        }\n        //onsole.log('PopupService, popup closed ' + name + '  popups : ' + _popups);\n        if (_popups.length === 0 && _dialogOpen === false) {\n            window.removeEventListener('keydown', specialKeyHandler, true);\n            window.removeEventListener('click', outsideClickHandler, true);\n        }\n\n    }\n}\n\nexport class PopupService {\n\n    static showPopup({name='anon', group='all'/*, depth=0*/, position='', left=0, top=0, width='auto', component}) {\n\n        // onsole.log(`PopupService.showPopup ${name} in ${group} ${left} ${top} ${width} depth ${depth}`);\n\n        popupOpened(name, group);\n\n        let el = document.body.querySelector('.react-popup.' + group);\n        if (el === null) {\n            el = document.createElement('div');\n            el.className = 'react-popup ' + group;\n            document.body.appendChild(el);\n        }\n\n        const className = cx('popup-container', position);\n        ReactDOM.render(\n            <div className={className} style= {{position: 'absolute', left, top, width }}>{ component } </div>, \n            el, \n            () => {PopupService.keepWithinThePage(el);}\n        );\n    }\n\n    static hidePopup(name='anon', group='all'){\n        //onsole.log('PopupService.hidePopup name=' + name + ', group=' + group)\n\n        if (_popups.indexOf(name) !== -1) {\n            popupClosed(name, group);\n            ReactDOM.unmountComponentAtNode(document.body.querySelector(`.react-popup.${group}`));\n        }\n    }\n\n    static movePopup(x, y, name='anon', group='all'){\n        const container = document.querySelector(`.react-popup.${group} .popup-container`);\n        container.style.top = (parseInt(container.style.top,10) + y) + 'px';\n        container.style.left = (parseInt(container.style.left,10) + x) + 'px';\n    }\n\n    static keepWithinThePage(el) {\n\n        //onsole.log(`PopupService.keepWithinThePage`);\n\n        const container = el.querySelector('.popup-container');\n        const {top, left, width, height} = container.firstChild.getBoundingClientRect();\n\n        const w = window.innerWidth;\n        const h = window.innerHeight;\n\n        const overflowH = h - (top + height);\n        if (overflowH < 0) {\n            container.style.top = (parseInt(container.style.top,10) + overflowH) + 'px';\n        }\n\n        const overflowW = w - (left + width);\n        if (overflowW < 0) {\n            container.style.left = (parseInt(container.style.left,10) + overflowW) + 'px';\n        }\n\n    }\n}\n\nexport class DialogService {\n\n    static showDialog(dialog) {\n\n        const containerEl = '.react-dialog';\n        const onClose = dialog.props.onClose;\n\n        dialogOpened();\n\n        ReactDOM.render(React.cloneElement(dialog, {\n            container: containerEl,\n            onClose: () => {\n                DialogService.closeDialog();\n                if (onClose) {\n                    onClose();\n                }\n            }\n        }),\n            document.body.querySelector(containerEl)\n        );\n\n    }\n\n    static closeDialog() {\n        dialogClosed();\n        ReactDOM.unmountComponentAtNode(document.body.querySelector('.react-dialog'));\n    }\n}\n\nexport class Popup extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.pendingTask = null;\n    }\n\n    render() {\n        return <div className='popup-proxy' > </div>;\n    }\n\n    componentDidMount() {\n\n        const domNode = ReactDOM.findDOMNode(this);\n        if (domNode) {\n            const el = domNode.parentElement;\n            const boundingClientRect = el.getBoundingClientRect();\n            //onsole.log(`%cPopup.componentDidMount about to call show`,'color:green');\n            this.show(this.props, boundingClientRect);\n        }\n\n    }\n\n    componentWillUnmount() {\n        PopupService.hidePopup(this.props.name, this.props.group);\n    }\n\n    componentWillReceiveProps(nextProps) {\n\n        const domNode = ReactDOM.findDOMNode(this);\n        if (domNode) {\n            const el = domNode.parentElement;\n            const boundingClientRect = el.getBoundingClientRect();\n            //onsole.log(`%cPopup.componentWillReceiveProps about to call show`,'color:green');\n            this.show(nextProps, boundingClientRect);\n        }\n    }\n\n    show(props, boundingClientRect) {\n\n        const {name, group, depth, width} = props;\n        let left, top;\n\n        if (this.pendingTask) {\n            clearTimeout(this.pendingTask);\n            this.pendingTask = null;\n        }\n\n        if (props.close === true) {\n            console.log('Popup.show hide popup name=' + name + ', group=' + group + ',depth=' + depth);\n            PopupService.hidePopup(name, group);\n        } else {\n            const {position, children: component} = props;\n            const {left: targetLeft, top: targetTop, width: clientWidth, bottom: targetBottom} = boundingClientRect;\n\n            if (position === 'below') {\n                left = targetLeft;\n                top = targetBottom;\n            } else if (position === 'above') {\n                left = targetLeft;\n                top = targetTop;\n            }\n\n            console.log('%cPopup.show about to setTimeout', 'color:red;font-weight:bold');\n            this.pendingTask = setTimeout(() => {\n                console.log(`%c...timeout fires`, 'color:red;font-weight:bold');\n                PopupService.showPopup({ name, group, depth, position, left, top, width: width || clientWidth, component });\n            }, 10);\n        }\n\n    }\n}\n","import * as React from 'react';\nimport cx from 'classnames';\nimport { PopupService } from '../popup-service.jsx';\nimport './context-menu.css';\n\nlet subMenuTimeout = null;\n\nexport class MenuItem extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state = {\n            hasChildMenuItems: props.children && props.children.length > 0\n    };\n    }\n\n    render() {\n\n        const nestedMenu = this.props.submenuShowing ?\n            <ContextMenu doAction={this.props.doAction}>{this.props.children}</ContextMenu> :\n            null;\n\n        const className = cx(\n            'menu-item', {\n                disabled: this.props.disabled,\n                root: this.state.hasChildMenuItems,\n                showing: this.props.submenuShowing\n            }\n        );\n\n        return (\n            <li className={className}>\n                <button tabIndex={-1} onClick={e => this.handleClick(e)}\n                    onMouseOver={() => this.handleMouseOver()}>\n                    <span className=\"menu-label\">{this.props.label}</span>\n                    <i className='material-icons'>{this.state.hasChildMenuItems ? 'arrow_right' : ''}</i>\n                </button>\n                {nestedMenu}\n            </li>\n        );\n    }\n\n    handleClick(e){\n        e.preventDefault();\n        if (this.props.disabled !== true) {\n            this.props.doAction(this.props.action, this.props.data);\n        }\n    }\n\n    handleMouseOver() {\n        this.props.onMouseOver(this.props.idx, this.state.hasChildMenuItems, this.props.submenuShowing);\n    }\n\n}\n\nexport const Separator = () => <li className='divider'></li>;\n\nexport class ContextMenu extends React.Component {\n\n\n    constructor(props){\n        super(props);\n        this.state = {\n            left: props.left,\n            top: props.top,\n            bottom: props.bottom,\n            submenuShowing: false,\n            submenuIdx: null\n        };\n    }\n\n    render() {\n\n        const {top, left, bottom} = this.state;\n        const children = this.props.children;\n        const style = { position: 'absolute', top, left, bottom };\n        const submenuIdx = this.state.submenuShowing ? this.state.submenuIdx : -1;\n        const menuItems = children ? children.map((menuItem, idx) => React.cloneElement(menuItem, {\n            key: String(idx),\n            idx,\n            action: menuItem.props.action,\n            doAction: (key, data) => this.handleMenuAction(key, data),\n            onMouseOver: (idx, hasChildMenuItems) => this.handleMenuItemMouseOver(idx, hasChildMenuItems),\n            submenuShowing: submenuIdx === idx\n\n        })) : null;\n\n        return <ul className='popup-menu' style={style}>{menuItems}</ul>;\n\n    }\n\n    componentWillReceiveProps(nextProps) {\n\n        if (nextProps.left !== '100%' && nextProps.top !== 0) {\n\n            if (nextProps.left !== this.state.left || nextProps.top !== this.state.top) {\n\n                this.setState({\n                    left: nextProps.left,\n                    top: nextProps.top,\n                    submenuShowing: false,\n                    submenuIdx: null\n                });\n\n            }\n        }\n    }\n\n    handleMenuAction(key, data){\n        if (this.props.doAction) {\n            this.props.doAction(key, data);\n        } else if (this.props.onAction) {\n            this.props.onAction(key, data);\n        }\n        this.close();\n    }\n\n    handleMenuItemMouseOver(idx, hasChildMenuItems){\n\n        if (subMenuTimeout) {\n            clearTimeout(subMenuTimeout);\n            subMenuTimeout = null;\n        }\n\n        if (hasChildMenuItems) {\n            if (this.state.submenuShowing !== true) {\n                subMenuTimeout = setTimeout(() => this.showSubmenu(), 400);\n            }\n            this.setState({\n                submenuIdx: idx\n            });\n        } else if (this.state.submenuIdx !== null) {\n            this.setState({\n                submenuIdx: null,\n                submenuShowing: false\n            });\n        }\n    }\n\n    showSubmenu(){\n        subMenuTimeout = null;\n        this.setState({\n            submenuShowing: true\n        });\n    }\n\n    close() {\n        PopupService.hidePopup();\n    }\n\n\n}\n\nContextMenu.defaultProps = {\n    left: '100%',\n    top: 0,\n    bottom: 'auto'\n};\n"],"names":["_dialogOpen","_popups","specialKeyHandler","e","keyCode","length","closeAllPopups","console","log","ReactDOM","unmountComponentAtNode","document","body","querySelector","outsideClickHandler","popupContainers","querySelectorAll","i","contains","target","popupClosed","dialogOpened","window","addEventListener","dialogClosed","removeEventListener","popupOpened","name","indexOf","push","pos","splice","PopupService","showPopup","group","position","left","top","width","component","el","createElement","className","appendChild","cx","render","React","keepWithinThePage","hidePopup","movePopup","x","y","container","style","parseInt","height","firstChild","getBoundingClientRect","w","innerWidth","h","innerHeight","overflowH","overflowW","DialogService","showDialog","dialog","containerEl","onClose","props","cloneElement","closeDialog","Popup","Component","constructor","pendingTask","componentDidMount","domNode","findDOMNode","parentElement","boundingClientRect","show","componentWillUnmount","componentWillReceiveProps","nextProps","depth","clearTimeout","close","children","targetLeft","targetTop","clientWidth","bottom","targetBottom","setTimeout","subMenuTimeout","MenuItem","state","hasChildMenuItems","nestedMenu","submenuShowing","React.createElement","doAction","disabled","root","showing","handleClick","handleMouseOver","label","preventDefault","action","data","onMouseOver","idx","Separator","ContextMenu","submenuIdx","menuItems","map","menuItem","key","String","handleMenuAction","handleMenuItemMouseOver","setState","onAction","showSubmenu","defaultProps"],"mappings":"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"}