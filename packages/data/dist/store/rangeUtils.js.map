{
  "version": 3,
  "sources": ["../../src/store/rangeUtils.ts"],
  "sourcesContent": ["export const NULL_RANGE = {lo: 0,hi: 0};\n\n// If the requested range overlaps the last sent range, we only need send the\n// newly exposed section of the range. The client will manage dropping off\n// the expired section.\n//\n// |----------------------------------| _range\n//  ++++++|----------------------------------| prevRange\n//  \n//\n//\n//  |------------------------------------| _range\n//  |----------------------------------|+  prevRange\n//TODO do we still need these calls to getFullRange ?\nexport function getDeltaRange(oldRange, newRange){\n    const {lo: oldLo, hi: oldHi} = oldRange /*getFullRange(oldRange)*/;\n    const {lo: newLo, hi: newHi} = newRange /*getFullRange(newRange)*/;\n\n    if (newLo >= oldLo && newHi <= oldHi){\n        // reduced range, no delta\n        return {lo: newHi, hi: newHi};\n\n    } else if (newLo >= oldHi || newHi < oldLo){\n        return {lo: newLo, hi: newHi};\n    } else if (newLo === oldLo && newHi === oldHi){\n        return {lo: oldHi,hi: oldHi};\n    } else {\n        return {\n            lo: newLo < oldLo ? newLo: oldHi,\n            hi: newHi > oldHi ? newHi: oldLo\n        };\n    }\n}\n\nexport function resetRange({lo,hi,bufferSize=0}){\n    return {\n        lo: 0,\n        hi: hi-lo,\n        bufferSize,\n        reset: true\n    };\n}\n\nexport function getFullRange({lo,hi,bufferSize=0}){\n    return {\n        lo: Math.max(0, lo - bufferSize),\n        hi: hi + bufferSize\n    };\n}\n\nexport function withinRange(range, index, offset=0) {\n    return index-offset >= range.lo && index-offset < range.hi;\n}\n\nconst SAME = 0;\nconst FWD = 2;\nconst BWD = 4;\nconst CONTIGUOUS = 8;\nconst OVERLAP = 16;\nconst REDUCE = 32;\nconst EXPAND = 64;\nconst NULL = 128;\n\nexport const RangeFlags = {\n    SAME,\n    FWD,\n    BWD,\n    CONTIGUOUS,\n    OVERLAP,\n    REDUCE,\n    EXPAND,\n    NULL\n}\n\nRangeFlags.GAP = ~(CONTIGUOUS | OVERLAP | REDUCE)\n\nexport function compareRanges(range1, range2){\n    if (range2.lo === 0 && range2.hi === 0){\n        return NULL;\n    } else if (range1.lo === range2.lo && range1.hi === range2.hi){\n        return SAME;\n    } else if (range2.hi > range1.hi){\n        if (range2.lo > range1.hi){\n            return FWD;\n        } else if (range2.lo === range1.hi){\n            return FWD + CONTIGUOUS;\n        } else if (range2.lo >= range1.lo){\n            return FWD + OVERLAP;\n        } else {\n            return EXPAND;\n        }\n    } else if (range2.lo < range1.lo){\n        if (range2.hi < range1.lo){\n            return BWD;\n        } else if (range2.hi === range1.lo){\n            return BWD + CONTIGUOUS;\n        } else if (range2.hi > range1.lo){\n            return BWD + OVERLAP;\n        } else {\n            return EXPAND;\n        }\n    } else if (range2.lo > range1.lo) {\n        return REDUCE + FWD;\n    } else {\n        return REDUCE + BWD\n    }\n}\n"],
  "mappings": "AAAO,MAAM,aAAa,EAAC,IAAI,GAAE,IAAI,EAAC;AAc/B,SAAS,cAAc,UAAU,UAAS;AAC7C,QAAM,EAAC,IAAI,OAAO,IAAI,MAAK,IAAI;AAC/B,QAAM,EAAC,IAAI,OAAO,IAAI,MAAK,IAAI;AAE/B,MAAI,SAAS,SAAS,SAAS,OAAM;AAEjC,WAAO,EAAC,IAAI,OAAO,IAAI,MAAK;AAAA,EAEhC,WAAW,SAAS,SAAS,QAAQ,OAAM;AACvC,WAAO,EAAC,IAAI,OAAO,IAAI,MAAK;AAAA,EAChC,WAAW,UAAU,SAAS,UAAU,OAAM;AAC1C,WAAO,EAAC,IAAI,OAAM,IAAI,MAAK;AAAA,EAC/B,OAAO;AACH,WAAO;AAAA,MACH,IAAI,QAAQ,QAAQ,QAAO;AAAA,MAC3B,IAAI,QAAQ,QAAQ,QAAO;AAAA,IAC/B;AAAA,EACJ;AACJ;AAEO,SAAS,WAAW,EAAC,IAAG,IAAG,aAAW,EAAC,GAAE;AAC5C,SAAO;AAAA,IACH,IAAI;AAAA,IACJ,IAAI,KAAG;AAAA,IACP;AAAA,IACA,OAAO;AAAA,EACX;AACJ;AAEO,SAAS,aAAa,EAAC,IAAG,IAAG,aAAW,EAAC,GAAE;AAC9C,SAAO;AAAA,IACH,IAAI,KAAK,IAAI,GAAG,KAAK,UAAU;AAAA,IAC/B,IAAI,KAAK;AAAA,EACb;AACJ;AAEO,SAAS,YAAY,OAAO,OAAO,SAAO,GAAG;AAChD,SAAO,QAAM,UAAU,MAAM,MAAM,QAAM,SAAS,MAAM;AAC5D;AAEA,MAAM,OAAO;AACb,MAAM,MAAM;AACZ,MAAM,MAAM;AACZ,MAAM,aAAa;AACnB,MAAM,UAAU;AAChB,MAAM,SAAS;AACf,MAAM,SAAS;AACf,MAAM,OAAO;AAEN,MAAM,aAAa;AAAA,EACtB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEA,WAAW,MAAM,EAAE,aAAa,UAAU;AAEnC,SAAS,cAAc,QAAQ,QAAO;AACzC,MAAI,OAAO,OAAO,KAAK,OAAO,OAAO,GAAE;AACnC,WAAO;AAAA,EACX,WAAW,OAAO,OAAO,OAAO,MAAM,OAAO,OAAO,OAAO,IAAG;AAC1D,WAAO;AAAA,EACX,WAAW,OAAO,KAAK,OAAO,IAAG;AAC7B,QAAI,OAAO,KAAK,OAAO,IAAG;AACtB,aAAO;AAAA,IACX,WAAW,OAAO,OAAO,OAAO,IAAG;AAC/B,aAAO,MAAM;AAAA,IACjB,WAAW,OAAO,MAAM,OAAO,IAAG;AAC9B,aAAO,MAAM;AAAA,IACjB,OAAO;AACH,aAAO;AAAA,IACX;AAAA,EACJ,WAAW,OAAO,KAAK,OAAO,IAAG;AAC7B,QAAI,OAAO,KAAK,OAAO,IAAG;AACtB,aAAO;AAAA,IACX,WAAW,OAAO,OAAO,OAAO,IAAG;AAC/B,aAAO,MAAM;AAAA,IACjB,WAAW,OAAO,KAAK,OAAO,IAAG;AAC7B,aAAO,MAAM;AAAA,IACjB,OAAO;AACH,aAAO;AAAA,IACX;AAAA,EACJ,WAAW,OAAO,KAAK,OAAO,IAAI;AAC9B,WAAO,SAAS;AAAA,EACpB,OAAO;AACH,WAAO,SAAS;AAAA,EACpB;AACJ;",
  "names": []
}
