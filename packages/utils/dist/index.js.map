{"version":3,"file":"index.js","sources":["../src/event-emitter.js","../src/logging.js","../src/uuid.js"],"sourcesContent":["const MAX_LISTENERS = 10;\n\nexport class EventEmitter {\n\n    constructor() {\n        this._events = {};\n        this._maxListeners = MAX_LISTENERS;\n    }\n\n    addListener(type, listener) {\n        let m;\n\n        if (!isFunction(listener)) {\n            throw TypeError('listener must be a function');\n        }\n\n        if (!this._events) {\n            this._events = {};\n        }\n\n        // To avoid recursion in the case that type === \"newListener\"! Before\n        // adding it to the listeners, first emit \"newListener\".\n        if (this._events.newListener) {\n            this.emit('newListener', type, listener);\n        }\n\n        if (!this._events[type]) {\n            // Optimize the case of one listener. Don't need the extra array object.\n            this._events[type] = listener;\n        } else if (Array.isArray(this._events[type])) {\n            // If we've already got an array, just append.\n            this._events[type].push(listener);\n        } else {\n            // Adding the second element, need to change to array.\n            this._events[type] = [this._events[type], listener];\n        }\n\n        // Check for listener leak\n        if (Array.isArray(this._events[type]) && !this._events[type].warned) {\n            if (!isUndefined(this._maxListeners)) {\n                m = this._maxListeners;\n            } else {\n                m = MAX_LISTENERS;\n            }\n\n            if (m && m > 0 && this._events[type].length > m) {\n                this._events[type].warned = true;\n                console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                this._events[type].length);\n            }\n        }\n\n        return this;\n\n    }\n\n    removeListener(type, listener) {\n        let list, position, length, i;\n\n        if (!isFunction(listener)) {\n            throw TypeError('listener must be a function');\n        }\n\n        if (!this._events || !this._events[type]) {\n            return this;\n        }\n\n        list = this._events[type];\n        length = list.length;\n        position = -1;\n\n        if (list === listener ||\n            (isFunction(list.listener) && list.listener === listener)) {\n            delete this._events[type];\n            if (this._events.removeListener) {\n                this.emit('removeListener', type, listener);\n            }\n\n        } else if (Array.isArray(list)) {\n            for (i = length; i-- > 0;) {\n                if (list[i] === listener ||\n                    (list[i].listener && list[i].listener === listener)) {\n                    position = i;\n                    break;\n                }\n            }\n\n            if (position < 0) {\n                return this;\n            }\n\n            if (list.length === 1) {\n                list.length = 0;\n                delete this._events[type];\n            } else {\n                list.splice(position, 1);\n            }\n\n            if (this._events.removeListener) {\n                this.emit('removeListener', type, listener);\n            }\n        }\n\n        return this;\n\n    }\n\n    removeAllListeners(type) {\n\n        if (!this._events) {\n            return this;\n        }\n\n        const listeners = this._events[type];\n\n        if (isFunction(listeners)) {\n            this.removeListener(type, listeners);\n        } else if (listeners) {\n            // LIFO order\n            while (listeners.length) {\n                this.removeListener(type, listeners[listeners.length - 1]);\n            }\n        }\n        delete this._events[type];\n\n        return this;\n\n    }\n\n    emit(type, ...args) {\n\n        if (!this._events) {\n            this._events = {};\n        }\n\n        // If there is no 'error' event listener then throw.\n        if (type === 'error') {\n            if (!this._events.error ||\n                (isObject(this._events.error) && !this._events.error.length)) {\n                const err = arguments[1];\n                if (err instanceof Error) {\n                    throw err; // Unhandled 'error' event\n                } else {\n                    // At least give some kind of context to the user\n                    throw new Error('Uncaught, unspecified \"error\" event. (' + err + ')');\n                }\n            }\n        }\n\n        const handler = this._events[type];\n\n        if (isUndefined(handler)) {\n            return false;\n        }\n\n        if (isFunction(handler)) {\n            switch (args.length) {\n                // fast cases\n                case 0:\n                    handler.call(this);\n                    break;\n                case 1:\n                    handler.call(this, type, args[0]);\n                    break;\n                case 2:\n                    handler.call(this, type, args[0], args[1]);\n                    break;\n                // slower\n                default:\n                    handler.call(this, type, ...args);\n            }\n        } else if (Array.isArray(handler)) {\n            handler.slice().forEach(listener => listener.call(this, type, ...args));\n        }\n\n        return true;\n\n    }\n\n    once(type, listener) {\n\n        const handler = (evtName, message) => {\n            this.removeListener(evtName, handler);\n            listener(evtName, message);\n        };\n\n        this.on(type, handler);\n\n    }\n\n    on(type, listener) {\n        return this.addListener(type, listener);\n    }\n\n}\n\nfunction isFunction(arg) {\n    return typeof arg === 'function';\n}\n\nfunction isObject(arg) {\n    return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n    return arg === void 0;\n}\n","export const logColor = {\n  plain : 'color: black; font-weight: normal',\n  blue : 'color: blue; font-weight: bold',\n  brown : 'color: brown; font-weight: bold',\n  green : 'color: green; font-weight: bold',\n}\n\nconst {plain} = logColor;\nexport const createLogger = (source, labelColor=plain, msgColor=plain) => ({\n  log: (msg, args='') => console.log(`[${Date.now()}]%c[${source}] %c${msg}`,labelColor, msgColor, args),\n  warn: (msg) => console.warn(`[${source}] ${msg}`)\n})\n","import crypto from 'crypto';\n\nexport default function uuid(){\n return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n    (c ^ (crypto.randomBytes(1)[0] & (15 >> (c / 4)))).toString(16)\n  );\n}\n"],"names":[],"mappings":"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"}