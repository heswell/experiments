{"version":3,"file":"index.js","sources":["../src/componentRegistry.js","../src/util/component-utils.js","../src/component-header.js","../src/popup.js","../src/context-menu.js","../src/componentContextMenu.js","../src/redux/actions.js","../src/model/boxModel.js","../src/model/pathUtils.js","../src/model/layoutTypes.js","../src/model/layoutUtils.js","../src/model/layoutModel.js","../src/layout-item.js","../src/drop-menu.js","../src/drop-target-canvas.js","../src/drop-target.js","../src/drag-state.js","../src/draggable.js","../src/container.js","../src/splitter.js","../src/flexbox.js","../src/tabstrip.js","../src/tabbed-container.js","../src/component.js","../src/placeHolder.js","../src/util/componentFromLayout.js","../src/dynamic-container.js","../src/surface.js","../src/dragSurface.js","../src/components/ComponentIcon.js","../src/redux/layoutReducer.js","../src/application.js"],"sourcesContent":["const _containers = {};\n\nexport const ComponentRegistry = {};\n\nexport function isContainer(className){\n    return _containers[className] === true;\n}\n\nexport function registerClass(className, component, isContainer){\n    ComponentRegistry[className] = component;\n\n    if (isContainer){\n        _containers[className] = true;\n    }\n}\n","import React from 'react';\n\nimport shallowCloneObject from './shallowCloneObject';\nconst UUID = require('pure-uuid');\nimport {isContainer} from '../componentRegistry';\n\nexport function typeOf(element){\n\n\tvar type;\n\n\n\n\tif (typeof element.type === 'function'){\n\t\ttype = element.type.displayName || element.type.name; \n\t}  \n\telse if (typeof element.type === 'string'){\n\t\ttype = element.type;\n\t}\n\telse if (element.constructor){\n\t\ttype = element.constructor.displayName; \n\t}\n\telse {\n\t\tdebugger;\n\t}\n\n\treturn type;\n\n}\n\n//TODO components should be able to register props here\nconst LayoutProps = {\n\tresizeable: true,\n\theader: true,\n\ttitle: true,\n\tactive: true,\n\ttabstripHeight: true,\n\tdragStyle: true\n}\n\nfunction layoutProps({props}){\n\tconst results = {};\n\tObject.entries(props).forEach(([key, value]) => {\n\t\t\tif (LayoutProps[key]){\n\t\t\t\t\tresults[key] = value;\n\t\t\t}\n\t})\n\treturn results;\n}\n\n\nexport const getLayoutModel = (component) => ({\n\ttype: typeOf(component),\n\t$id: component.props.id || new UUID(1),\n\t...layoutProps(component),\n\tstyle: component.props.style,\n\tchildren: isLayout(component) ? getLayoutModelChildren(component) : []\n})\n\nfunction getLayoutModelChildren(component){\n\tvar {children, contentModel=null} = component.props;\n\t// TODO don't recurse into children of non-layout\n\tif (React.isValidElement(children)){\n\t\t\treturn [getLayoutModel(children)];\n\t} else if (Array.isArray(children)){\n\t\t\treturn children.filter(child => child).map(child => getLayoutModel(child));\n\t} else if (contentModel !== null){\n\t\t\treturn [contentModel];\n\t} else {\n\t\t\treturn []; // is this safe ?\n\t}\n}\n\nexport function isLayout(element){\n\tif (typeof element !== 'string'){\n\t\t\telement = (element.type && element.type.displayName) ||\n\t\t\t\t\t(element.constructor && element.constructor.displayName);\n\t}\n\treturn isContainer(element);\n}\n\n\nexport function JSONfromComponent(component, parent, ignoreChildren){\n\n\tvar props = component.props;\n\tvar type;\n\tvar flexDirection;\n\n\tif (parent != null){\n\t\n\t\t// var parentType = (parent.type || parent.constructor).displayName;\n\t\t\n\t\t// var flexDirection = parent.props.flexDirection;\n\n\t\t// var dim = flexDirection === 'row' ? 'width' : 'height';\n\n\t}\n\t\n\tif (typeof component.type === 'function'){\n\t\ttype = component.type.displayName || component.type.name; \n\t}  \n\telse if (typeof component.type === 'string'){\n\t\ttype = component.type;\n\t}\n\telse if (component.constructor){\n\t\ttype = component.constructor.displayName; \n\t}\n\telse {\n\t\tdebugger;\n\t}\n\n\n\tvar json = { type, id: new UUID(1), flexDirection};\n\n\t// var props = component.props;\n\tvar propertyNames = Object.getOwnPropertyNames(props);\n\n\tpropertyNames.forEach(property => {\n\n\t\tif (property === 'children' && ignoreChildren !== true){\n\t\t\tvar content = json.content = [];\n\t\t\tReact.Children.forEach(props.children, child => \n\t\t\t\tcontent.push(JSONfromComponent(child,component))\n\t\t\t);\n\t\t}\n\t\telse if (property === 'style'){\n\t\t\tjson.style = shallowCloneObject(props.style);\n\t\t}\n\t\telse if (isSimpleType(typeof props[property])){\n\t\t\tjson[property] = props[property];\n\t\t}\n\t\t// EXPERIMENT\n\t\telse if (Array.isArray(props[property])){\n\t\t\tjson[property] = props[property];\n\t\t}\n\t\telse if (typeof props[property] === 'function'){\n\t\t\tconsole.log('How do we deal with function props like ' + property);\n\t\t\tjson[property] = props[property];\n\t\t}\n\t});\n\n\treturn json;\n}\n\nfunction isSimpleType(type){\n\treturn type === 'string' || type === 'number' || type === 'boolean';\n}\n\n// function isLayoutType(type){\n// \treturn type === 'FlexBox' || type === 'TabbedContainer';\n// }\n","import React from 'react';\n// import Icon from 'react-icons/lib/fa/ellipsis-v';\nimport './component-header.css';\n\nexport default class ComponentHeader extends React.Component {\n\n    render() {\n\n        var { style, fixed, minimized, onMouseDown, menu = true } = this.props;\n\n        return (\n            <header className=\"ComponentHeader\" onMouseDown={onMouseDown} style={style}>\n                <span className=\"title\">{this.props.title}</span>\n                {fixed && !minimized ? <span className=\"icon-pushpin\"></span> : null}\n                {menu && <button className=\"icon-menu\" data-key=\"menu\"\n                    onClick={e => this.handleMenuClick(e)}>\n                    {/* <Icon /> */}\n                </button>}\n            </header>\n        );\n    }\n\n    handleMenuClick(e){\n        if (this.props.onAction) {\n            this.props.onAction('menu', { left: e.clientX, top: e.clientY });\n        }\n    }\n\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport cx from 'classnames';\n\nvar _dialogOpen = false;\nvar _popups = [];\n\nfunction specialKeyHandler(e){\n\n\tif (e.keyCode === 27 /* ESC */){\n\t\tif (_popups.length){\n\t\t\tcloseAllPopups();\n\t\t\tconsole.log('unmount the open popup(s)');\n\t\t}\n\t\telse if (_dialogOpen){\n\t\t\tconsole.log('unmount the open dialog');\n\t\t\tReactDOM.unmountComponentAtNode(document.body.querySelector('.react-dialog'));\n\t\t}\n\t}\n}\n\nfunction outsideClickHandler(e){\n\n\tif (_popups.length){\n\t\tconsole.log(`Popup.outsideClickHandler`);\n\t\tvar popupContainers = document.body.querySelectorAll('.react-popup');\n\t\tfor (var i=0;i<popupContainers.length;i++){\n\t\t\tif (popupContainers[i].contains(e.target)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tcloseAllPopups();\n\t}\n}\n\nfunction closeAllPopups(){\n\tif (_popups.length){\n\n\t\tconsole.log(`closeAllPopups`);\n\t\tvar popupContainers = document.body.querySelectorAll('.react-popup');\n\t\tfor (var i=0;i<popupContainers.length;i++){\n\t\t\tconsole.log(`unmountComponentAtNode`);\n\t\t\tReactDOM.unmountComponentAtNode(popupContainers[i]);\n\t\t}\n\t\tpopupClosed('*');\n\t}\t\n}\n\nfunction dialogOpened(){\n\tif (_dialogOpen === false){\n\t\tconsole.log('PopupService, dialog opened');\n\t\t_dialogOpen = true;\n\t\twindow.addEventListener('keydown', specialKeyHandler, true);\n\t}\n}\n\nfunction dialogClosed(){\n\tif (_dialogOpen){\n\t\tconsole.log('PopupService, dialog closed');\n\t\t_dialogOpen = false;\n\t\twindow.removeEventListener('keydown', specialKeyHandler, true);\n\t}\n}\n\nfunction popupOpened(name/*, group*/){\n\tif (_popups.indexOf(name) === -1){\n\t\t_popups.push(name);\n\t\t//onsole.log('PopupService, popup opened ' + name + '  popups : ' + _popups);\n\t\tif (_dialogOpen === false){\n\t\t\twindow.addEventListener('keydown', specialKeyHandler, true);\n\t\t\twindow.addEventListener('click', outsideClickHandler, true);\n\t\t}\n\t}\n}\n\nfunction popupClosed(name/*, group*/){\n\tif (_popups.length){\n\n\t\tif (name === '*'){\n\t\t\t_popups.length = 0;\n\t\t}\n\t\telse {\n\t\t\tvar pos = _popups.indexOf(name);\n\t\t\tif (pos !== -1){\n\t\t\t\t_popups.splice(pos,1);\n\t\t\t}\n\t\t}\n\t\t//onsole.log('PopupService, popup closed ' + name + '  popups : ' + _popups);\n\n\t\tif (_popups.length === 0 && _dialogOpen === false){\n\t\t\twindow.removeEventListener('keydown', specialKeyHandler, true);\n\t\t\twindow.removeEventListener('click', outsideClickHandler, true);\n\t\t}\n\n\t}\n}\n\nexport class PopupService {\n\n\tstatic showPopup({name, group/*, depth*/, position, left, top, width, component}){\n\n\t\t//onsole.log(`PopupService.showPopup ${name} in ${group} ${left} ${top} ${width}`);\n\n\t\tpopupOpened(name || 'anon', group);\n\n\t\tvar el;\n\n\t\tif (group){\n\t\t\tel = document.body.querySelector('.react-popup.' + group);\n\t\t\tif (el === null){\n\t\t\t\tel = document.createElement('div');\n\t\t\t\tel.className = \"react-popup \" + group;\n\t\t\t\tdocument.body.appendChild(el);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tel = document.body.querySelector('#react-popup');\n\t\t\tif (!el){\n\t\t\t\tel = document.createElement('div');\n\t\t\t\tel.id = \"react-popup\";\n\t\t\t\tel.className = 'react-popup';\n\t\t\t\tdocument.body.appendChild(el);\n\t\t\t}\n\t\t}\n\n\t\tvar className = cx('popup-container', position);\n\t\tReactDOM.render(\n\t\t\t<div className={className} style={{position:'absolute',left,top,width}}>{component}</div>, el, () => {\n\t\t\t\tkeepWithinThePage(el);\n\t\t\t}\n\t\t);\n\t}\n\n\tstatic hidePopup(name, group){\n\n\t\t//onsole.log('PopupService.hidePopup name=' + name + ', group=' + group)\n\n\t\tname = name || 'anon';\n\n\t\tif (_popups.indexOf(name) !== -1){\n\t\t\tpopupClosed(name || 'anon', group);\n\t\t\tvar query = group ? `.react-popup.${group}` : '#react-popup';\n\t\t\tReactDOM.unmountComponentAtNode(document.body.querySelector(query));\n\t\t}\n\t\telse {\n\t\t\tconsole.log('... no popup by that name here');\n\t\t}\n\n\t}\n}\n\nexport class DialogService {\n\n\tstatic showDialog(dialog){\n\n\t\tvar containerEl = '.react-dialog';\n\n\t\tvar onClose = dialog.props.onClose; \n\n\t\tdialogOpened();\n\n\t\tReactDOM.render(React.cloneElement(dialog, {\n\t\t\t\tcontainer: containerEl,\n\t\t\t\tonClose : () => {\n\t\t\t\t\tDialogService.closeDialog();\n\t\t\t\t\tif (onClose) onClose();\n\t\t\t\t}\n\t\t\t}),\n\t\t\tdocument.body.querySelector(containerEl)\n\t\t);\n\n\t}\n\n\tstatic closeDialog(){\n\t\tdialogClosed();\n\t\tReactDOM.unmountComponentAtNode(document.body.querySelector('.react-dialog'));\n\t}\n}\n\nexport class Popup extends React.Component {\n\t\n\n\trender(){\n\t\treturn <div className=\"popup-proxy\"></div>\n\t}\n\n\tcomponentDidMount(){\n\n\t\tvar domNode = ReactDOM.findDOMNode(this);\n\t\tif (domNode){\n\t\t\tvar boundingClientRect = domNode.parentNode.getBoundingClientRect();\n\t\t}\n\t\t\n\t\t//onsole.log(`%cPopup.componentDidMount about to call show`,'color:green');\n\n\t\tthis.show(this.props, boundingClientRect);\n\t}\n\n\tcomponentWillUnmount(){\n\t\tPopupService.hidePopup(this.props.name, this.props.group);\n\t}\n\n\tcomponentWillReceiveProps(nextProps){\n\n\t\tvar domNode = ReactDOM.findDOMNode(this);\n\t\tif (domNode){\n\t\t\tvar boundingClientRect = domNode.parentNode.getBoundingClientRect();\n\t\t}\n\n\t\t//onsole.log(`%cPopup.componentWillReceiveProps about to call show`,'color:blue');\n\n\t\tthis.show(nextProps, boundingClientRect);\n\t}\n\n\tshow(props, boundingClientRect){\n\n\t\tvar {name, group, depth, width} = props;\n\n\t\tvar left, top/*, bottom*/;\n\n\t\tif (this.pendingTask){\n\t\t\tclearTimeout(this.pendingTask);\n\t\t\tthis.pendingTask = null;\n\t\t}\n\n\t\tif (props.close === true){\n\t\t\tconsole.log('Popup.show hide popup name=' + name + ', group=' + group + ',depth=' + depth);\n\t\t\tPopupService.hidePopup(name, group);\n\t\t}\n\t\telse {\n\t\t\tvar {position, children:component} = props;\n\n\t\t\tvar {left:targetLeft,top:targetTop,width:clientWidth,/*height,*/bottom:targetBottom/*,right*/} = boundingClientRect;\n\n\t\t\tif (position === 'below'){\n\t\t\t\tleft = targetLeft;\n\t\t\t\ttop = targetBottom;\n\t\t\t}\n\t\t\telse if (position === 'above'){\n\t\t\t\tleft = targetLeft;\n\t\t\t\ttop = targetTop;\t\t\t\t\n\t\t\t}\t\n\n\t\t\tconsole.log('%cPopup.show about to setTimeout','color:red;font-weight:bold');\n\t\t\tthis.pendingTask = setTimeout(() => {\n\t\t\t\tconsole.log(`%c...timeout fires`,'color:red;font-weight:bold');\n\t\t\t\tPopupService.showPopup({name, group, depth, position, left, top, width:width || clientWidth, component});\n\t\t\t},10);\n\t\t}\n\n\t}\n}\n\n\nfunction keepWithinThePage(el){\n\n\t//onsole.log(`PopupService.keepWithinThePage`);\n\n\tvar container = el.querySelector('.popup-container');\n\n\tvar {top, left, width, height} = container.firstChild.getBoundingClientRect();\n\n\tvar w = window.innerWidth;\n\tvar h = window.innerHeight;\n\n\tvar overflowH = h - (top+height);\n\tif (overflowH < 0){\n\t\tcontainer.style.top = (parseInt(container.style.top) + overflowH) + 'px';\n\t}\t\n\n\tvar overflowW = w - (left+width);\n\tif (overflowW < 0){\n\t\tcontainer.style.left = (parseInt(container.style.left) + overflowW) + 'px';\n\t}\t\n\n}\n","import React from 'react';\nimport cx from 'classnames';\nimport { PopupService } from './popup';\n\nimport './context-menu.css';\n\nvar subMenuTimeout = null;\n\nexport class MenuItem extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            hasChildMenuItems: props.children && props.children.length > 0\n        }\n    }\n\n    render() {\n\n        var nestedMenu = this.props.submenuShowing ?\n            <ContextMenu doAction={this.props.doAction}>{this.props.children}</ContextMenu> :\n            null;\n\n        var className = cx(\n            'menu-item',\n            this.props.disabled ? 'disabled' : null,\n            this.state.hasChildMenuItems ? 'root' : null,\n            this.props.submenuShowing ? 'showing' : null\n        );\n\n        return (\n            <li className={className}>\n                <button tabIndex=\"-1\"\n                    onClick={e => this.handleClick(e)}\n                    onMouseOver={() => this.handleMouseOver()}>{this.props.label}</button>\n                {nestedMenu}\n            </li>\n        );\n\n    }\n\n    handleClick(e/*, dispatchId*/){\n        e.preventDefault();\n        if (this.props.disabled !== true) {\n            this.props.doAction(this.props.action, this.props.data);\n        }\n    }\n\n    handleMouseOver(){\n        this.props.onMouseOver(this.props.idx, this.state.hasChildMenuItems, this.state.submenuShowing);\n    }\n\n}\nMenuItem.defaultProps = {\n    data: null\n}\n\nexport const Separator = () =>\n    <li className=\"divider\"></li>;\n\nexport class ContextMenu extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            left: props.left,\n            top: props.top,\n            bottom: props.bottom,\n            submenuShowing: false,\n            submenuIdx: null\n        }\n    }\n\n    render() {\n\n        var children = this.props.children;\n\n        var style = {\n            position: 'absolute',\n            top: this.state.top,\n            left: this.state.left,\n            bottom: this.state.bottom\n        };\n\n        var submenuIdx = this.state.submenuShowing ? this.state.submenuIdx : -1;\n\n        var menuItems = children ? children.map((menuItem, idx) => React.cloneElement(menuItem, {\n            key: String(idx),\n            idx,\n            action: menuItem.props.action,\n            doAction: (key, data) => this.handleMenuAction(key, data),\n            onMouseOver: (idx, hasChildMenuItems) => this.handleMenuItemMouseOver(idx, hasChildMenuItems) ,\n            submenuShowing: submenuIdx === idx\n\n        })) : null;\n\n        return <ul className=\"popup-menu\" style={style}>{menuItems}</ul>;\n\n    }\n\n    componentWillMount() {\n        this.setState({\n            submenuShowing: false,\n            submenuIdx: null\n        });\n    }\n\n    componentWillReceiveProps(nextProps) {\n\n        if (nextProps.left !== '100%' && nextProps.top !== 0) {\n\n            if (nextProps.left !== this.state.left || nextProps.top !== this.state.top) {\n\n                this.setState({\n                    left: nextProps.left,\n                    top: nextProps.top,\n                    submenuShowing: false,\n                    submenuIdx: null\n                });\n\n                this.keepWithinThePage(nextProps.left, nextProps.top);\n            }\n        }\n    }\n\n    handleMenuAction(key, data){\n        if (this.props.doAction) {\n            this.props.doAction(key, data);\n        }\n        else if (this.props.onAction) {\n            this.props.onAction(key, data);\n        }\n        this.close();\n    }\n\n    handleMenuItemMouseOver(idx, hasChildMenuItems/*, submenuShowing*/){\n\n        if (subMenuTimeout) {\n            clearTimeout(subMenuTimeout);\n            subMenuTimeout = null;\n        }\n\n        if (hasChildMenuItems) {\n            if (this.state.submenuShowing !== true) {\n                subMenuTimeout = setTimeout(this.showSubmenu, 400);\n            }\n            this.setState({\n                submenuIdx: idx\n            });\n        }\n        else if (this.state.submenuIdx) {\n            this.setState({\n                submenuIdx: null,\n                submenuShowing: false\n            });\n        }\n    }\n\n    showSubmenu() {\n        subMenuTimeout = null;\n        this.setState({\n            submenuShowing: true\n        });\n    }\n\n    close() {\n        PopupService.hidePopup();\n    }\n\n}\n\nContextMenu.defaultProps = {\n    left: \"100%\",\n    top: 0,\n    bottom: 'auto'\n}\n\n","import React from 'react';\nimport {ContextMenu, MenuItem, Separator} from './context-menu';\n\nexport default class ComponentContextMenu extends React.Component {\n\n\trender(){\n\n\t\treturn (\n\t\t\t<ContextMenu doAction={this.props.doAction}>\n\t\t\t\t{this.menuItems()}\n\t\t\t</ContextMenu>\n\t\t);\n\n\t}\n\n\tmenuItems(){\n\n\t\tvar {state, children:targetComponent} = this.props.component.props; // state is too vague\n\t\tvar minimized = state === 1;\n\t\tvar maximized = state === 2;;\n\t\tvar normal = !(maximized || minimized);\n\n\t\tconsole.log(`ComponentContextMenu.menuItems minimized=${minimized}`)\n\n\n\t\tvar menuItems = [];\n\n\t\t// menuItems.push(\t<MenuItem action=\"pin\" label=\"Fix Size\"/> );\n\t\tmenuItems.push(\t<MenuItem key=\"remove\" action=\"remove\" label=\"Remove\"/> );\n\t\tif (normal){\n\t\t\tmenuItems.push( \n\t\t\t\t<MenuItem key=\"minimize\" action=\"minimize\" label=\"Minimize\"/> ,\n\t\t\t\t<MenuItem key=\"maximize\" action=\"maximize\" label=\"Maximize\"/> );\n\t\t}\n\t\telse {\n\t\t\tmenuItems.push( <MenuItem key=\"restore\" action=\"restore\" label=\"Restore\"/> );\n\t\t} \t\n\n\t\tvar {contextMenuItems=[]} = targetComponent.props;\n\t\tconst componentMenuItems = contextMenuItems.map(({text, action}) =>\n\t\t\t<MenuItem key={action} action={action} label={text}/>\n\t\t); \n\t\tif (componentMenuItems.length){\n\t\t\tmenuItems.push(\t<Separator key=\"1\"/>, ...componentMenuItems );\n\t\t}\n\n\t\tmenuItems.push(\t\n\t\t\t<Separator key=\"1\"/>, \n\t\t\t<MenuItem key=\"settings\" action=\"settings\" label=\"Settings\"/> );\n\n\t\treturn menuItems;\n\t}\n\n\n}\n\n","export const DROP = 'DROP';\nexport const LAYOUT_REMOVE = 'LAYOUT_REMOVE';\nexport const LAYOUT_REPLACE = 'LAYOUT_REPLACE';\nexport const LAYOUT_SWITCH_TAB = 'LAYOUT_SWITCH_TAB';\nexport const LAYOUT_MODEL = 'LAYOUT_MODEL';\n\nexport const layoutModel = model => ({\n    type : LAYOUT_MODEL,\n    layoutModel: model\n});\n\n\nexport const drop = (draggedComponent, dropTarget) => ({\n    type:DROP,\n    draggedComponent,\n    dropTarget\n});\n\nexport const remove = targetNode => ({\n    type: LAYOUT_REMOVE,\n    targetNode\n});\n\nexport const replace = (targetNode, replacementNode) => ({\n    type:LAYOUT_REPLACE,\n    targetNode,\n    replacementNode\n});\n\nexport const switchTab = (path, idx, nextIdx) => ({\n    type:LAYOUT_SWITCH_TAB,\n    path,\n    idx,\n    nextIdx\n});","\nexport var positionValues = {\n    'north': 1,\n    'east': 2,\n    'south': 4,\n    'west': 8,\n    'header': 16,\n    'centre': 32,\n    'absolute': 64\n};\n\nexport var Position = Object.freeze({\n    'North': _position('north'),\n    'East': _position('east'),\n    'South': _position('south'),\n    'West': _position('west'),\n    'Header': _position('header'),\n    'Centre': _position('centre'),\n    'Absolute': _position('absolute')\n});\n\nfunction _position(str) {\n    return Object.freeze({\n        offset: str === 'north' || str === 'west' ? 0 : str === 'south' || str === 'east' ? 1 : NaN,\n        valueOf: function () { return positionValues[str]; },\n        toString: function () { return str; },\n        North: str === 'north',\n        South: str === 'south',\n        East: str === 'east',\n        West: str === 'west',\n        Header: str === 'header',\n        Centre: str === 'centre',\n        NorthOrSouth: str === 'north' || str === 'south',\n        EastOrWest: str === 'east' || str === 'west',\n        NorthOrWest: str === 'north' || str === 'west',\n        SouthOrEast: str === 'east' || str === 'south',\n        Absolute: str === 'absolute'\n    });\n}\n\nvar NORTH = Position.North,\n    SOUTH = Position.South,\n    EAST = Position.East,\n    WEST = Position.West,\n    HEADER = Position.Header,\n    CENTRE = Position.Centre;\n\nexport class BoxModel {\n\n    //TODO we should accept initial let,top offsets here\n    static measure(model) {\n        var measurements = {};\n        addMeasurements(model, measurements, 0, 0, 0, 0, 0, 0);\n        return measurements;\n    }\n\n    static smallestBoxContainingPoint(layout, measurements, x, y) {\n        return smallestBoxContainingPoint(layout, measurements, x, y);\n    }\n\n    static pointPositionWithinRect(x, y, rect) {\n\n        const width = rect.right - rect.left;\n        const height = rect.bottom - rect.top;\n        const posX = x - rect.left;\n        const posY = y - rect.top;\n        const pctX = posX / width;\n        const pctY = posY / height;\n\n        var closeToTheEdge;\n        var position;\n\n        const borderZone = 30;\n\n        if (rect.header && containsPoint(rect.header, x, y)) {\n            position = HEADER;\n        }\n        else {\n            const w = width * 0.4;\n            const h = height * 0.4;\n            const centerBox = { left: rect.left + w, top: rect.top + h, right: rect.right - w, bottom: rect.bottom - h }\n\n            if (containsPoint(centerBox, x, y)) {\n                position = CENTRE;\n            } else {\n\n                const quadrant = (pctY < 0.5 ? 'north' : 'south') + (pctX < 0.5 ? 'west' : 'east');\n\n                switch (quadrant) {\n                case 'northwest': position = (pctX > pctY) ? NORTH : WEST; break;\n                case 'northeast': position = ((1 - pctX) > pctY) ? NORTH : EAST; break;\n                case 'southeast': position = (pctX > pctY) ? EAST : SOUTH; break;\n                case 'southwest': position = ((1 - pctX) > pctY) ? WEST : SOUTH; break;\n                default:\n                }\n            }\n        }\n\n        // Set closeToTheEdge even when we have already established that we are in a Header.\n        // When we use position to walk the containment hierarchy, building the chain of\n        // dropTargets, the Header loses significance after the first dropTarget, but\n        // closeToTheEdge remains meaningful.\n        if (typeof borderZone === 'number') {\n            // var closeToTheEdge = 0;\n            if (posX < borderZone) closeToTheEdge += 8;\n            if (posX > width - borderZone) closeToTheEdge += 2;\n            if (posY < borderZone) closeToTheEdge += 1;\n            if (posY > height - borderZone) closeToTheEdge += 4;\n        }\n\n        // we might want to also know if we are in the center - this will be used to allow\n        // stack default option\n\n        return { position, x, y, pctX, pctY, closeToTheEdge };\n\n    }\n\n}\n\nfunction addMeasurements(model, measurements, x, y, preX, posX, preY, posY) {\n\n    var componentMeasurements;\n\n    if (model) {\n\n        //onsole.log(`\\naddMeasurements\t\t\tx:${x}\ty:${y}\tpreX:${preX}\tposX:${posX}\tpreY:${preY}\tposY:${posY}   ${model.type} ${model.type === 'FlexBox' ? model.style.flexDirection :''} ${model.$path}`);\n\n        componentMeasurements = addClientMeasurements(model, measurements, x, y, preX, posX, preY, posY);\n\n        if (model.children) {\n            collectChildMeasurements(\n                model,\n                measurements,\n                model.layout.left + x,\n                model.layout.top + y,\n                preX, posX, preY, posY);\n        }\n\n    }\n\n    return componentMeasurements;\n\n}\n\nfunction addClientMeasurements(model, measurements, x, y, preX, posX, preY, posY) {\n\n    var { $path, header } = model;\n    var { top, left, width, height } = model.layout;\n\n    left = x + left - preX;\n    top = y + top - preY;\n\n    var right = preX + left + width + posX;\n\n    measurements[$path] = {\n        top,\n        left,\n        right,\n        bottom: preY + top + height + posY\n    };\n\n    if (header || model.type === 'TabbedContainer') {\n        //TODO don't assume headerheight = 34\n        measurements[$path].header = { top, left, right, bottom: top + 34 };\n\n        if (model.type === 'TabbedContainer') {\n            console.log(`measuring a tabbedContainer ${$path}`);\n\n            const start = performance.now();\n            const tabMeasurements = measureTabs($path);\n            const end = performance.now();\n            console.log(`took ${end - start}ms to measure tabs`);\n            measurements[$path].tabs = tabMeasurements;\n\n        }\n    }\n\n    return measurements[$path];\n\n}\n\nfunction isSplitter(model) {\n    return model && model.type === 'Splitter';\n}\n\nfunction collectChildMeasurements(model, measurements, x, y, preX, posX, preY, posY) {\n\n    //onsole.log(`   collectChildMeasurements\tx:${x}\ty:${y}\tpreX:${preX}\tposX:${posX}\tpreY:${preY}\tposY:${posY}`);\n\n    var components = model.children\n        .reduce((arr, child, idx, all) => {\n\n            // generate a 'local' splitter adjustment for children adjacent to splitters\n            var localPreX = 0;\n            var localPosX = 0;\n            var localPreY = 0;\n            var localPosY = 0;\n\n            if (child.type !== 'Splitter') {\n\n                if (model.type === 'FlexBox') {\n\n                    var flexDirection = model.style.flexDirection;\n                    var prev = all[idx - 1];\n                    var next = all[idx + 1];\n                    var n = all.length - 1;\n\n                    if (flexDirection === 'row') {\n                        localPreX = idx === 0 ? preX : isSplitter(prev) ? prev.layout.width / 2 : 0;\n                        localPosX = idx === n ? posX : isSplitter(next) ? next.layout.width / 2 : 0;\n                        localPreY = preY;\n                        localPosY = posY;\n                    }\n                    else if (flexDirection === 'column') {\n                        localPreX = preX;\n                        localPosX = posX;\n                        localPreY = idx === 0 ? preY : isSplitter(prev) ? prev.layout.height / 2 : 0;\n                        localPosY = idx === n ? posY : isSplitter(next) ? next.layout.height / 2 : 0;\n                    }\n                }\n                else {\n                    localPreX = preX;\n                    localPosX = posX;\n                    localPreY = preY;\n                    localPosY = posY;\n                }\n\n                arr.push(addMeasurements(child, measurements, x, y, localPreX, localPosX, localPreY, localPosY));\n\n            }\n\n            return arr;\n        }, [])\n        .filter(c => c) // the dragging component will return undefined, unrendered tabbed children\n    // .sort(byPosition);\n\n\n    if (components.length) {\n        measurements[model.$path].children = components;\n    }\n\n}\n\n\nfunction smallestBoxContainingPoint(layout, measurements, x, y) {\n\n    //onsole.log('smallestBoxContainingPoint in ' + component.constructor.displayName);\n\n    var rect = measurements[layout.$path];\n    if (!containsPoint(rect, x, y)) return null;\n\n    if (!layout.children) {\n        return layout;\n    }\n\n\n    if (rect.header && containsPoint(rect.header, x, y)) {\n        return layout;\n    }\n\n    var subLayout;\n    var children = layout.children;\n\n    for (var i = 0; i < children.length; i++) {\n        if (layout.type === 'TabbedContainer' && layout.active !== i) {\n            continue;\n        }\n        if (subLayout = smallestBoxContainingPoint(children[i], measurements, x, y)) {\n            return subLayout;\n        }\n    }\n\n    return layout;\n}\n\n\nfunction containsPoint(rect, x, y) {\n\n    //\tif (component.props.isHidden || component.props.dragging === true) return false;\n    if (rect) {\n        return x >= rect.left && x < rect.right && y >= rect.top && y < rect.bottom;\n    }\n}\n\n// function byPosition(c1, c2) {\n//     if (c1.top < c2.top || c1.left < c2.left) return -1;\n//     if (c1.top > c2.top || c1.left > c2.left) return 1;\n//     return 0;\n// }\n\nfunction measureTabs(id) {\n    // Note the :scope selector is not supported on IE \n    return Array.from(document.getElementById(id).querySelectorAll(`:scope > .Tabstrip > .tabstrip-inner-sleeve > .tabstrip-inner > .Tab`))\n        .map(tab => tab.getBoundingClientRect())\n        .map(({ left, right }) => ({ left, right }))\n}\n","\nexport function followPath(model, path) {\n\n    if (path.indexOf(model.$path) !== 0) {\n        throw Error(`pathUtils.followPath path ${path} is not within model.path ${model.$path}`);\n    }\n\n    var route = path.slice(model.$path.length + 1);\n    if (route === '') {\n        return model;\n    }\n    var paths = route.split('.');\n\n    for (var i = 0; i < paths.length; i++) {\n\n        if (model.children === undefined) {\n            console.log(`model at 0.${paths.slice(0, i).join('.')} has no children, so cannot fulfill rest of path ${paths.slice(i).join('.')}`);\n            return;\n        }\n\n        model = (model.children)[paths[i]];\n\n        if (model === undefined) {\n            console.log(`model at 0.${paths.slice(0, i).join('.')} has no children that fulfill next step of path ${paths.slice(i).join('.')}`);\n            return;\n        }\n    }\n    return model;\n}\n\nexport function followPathToParent(layout, path) {\n\n    if (path === '0') return null;\n    if (path === layout.$path) return null;\n\n    return followPath(layout, path.replace(/.\\d+$/, ''));\n}\n\nexport function breadcrumb(model, path){\n    if (!model){\n        return [];\n    }\n    if (path.indexOf(model.$path) !== 0) {\n        throw Error(`pathUtils.breadcrumb path ${path} is not within model.path ${model.$path}`);\n    }\n\n    const result = [model];\n\n    const route = path.slice(model.$path.length + 1);\n    if (route === '') {\n        return result;\n    }\n\n    const paths = route.split('.');\n    for (var i = 0; i < paths.length; i++) {\n        if (model.children === undefined) {\n            console.log(`model at 0.${paths.slice(0, i).join('.')} has no children, so cannot fulfill rest of path ${paths.slice(i).join('.')}`);\n            return [];\n        }\n        result.push(model = (model.children)[paths[i]]);\n        if (model === undefined) {\n            console.log(`model at 0.${paths.slice(0, i).join('.')} has no children that fulfill next step of path ${paths.slice(i).join('.')}`);\n            return [];\n        }\n    }\n    return result;\n}\n\nexport function adjustPath(path, removedPath, containerRemoved) {\n\n    var steps = path.split('.');\n    var rem = removedPath.split('.');\n\n    // pos needs to be first point at which paths differ, not necessarily last pos\n    var pos = forkPoint(steps, rem);\n    var remIdx = parseInt(rem[pos]);\n    var stepIdx = parseInt(steps[pos]);\n\n    if (pos === rem.length - 1) {\n\n        if (containerRemoved === 1) {\n            steps.splice(pos, 1);\n            return steps.join('.');\n        }\n        else if (containerRemoved === 2) {\n            steps.splice(pos - 1, 2);\n            var topLevelIdx = parseInt(rem[pos - 1], 10);\n            steps[pos - 1] = parseInt(steps[pos - 1]) + topLevelIdx;\n\n            return steps.join('.');\n        }\n\n        if (remIdx < stepIdx) {\n            steps[pos] = parseInt(steps[pos]) - 1;\n            return steps.join('.')\n        }\n\n    }\n\n    if (containerRemoved && remIdx === stepIdx) {\n        return path.replace(/.\\d+$/, '');\n    } else {\n        return path;\n    }\n}\n\nfunction forkPoint(path1, path2) {\n    var len = Math.min(path1.length, path2.length);\n\n    for (var i = 0; i < len; i++) {\n        if (path1[i] !== path2[i]) {\n            return i;\n        }\n    }\n    return -1;\n}\n\nexport function nextStep(pathSoFar, targetPath) {\n    if (pathSoFar === targetPath) {\n        return { idx: -1, finalStep: true };\n    }\n    var regex = new RegExp(`^${pathSoFar}.`);\n    // check that pathSoFar startsWith targetPath and if not, throw\n    var paths = targetPath.replace(regex, '').split('.').map(n => parseInt(n, 10));\n    return { idx: paths[0], finalStep: paths.length === 1 };\n}\n","export const FLEXBOX = 'FlexBox';\nexport const SURFACE = 'Surface';\nexport const TABBED_CONTAINER = 'TabbedContainer';\n","import React from 'react'\nimport yoga, { Node } from 'yoga-layout';\nimport {TABBED_CONTAINER, SURFACE} from './layoutTypes'\nimport { isContainer } from '../componentRegistry';\n\nconst NO_CHILDREN = [];\nconst NO_STYLE = {}\nconst CSS_DIGIT = '(\\\\d+)(?:px)?';\nconst CSS_MEASURE = `^(?:${CSS_DIGIT}(?:\\\\s${CSS_DIGIT}(?:\\\\s${CSS_DIGIT}(?:\\\\s${CSS_DIGIT})?)?)?)$`\nconst CSS_REX = new RegExp(CSS_MEASURE)\nconst BORDER_REX = /^(?:(\\d+)(?:px)\\ssolid\\s([a-zA-Z,0-9().]+))$/;\nconst ROW = 'row';\nconst COLUMN = 'column';\nconst FLEX_DIRECTION = {\n    [ROW]: yoga.FLEX_DIRECTION_ROW,\n    [COLUMN]: yoga.FLEX_DIRECTION_COLUMN\n}\nconst LAYOUT = 'layout';\nconst FLEXBOX = 'FlexBox';\nconst SPLITTER = 'Splitter';\n\nconst BORDER_STYLES = {\n    border: true,\n    borderWidth: true,\n    borderTopWidth: true,\n    borderRightWidth: true,\n    borderBottomWidth: true,\n    borderLeftWidth: true\n}\nconst BORDER_LIST = Object.keys(BORDER_STYLES);\n\nconst LAYOUT_STYLES = {\n    ...BORDER_STYLES,\n    margin: true,\n    marginTop: true,\n    marginRight: true,\n    marginBottom: true,\n    marginLeft: true,\n    padding: true,\n    paddingTop: true,\n    paddingRight: true,\n    paddingBottom: true,\n    paddingLeft: true\n}\n\nconst LAYOUT_LIST = Object.keys(LAYOUT_STYLES);\n\nexport function layoutStyleDiff(style1, style2){\n    if (!style1 && !style2){\n        return false;\n    } else if (style1 && !style2){\n        return LAYOUT_LIST.some(style => style1[style]);\n    } else if (style2 && !style1){\n        return LAYOUT_LIST.some(style => style2[style]);\n    } else {\n        return LAYOUT_LIST.some(style => style1[style] !== style2[style]);\n    }\n}\n\nexport function stripLayout(model){\n    return {\n        ...model,\n        layout: undefined,\n        children: model.children\n            ? model.children.map(child => stripLayout(child))\n            : undefined\n    }\n}\nexport function computeLayout(model, width, height, top=0, left=0, path){\n    const tree = createTree(model, path || model.$path);\n    const layoutModel = createYogaTree(tree);\n    layoutModel.node.calculateLayout(width, height, yoga.DIRECTION_LTR);\n    setLayout(layoutModel)\n    layoutModel.node.freeRecursive();\n\n    if (left !== 0){\n        layoutModel.layout.left += left\n    }\n    if (top !== 0){\n        layoutModel.layout.top += top\n    }\n    return layoutModel;\n}\n\nfunction createTree(model, path='0'){\n    return {\n        ...model,\n        $path: path,\n        // TODO normalize style\n        style: normalizeLayoutStyles(model.style),\n        // style: expandStyle(model.style),\n        children: expandChildren(model, path)\n    }\n}\n\nfunction expandChildren({type, children}, path){\n    if (children){\n        var splitters = type === FLEXBOX\n            ? getSplitterPositions(children)\n            : NO_CHILDREN;\n\n        return children.reduce((list, child, i) => {\n            if (splitters[i]) {\n                list.push({\n                    type: 'Splitter',\n                    $path: `${path}.${list.length}`,\n                    style: {flex: '0 0 6px', backgroundColor: 'black'}\n                });\n            }\n            list.push(createTree(child, `${path}.${list.length}`));\n            return list;\n        },[])\n    }\n}\n\nconst NO_BORDERS = [0,null];\n// todo cache values\nexport function getCSSBorderProperties(style){\n    if (style && typeof style.border === 'string'){\n        const match = BORDER_REX.exec(style.border);\n        if (match !== null){\n            const [,borderWidth,color] = match;\n            return [parseInt(borderWidth,10),color];\n        }\n    }\n    return NO_BORDERS;\n}\n\n// TODO merge the following two functions\nexport function normalizeLayoutStyles({margin, marginTop, marginRight, marginBottom, marginLeft,\n    padding, paddingTop, paddingRight, paddingBottom, paddingLeft, ...style}=NO_STYLE){\n\n    if (typeof margin === 'number'){\n        style.marginTop = style.marginRight = style.marginBottom = style.marginLeft = margin;\n    } else if (typeof margin === 'string'){\n        const match = CSS_REX.exec(margin);\n        if (match === null){\n            console.error(`Invalid css value for margin '${margin}'`)\n        } else {\n            const [, pos1, pos2, pos3, pos4] = match;\n            const pos123 = pos1 && pos2 && pos3\n            if (pos123 && pos4){\n                style.marginTop = parseInt(pos1,10);\n                style.marginRight = parseInt(pos2,10);\n                style.marginBottom = parseInt(pos3,10);\n                style.marginLeft = parseInt(pos4,10);\n            } else if (pos123){\n                style.marginTop = parseInt(pos1,10);\n                style.marginRight = style.marginLeft = parseInt(pos2,10);\n                style.marginBottom = parseInt(pos3,10);\n            } else if (pos1 && pos2){\n                style.marginTop = style.marginBottom = parseInt(pos1,10);\n                style.marginRight = style.marginLeft =parseInt(pos2,10);\n            } else {\n                style.marginTop = style.marginRight = style.marginBottom = style.marginLeft = parseInt(pos1,10);\n            }\n        }\n    }\n    if (typeof marginTop === 'number') style.marginTop = marginTop;\n    if (typeof marginRight === 'number') style.marginRight = marginRight;\n    if (typeof marginBottom === 'number') style.marginBottom = marginBottom;\n    if (typeof marginLeft === 'number') style.marginLeft = marginLeft;\n\n    if (typeof padding === 'number'){\n        style.paddingTop = style.paddingRight = style.paddingBottom = style.paddingLeft = padding;\n    } else if (typeof padding === 'string'){\n        const match = CSS_REX.exec(padding);\n        if (match === null){\n            console.error(`Invalid css value for padding '${padding}'`)\n        } else {\n            const [, pos1, pos2, pos3, pos4] = match;\n            const pos123 = pos1 && pos2 && pos3\n            if (pos123 && pos4){\n                style.paddingTop = parseInt(pos1,10);\n                style.paddingRight = parseInt(pos2,10);\n                style.paddingBottom = parseInt(pos3,10);\n                style.paddingLeft = parseInt(pos4,10);\n            } else if (pos123){\n                style.paddingTop = parseInt(pos1,10);\n                style.paddingRight = style.paddingLeft = parseInt(pos2,10);\n                style.paddingBottom = parseInt(pos3,10);\n            } else if (pos1 && pos2){\n                style.paddingTop = style.paddingBottom = parseInt(pos1,10);\n                style.paddingRight = style.paddingLeft =parseInt(pos2,10);\n            } else {\n                style.paddingTop = style.paddingRight = style.paddingBottom = style.paddinggLeft = parseInt(pos1,10);\n            }\n        }\n    }\n    if (typeof paddingTop === 'number') style.paddingTop = paddingTop;\n    if (typeof paddingRight === 'number') style.paddingRight = paddingRight;\n    if (typeof paddingBottom === 'number') style.paddingBottom = paddingBottom;\n    if (typeof paddingLeft === 'number') style.paddingLeft = paddingLeft;\n\n    return normalizeBorderStyle(style);\n}\n\nfunction normalizeBorderStyle(style=NO_STYLE){\n\n    if (BORDER_LIST.some(bs => style[bs])){\n        let match;\n\n        let {border, borderWidth, borderTopWidth, borderRightWidth, borderBottomWidth, borderLeftWidth, borderColor, ...rest} = style;\n\n        if (border || borderWidth || borderTopWidth || borderRightWidth || borderBottomWidth || borderLeftWidth){\n            if (typeof border === 'string' && (match = BORDER_REX.exec(border))){\n                // what if both border and borderWidth are specified ?\n                ([,borderWidth,borderColor] = match);\n            }\n\n            if (borderWidth){\n                borderTopWidth = borderTopWidth === undefined ? borderWidth : borderTopWidth;\n                borderRightWidth = borderRightWidth === undefined ? borderWidth : borderRightWidth;\n                borderBottomWidth = borderBottomWidth === undefined ? borderWidth : borderBottomWidth;\n                borderLeftWidth = borderLeftWidth === undefined ? borderWidth : borderLeftWidth;\n            }\n\n            borderColor = borderColor || 'black';\n            const boxShadow = `\n                ${borderColor} ${borderLeftWidth || 0}px ${borderTopWidth || 0}px 0 0 inset, \n                ${borderColor} ${-borderRightWidth || 0}px ${-borderBottomWidth || 0}px 0 0 inset`;\n\n            return {\n                ...rest,\n                boxShadow,\n                borderColor,\n                borderStyle: 'solid',\n                borderTopWidth,\n                borderRightWidth,\n                borderBottomWidth,\n                borderLeftWidth\n            }\n\n        } else {\n            return style\n        }\n    } else {\n        return style;\n    }\n}\n\nconst DEFAULT_HEADER = {height: 32, style: {backgroundColor: 'brown'}}\n// we may mutate the tree in here\nfunction createYogaTree(model, parent, idx){\n\n    let {style=NO_STYLE, children=NO_CHILDREN} = model;\n    const {type, layout=null} = model;\n    const {flexDirection=null, left=null, top=null, width=null, height=null, flex=null} = style;\n    const parentIsTabbedContainer = parent && parent.type === TABBED_CONTAINER;\n    const parentIsSurface = parent && parent.type === SURFACE;\n    const header = model.header === true\n        ? DEFAULT_HEADER\n        : typeof model.header === 'object'\n            ? {...DEFAULT_HEADER, ...model.header}\n            : null\n\n    if (type !== LAYOUT && type !== SPLITTER && children.length === 0 && !isContainer(type)){\n        style = {\n            ...style,\n            display: 'flex',\n            flexDirection: 'column'\n        }\n        // children has to be created inline as it will be mutated by yoga\n        model.children = children = [{type: LAYOUT, style: {flex: 1}}]\n    } else if (children.length === 1 && children[0].type === LAYOUT){\n        style = {\n            ...style,\n            display: 'flex',\n            flexDirection: 'column'\n        }\n        // children has to be created inline as it will be mutated by yoga\n        model.children = children = [{type: LAYOUT, style: {flex: 1}}]\n    }\n\n    let node = Node.create();\n\n    if (header){\n        //TODO we need to have normalized the css before we do this, otw a padding string value will ignore the paddingtop\n        style = increaseCSSMeasure(style, 'padding', header.height, 'top');\n    }\n\n    setCSSMeasure(node, style, 'margin');\n    setCSSMeasure(node, style, 'border');\n    setCSSMeasure(node, style, 'padding');\n\n    if (flexDirection !== null){\n        node.setDisplay(yoga.DISPLAY_FLEX);\n        node.setFlexDirection(FLEX_DIRECTION[flexDirection]);\n        node.setAlignItems(yoga.ALIGN_STRETCH); //TODO allow this to be overridden\n    } else if (type === TABBED_CONTAINER){\n        node.setDisplay(yoga.DISPLAY_FLEX);\n        node.setFlexDirection(yoga.FLEX_DIRECTION_ROW);\n        node.setAlignItems(yoga.ALIGN_STRETCH);\n    }\n\n    if (parentIsTabbedContainer){\n        const {active=0} = parent;\n        if (idx !== active){\n            node.setDisplay(yoga.DISPLAY_NONE);\n        } else {\n            node.setFlexGrow(1);\n            node.setFlexShrink(1);\n            node.setFlexBasis(0);\n            node.setMargin(yoga.EDGE_TOP,34)\n        }\n    } /*else if (parentHasHeader){\n        node.setMargin(yoga.EDGE_TOP,32); // how do we determine the header height\n    }*/\n\n    if (layout !== null && !parentIsSurface){\n        // if we already have a layout, we reapply it, by transforming it into a style specification. This allows us to\n        // manipulate the layout outside and preserve changes when we resize. If size has not changed, there is no need\n        // to re-compute layout\n        const {width: w, height: h} = layout;\n        if (model.type === 'Splitter'){\n            node.setFlexGrow(0);\n            node.setFlexShrink(0);\n            node.setFlexBasis(6);\n        } else {\n            node.setFlexGrow(1);\n            node.setFlexShrink(1);\n            node.setFlexBasis(getFlexDirection(parent) === ROW ? w : h); // need to know parent orientation\n        }\n    } else if (flex !== null){\n        // TODO how do we default the flex values\n        if (typeof flex === 'string'){\n            const [flexGrow, flexShrink, flexBasis] = flex.split(' ');\n            node.setFlexGrow(parseInt(flexGrow,0));\n            node.setFlexShrink(parseInt(flexShrink,0));\n            node.setFlexBasis(parseInt(flexBasis,0));\n        } else if (typeof flex === 'number'){\n            node.setFlexGrow(flex);\n            node.setFlexShrink(flex);\n            node.setFlexBasis(0);\n        }\n    } else {\n        if (parentIsSurface){\n            node.setPositionType(yoga.POSITION_TYPE_ABSOLUTE);\n        }\n        if (top !== null && left !== null){\n            node.setPosition(yoga.EDGE_TOP, top);\n        }\n        if (left !== null){\n            node.setPosition(yoga.EDGE_START, left);\n        }\n        if (width !== null){\n            node.setWidth(width)\n        }\n        if (height !== null){\n            node.setHeight(height)\n        }\n    }\n\n    children.forEach((child,i) => {\n        const expandedChild = createYogaTree(child, model, i);\n        node.insertChild(expandedChild.node,i);\n    })\n\n    model.node = node\n    return model;\n}\n\nfunction getFlexDirection(model){\n    const style = (model && model.style) || NO_STYLE;\n    return style.flexDirection || ROW;\n}\n\nfunction getSplitterPositions(children) {\n\n    var ret = [];\n\n    for (var i = 1; i < children.length; i++) {\n\n        var thisFlexible = isFlexible(children[i]);\n        var lastFlexible = isFlexible(children[i - 1]);\n\n        if (isSplitter(children[i]) || isSplitter(children[i - 1])) {\n            ret[i] = false;\n        } else if (thisFlexible && lastFlexible) {\n            ret[i] = true;\n        } else if (!(thisFlexible || lastFlexible)) {\n            ret[i] = false;\n        } else if (lastFlexible && children.slice(i + 1).some(isFlexible)) {\n            ret[i] = true;\n        } else if (thisFlexible && children.slice(0, i).some(isFlexible)) {\n            ret[i] = true;\n        } else {\n            ret[i] = false;\n        }\n\n    }\n\n    return ret;\n\n}\n\nfunction isSplitter(model){\n    return model.type === 'Splitter';\n}\n\nfunction isFlexible(model){\n    return model.resizeable;\n}\n\nexport function elementsFromLayout(model){\n    const {style: {backgroundColor}=NO_STYLE, layout: {top,left,width,height},children=NO_CHILDREN} = model;\n    const style = {position: 'absolute', backgroundColor, top, left, width, height};\n    return React.createElement('div', {key: model.$path,style,onClick: model.onClick}, children.map(elementsFromLayout));\n}\n\nexport function setLayout(model){\n    model.layout = model.node.getComputedLayout();\n    model.children && model.children.forEach(child => setLayout(child))\n}\n\nconst CSS_MEASURE_SETTERS = {\n    'margin': 'setMargin',\n    'padding': 'setPadding',\n    'border': 'setBorder'\n}\nconst CSS_MEASURES = {\n    border: {measureTop: 'borderTopWidth', measureRight: 'borderRightWidth', measureBottom: 'borderBottomWidth', measureLeft: 'borderLeftWidth'},\n    margin: {measureTop: 'marginTop', measureRight: 'marginRight', measureBottom: 'marginBottom', measureLeft: 'marginLeft'},\n    padding: {measureTop: 'paddingTop', measureRight: 'paddingRight', measureBottom: 'paddingBottom', measureLeft: 'paddingLeft'}\n}\n\nfunction increaseCSSMeasure(style, measure, value, edge){\n    if (measure === 'padding'){\n        if (edge === 'top'){\n            if (style.paddingTop){\n                style = {...style, paddingTop: style.paddingTop + value}\n            } else if (typeof style.padding === 'number'){\n                const {padding, ...rest} = style;\n                style = {\n                    ...rest,\n                    paddingTop: padding + value,\n                    paddingRight: padding,\n                    paddingBottom: padding,\n                    paddingLeft: padding\n                }\n            } else {\n                style = {...style, paddingTop: value}\n            }\n        }\n    }\n    return style;\n}\nfunction setCSSMeasure(node, style, measure){\n\n    const setMeasure = CSS_MEASURE_SETTERS[measure];\n    const value = style[measure];\n\n    if (typeof value === 'number'){\n        node[setMeasure](yoga.EDGE_ALL, value);\n    } else if (typeof value === 'string'){\n        const match = CSS_REX.exec(value)\n        if (match === null){\n            console.error(`Invalid css value for ${measure} '${value}'`)\n        } else {\n            const [, pos1, pos2, pos3, pos4] = match;\n            const pos123 = pos1 && pos2 && pos3\n            if (pos123 && pos4){\n                node[setMeasure](yoga.EDGE_TOP, parseInt(pos1,10));\n                node[setMeasure](yoga.EDGE_END, parseInt(pos2,10));\n                node[setMeasure](yoga.EDGE_BOTTOM, parseInt(pos3,10));\n                node[setMeasure](yoga.EDGE_START, parseInt(pos4,10));\n            } else if (pos123){\n                node[setMeasure](yoga.EDGE_TOP, parseInt(pos1,10));\n                node[setMeasure](yoga.EDGE_START, parseInt(pos2,10));\n                node[setMeasure](yoga.EDGE_END, parseInt(pos2,10));\n                node[setMeasure](yoga.EDGE_BOTTOM, parseInt(pos3,10));\n            } else if (pos1 && pos2){\n                node[setMeasure](yoga.EDGE_TOP, parseInt(pos1,10));\n                node[setMeasure](yoga.EDGE_BOTTOM, parseInt(pos1,10));\n                node[setMeasure](yoga.EDGE_START, parseInt(pos2,10));\n                node[setMeasure](yoga.EDGE_END, parseInt(pos2,10));\n            } else {\n                node[setMeasure](yoga.EDGE_ALL, parseInt(pos1,10));\n            }\n        }\n    } else {\n        const {measureTop, measureRight, measureBottom, measureLeft} = CSS_MEASURES[measure];\n        if (style[measureTop]) node[setMeasure](yoga.EDGE_TOP, style[measureTop]);\n        if (style[measureRight]) node[setMeasure](yoga.EDGE_END, style[measureRight]);\n        if (style[measureBottom]) node[setMeasure](yoga.EDGE_BOTTOM, style[measureBottom]);\n        if (style[measureLeft]) node[setMeasure](yoga.EDGE_START, style[measureLeft]);\n\n    }\n\n}\n","\nimport { followPath, followPathToParent, nextStep } from './pathUtils';\nimport { computeLayout as computeLayoutYoga } from './layoutUtils';\nconst UUID = require('pure-uuid');\n\nconst EMPTY_OBJECT = {};\n\nexport function containerOf(layout, target) {\n\n    if (target === layout) {\n        return null;\n    } else {\n\n        let { idx, finalStep } = nextStep(layout.$path, target.$path);\n        if (finalStep) {\n            return layout;\n        } else if (layout.children === undefined || layout.children[idx] === undefined) {\n            return null;\n        } else {\n            return containerOf(layout.children[idx], target);\n        }\n    }\n}\n\nexport function handleLayout(model, command, options) {\n\n    // This is called during splitter resize to resize children of model\n    if (command === 'resize') {\n        return resizeLayout(model, options);\n    } else if (command === 'replace') {\n        return replaceChild(model, options.targetNode, options.replacementNode);\n    } else if (command === 'remove') {\n        const result = removeChild(model, options.targetNode);\n        return result;\n    }\n    // else if (command === 'config-change'){\n    //     return Layout.config(layout, options);\n    // }\n    else if (command === 'switch-tab') {\n        return switchTab(model, options);\n    }\n    // else if (command === 'minimize'){\n    //     return Layout.minimize(layout, options);\n    // }\n    // else if (command === 'maximize'){\n    //     return Layout.maximize(layout, options);\n    // }\n    // else if (command === 'restore'){\n    //     return Layout.restore(layout, options);\n    //}\n    else if (command === 'drop') {\n        return drop(model, options);\n    }\n\n}\n\nexport function layout(model, position = {}, path = '0', visibility = 'visible', force = false, active) {\n\n    function firstNumber(n1, n2, n3) {\n        return typeof n1 === 'number' ? Math.round(n1) : typeof n2 === 'number' ? n2 : n3;\n    }\n\n    function firstDefined(n1, n2, n3) {\n        return n1 !== undefined\n            ? (typeof n1 === 'number' ? Math.round(n1) : n1)\n            : n2 !== undefined ? n2 : n3;\n    }\n\n    var style = model.style || {};\n    var top = firstNumber(position.top, style.top, 0);\n    var left = firstNumber(position.left, style.left, 0);\n    var width = firstDefined(position.width, style.width, 0);\n    var height = firstDefined(position.height, style.height, 0);\n\n    var { layout, ...m } = model;\n\n    if (layout && force !== true) {\n        if (path === model.$path &&\n            width === layout.width &&\n            height === layout.height &&\n            top === layout.top &&\n            left === layout.left &&\n            (visibility === undefined || visibility === model.style.visibility) &&\n            (active === undefined || active === model.active)) {\n\n            return model;\n        }\n    }\n\n    //TODO how do we make this model pluggable\n\n    switch (model.type) {\n    case 'FlexBox': return flexLayout(m, path, top, left, width, height, visibility, active);\n    case 'TabbedContainer': return flexLayout(m, path, top, left, width, height, visibility, active);\n    case 'Surface': return flexLayout(m, path, top, left, width, height, visibility, active);\n    default: return flexLayout(m, path, top, left, width, height, visibility, active);\n    }\n\n}\n\nfunction flexLayout(model, path, top, left, width, height, visibility, active) {\n\n    if (typeof active === 'number' && active !== model.isActive){\n        model = {\n            ...model,\n            active\n        }\n    }\n    return computeLayoutYoga(model, width, height, top, left, path);\n}\n\nfunction switchTab(layoutModel, { path, nextIdx }) {\n\n    var container = followPath(layoutModel, path);\n    // var content = container.children.slice();\n    // we need to set height of selected child, even if it is not needed for \n    // rendering - children will inherit the value;\n    // content[nextIdx] = content[nextIdx].set({height: content[idx].height});\n    // content[idx] = content[idx].set({height:0});\n    var { $path, visibility='visible' } = container;\n    var newContainer = layout(container, container.layout, $path, visibility, false, nextIdx);\n\n    return replaceChild(layoutModel, container, newContainer)\n\n}\n\nfunction drop(layoutModel, options) {\n\n    var { draggedComponent: source, dropTarget: { component: target, pos, tabIndex = -1 } } = options;\n\n    if (pos.position.Header) {\n        if (target.type === 'TabbedContainer') { //onsole.log('CASE 2 Works)');\n            let before, after;\n            if (tabIndex === -1) {\n                after = target.children[target.children.length - 1];\n            } else {\n                before = target.children[tabIndex];\n            }\n            return transform(layoutModel, { insert: { source, before, after } });\n        } else { //onsole.log('CASE 2B Works)'); \n            return transform(layoutModel, { wrap: { target, source, pos } });\n        }\n    } else if (pos.position.Centre) {\n        //onsole.log(JSON.stringify(source,null,2))\n        // source = clone(source, {style:{position:null,transform:null,transformOrigin:null}});\n        return replaceChild(layoutModel, followPath(layoutModel, target.$path), source);\n    } else {\n        return dropLayoutIntoContainer(layoutModel, pos, source, target);\n    }\n\n}\n\nfunction dropLayoutIntoContainer(layoutModel, pos, source, target) {\n\n    var targetContainer = followPathToParent(layoutModel, target.$path);\n\n    if (absoluteDrop(target, pos.position)) {\n        return transform(layoutModel, { insert: { source, target, pos } });\n    } else if (target === layoutModel || isDraggableRoot(layoutModel, target)) {\n        // Can only be against the grain...\n        if (withTheGrain(pos, target)) {\n            throw Error('How the hell did we do this');\n        } else { //onsole.log('CASE 4A) Works');\n            //return transform(layout, { wrap: {target, source, pos }, releaseSpace}); \n        }\n    } else if (withTheGrain(pos, targetContainer)) {\n        if (pos.position.SouthOrEast) { //onsole.log(`CASE 4B) Works. Insert into container 'with the grain'`);\n            return transform(layoutModel, { insert: { source, after: target, pos } });\n        } else { //onsole.log('CASE 4C) Works');\n            return transform(layoutModel, { insert: { source, before: target, pos } });\n        }\n    } else if (againstTheGrain(pos, targetContainer)) { //onsole.log('CASE 4D) Works.');\n        return transform(layoutModel, { wrap: { target, source, pos } });\n    } else if (isContainer(targetContainer)) {\n        return transform(layoutModel, { wrap: { target, source, pos } });\n    } else {\n        console.log('no support right now for position = ' + pos.position);\n    }\n    return layoutModel;\n\n}\n\nfunction transform(layoutModel, options) {\n\n    var nodeToBeInserted;\n    var nodeAfterWhichToInsert;\n    var nodeBeforeWhichToInsert;\n    var targetContainer;\n    var nodeSize;\n\n    for (var op in options) {\n        var opts = options[op];\n        switch (op) {\n\n        case 'insert':\n\n            nodeToBeInserted = opts.source;\n\n            nodeSize = opts.pos ? (opts.pos.width || opts.pos.height) : undefined;\n\n            if (opts.before) {\n                //onsole.log(`transform: insert before ` + opts.before.$path);\n                nodeBeforeWhichToInsert = opts.before.$path;\n            } else if (opts.after) {\n                //onsole.log(`transform: insert after ` + opts.after.$path);\n                nodeAfterWhichToInsert = opts.after.$path;\n            } else {\n                targetContainer = opts.target.$path;\n            }\n\n            break;\n\n        case 'wrap':\n\n            layoutModel = wrap(layoutModel, opts.source, opts.target, opts.pos);\n\n            break;\n        default:\n\n        }\n    }\n\n    if (nodeToBeInserted) {\n        layoutModel = insert(layoutModel, nodeToBeInserted, targetContainer, nodeBeforeWhichToInsert, nodeAfterWhichToInsert, nodeSize);\n    }\n\n    return layoutModel;\n\n}\n\nfunction insert(model, source, into, before, after, size) {\n    const target = before || after || into;\n    let { $path, /*active,*/ type, style, children } = model;\n    let { idx, finalStep } = nextStep($path, target);\n\n    // One more step needed when we're inserting 'into' a container\n    var oneMoreStepNeeded = finalStep && into && idx !== -1;\n\n    if (finalStep && !oneMoreStepNeeded) {\n\n        const flexBox = type === 'FlexBox';\n        const dim = flexBox && (style.flexDirection === 'row' ? 'width' : 'height');\n\n        if (type === 'Surface' && idx === -1) {\n            children = children.concat(source);\n        } else {\n\n            children = children.reduce((arr, child, i/*, all*/) => {\n                // idx of -1 means we just insert into end \n                if (idx === i) {\n                    if (flexBox) {\n                        var size = (child.layout[dim] - 6) / 2;\n                        child = {\n                            ...child,\n                            layout: {...child.layout, [dim]: size}};\n                        const flex = source.style.flex === undefined ? 1 : source.style.flex;\n                        source = {\n                            ...source,\n                            layout: {...source.layout, [dim]: size},\n                            style: {...source.style, flex, position: null, transform: null, transformOrigin: null}\n                        };\n                    } else {\n                        source = {...source, style: {...source.style, position: null, transform: null, transformOrigin: null}};\n                    }\n                    if (before) {\n                        arr.push(source, child);\n                    } else {\n                        arr.push(child, source);\n                    }\n                } else {\n                    arr.push(child);\n                }\n                return arr;\n            }, []);\n        }\n    } else {\n        children = model.children.slice();\n        children[idx] = insert(children[idx], source, into, before, after, size);\n    }\n\n    const {layout: modelLayout} = model;\n    return layout({...model, children}, modelLayout, model.$path)\n\n}\n\n// this is replaceChild with extras\nfunction wrap(model, source, target, pos) {\n\n    var { idx, finalStep } = nextStep(model.$path, target.$path);\n\n    var children = model.children.slice();\n\n    if (finalStep) {\n        var { type, flexDirection } = getLayoutSpec(pos); // roll dim into this\n        var dim = flexDirection === 'row' ? 'width' : 'height';\n\n        var active = type === 'TabbedContainer' || pos.position.SouthOrEast ? 1 : 0;\n        var $path = `${model.$path}.${idx}`;\n        target = children[idx];\n        var style = { position: null, transform: null, transformOrigin: null, flex: 1 };\n        var size = (target.layout[dim] - 6) / 2;\n        var childLayout = { [dim]: size };\n        var wrapperStyle = { flexDirection };\n        if (target.style.flex) {\n            wrapperStyle.flex = target.style.flex;\n        }\n\n        // need to roll resizeable into the layoutModel. else we lose it here\n        var wrapper = layout({\n            type,\n            $path,\n            active,\n            $id: new UUID(1),\n            style: wrapperStyle,\n            layout: target.layout,\n            resizeable: target.resizeable,\n            children: (pos.position.SouthOrEast || pos.position.Header)\n                ? [{...target, $path: `${$path}.0`, style: {...target.style, ...style}, layout: childLayout},\n                    {...source, $path: `${$path}.1`, style: {...source.style, ...style}, layout: childLayout}]\n                : [{...source, $path: `${$path}.0`, style: {...source.style, ...style}, layout: childLayout},\n                    {...target, $path: `${$path}.1`, style: {...target.style, ...style}, layout: childLayout}]\n        },\n        target.layout,\n        $path,\n        'visible',\n        true);\n\n        children.splice(idx, 1, wrapper);\n\n    } else {\n        children[idx] = wrap(children[idx], source, target, pos);\n    }\n\n    const {layout: modelLayout} = model;\n    // we call layout too many times by invoking it at this level\n    return layout({...model, children}, modelLayout, model.$path)\n\n}\n\nfunction resizeLayout(model, { path, measurements, dimension }) {\n\n    const target = followPath(model, path);\n    const position = dimension === 'width' ? 'left' : 'top';\n    let shift = 0;\n\n    const resizedTarget = layout({\n        ...model,\n        children: model.children.map((child,i) => {\n            const {layout} = child;\n            const measurement = measurements[i];\n            const { [dimension]: dim } = layout;\n            if (dim === measurement && shift === 0) {\n                return child;\n            } else {\n                const newLayout = { ...layout, [dimension]: measurement, [position]: layout[position] + shift };\n                shift += (measurement - dim);\n                return {\n                    ...child,\n                    layout: newLayout\n                };\n            }\n        })\n    }, model.layout, model.$path);\n\n    return replaceChild(model, target, resizedTarget);\n\n}\n\nfunction simpleClone(o1, o2, unversioned) {\n\n    if (o2 === undefined) {\n        return o1;\n    }\n\n    var result = {};\n    var value1;\n    var value2;\n    var property;\n    var versionIncrement = unversioned === true ? 0 : 1;\n\n    // copy forward existing properties, making replacements and deletions...\n    for (property in o1) {\n\n        value1 = o1[property];\n        value2 = o2[property];\n\n\n        if (property === '$version') {\n            result.$version = value1 + versionIncrement;\n        } else if (property === 'style') {\n            result.style = simpleClone(value1, value2);\n        } else if (value2 !== null) {\n            if (typeof value2 !== 'undefined') {\n                result[property] = value2;\n            } else {\n                result[property] = o1[property];\n            }\n        }\n    }\n\n    /// ...then add new properties \n    for (property in o2) {\n        if (o2[property] !== null && (typeof result[property] === 'undefined')) {\n            result[property] = o2[property];\n        }\n    }\n\n    return result;\n\n}\n\nfunction clone(model, overrides, unversioned) {\n\n    var { /*type, $version,*/ style: s1, ...rest1 } = model;\n    var { style: s2 = EMPTY_OBJECT, ...rest2 } = overrides;\n\n    if (noEffectiveOverrides(s1, s2) && noEffectiveOverrides(rest1, rest2)) {\n        return model;\n    }\n\n    return simpleClone(model, overrides, unversioned);\n\n}\n\nfunction noEffectiveOverrides(source, overrides) {\n    var properties = Object.getOwnPropertyNames(overrides);\n    for (var i = 0; i < properties.length; i++) {\n        if (overrides[properties[i]] !== source[properties[i]]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction removeChild(model, child) {\n\n    var { idx, finalStep } = nextStep(model.$path, child.$path);\n\n    var children = model.children.slice();\n\n    if (finalStep) {\n\n        if (idx > 0 && isSplitter(children[idx - 1])) {\n            children.splice(idx - 1, 2);\n        } else if (idx === 0 && isSplitter(children[1])) {\n            children.splice(0, 2);\n        } else {\n            children.splice(idx, 1);\n        }\n\n        var { layout: modelLayout, $path/*, active */} = model;\n\n        if (children.length === 1 && model.type.match(/FlexBox|TabbedContainer/)) {\n            // certain style attributes from the parent must be passed down to the \n            // replacement child, eg flex - are there others ?\n            const { flex } = model.style;\n            return layout(clone(children[0], { style: { flex } }, true), modelLayout, $path);\n        } else {\n            var { top, left, width, height } = modelLayout;\n            // var props = {};\n            //var nowActive = active;\n            // if (active === children.length) {\n            //     nowActive = props.active = active - 1;\n            // }\n            const result = layout({\n                ...model,\n                children\n            }, {top, left, width, height}, model.$path);\n            return result;\n\n        }\n    } else {\n        children[idx] = removeChild(children[idx], child);\n    }\n\n    children = children.map((child, i) => {\n        var $path = `${model.$path}.${i}`;\n        return child.$path === $path ? child : clone(child, { $path });\n    })\n\n    return clone(model, { children })\n\n}\n\nfunction replaceChild(model, child, replacement) {\n\n    if (replacement.$path === model.$path) {\n        return replacement;\n    }\n\n    var { idx, finalStep } = nextStep(model.$path, child.$path);\n\n    var children = model.children.slice();\n\n    if (finalStep) {\n\n        if (Array.isArray(replacement)) {\n            //TODO - make this right\n            // var dim = model.style.flexDirection === 'row' ? 'width' : 'height';\n            // var dim1 = child.layout[dim];\n            // replacement = replacement.map((l, i) => {\n            //     opts[dim] = dim1 / replacement.length;\n            //     return clone(l, { $path: `${model.$path}.${idx + i}` })\n            // });\n            // [].splice.apply(children, [idx, 1].concat(replacement));\n\n        } else {\n            children[idx] = {\n                ...replacement,\n                layout: {...child.layout}\n            };\n        }\n\n    } else {\n        children[idx] = replaceChild(children[idx], child, replacement);\n    }\n\n    return layout({...model, children}, model.layout, model.$path)\n}\n\n// Note: withTheGrain is not the negative of againstTheGrain - the difference lies in the \n// handling of non-Flexible containers, the response for which is always false;\nfunction withTheGrain(pos, container) {\n\n    return pos.position.NorthOrSouth ? isTower(container)\n        : pos.position.EastOrWest ? isTerrace(container)\n            : false;\n}\n\nfunction againstTheGrain(pos, layout) {\n\n    return pos.position.EastOrWest ? isTower(layout) || isTabset(layout)\n        : pos.position.NorthOrSouth ? isTerrace(layout) || isTabset(layout)\n            : false;\n\n}\n\nfunction absoluteDrop(target, position) {\n    return target.type === 'Surface' && position.Absolute;\n}\n\nfunction isSplitter(model) {\n    return model && model.type === 'Splitter';\n}\n\nfunction isContainer(model) {\n    return model.type === 'Container' || model.type === 'DynamicContainer';\n}\n\nfunction isTabset(model) {\n    return model.type === 'TabbedContainer';\n}\n\nfunction isTower(model) {\n    return model.type === 'FlexBox' && model.style.flexDirection === 'column';\n}\n\nfunction isTerrace(model) {\n    return model.type === 'FlexBox' && model.style.flexDirection === 'row';\n}\n\nfunction isDraggableRoot(layout, component) {\n\n    if (component.$path === '0') {\n        return true;\n    }\n\n    var container = containerOf(layout, component);\n    if (container) {\n        return container.type === 'App';\n    } else {\n        debugger;\n    }\n}\n\nfunction getLayoutSpec(pos) {\n    var type, flexDirection;\n\n    if (pos.position.Header) {\n        type = 'TabbedContainer';\n        flexDirection = 'column';\n    } else {\n        type = 'FlexBox';\n        if (pos.position.EastOrWest) {\n            flexDirection = 'row';\n        } else {\n            flexDirection = 'column';\n        }\n    }\n\n    return { type, flexDirection };\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport cx from 'classnames';\nimport ComponentHeader from './component-header';\nimport ComponentContextMenu from './componentContextMenu';\nimport { PopupService } from './popup';\nimport { remove as removeFromLayout } from './redux/actions';\nimport {\n    layout as applyLayout,\n    layoutStyleDiff\n} from './model/index';\nimport {getLayoutModel} from './util/component-utils';\nimport './layoutItem.css';\n\nconst DEFAULT_HEADER_SPEC = {\n    height: 32,\n    menu: true\n}\n\nexport default class LayoutItem extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            layoutModel: props.layoutModel ||\n                applyLayout(getLayoutModel(this),{width: props.style.width, height: props.style.height})\n        };\n\n        this.handleLayout = this.handleLayout.bind(this);\n    }\n\n    render() {\n\n        const {\n            children,\n            title = '',\n            state,\n            dragging,\n            header: _,\n            ...props } = this.props;\n\n        const {layoutModel} = this.state;\n        const [{layout: childLayout}] = layoutModel.children;\n\n        var { $path, layout } = layoutModel;\n        var isSelected = this.props.isSelected;\n\n        var className = cx(\n            'LayoutItem', {\n                'minimized': state === 1,\n                'maximized': state === 2,\n                'active': isSelected,\n                'dragging': dragging\n            }\n        );\n\n        const header = !layoutModel.header\n            ? false\n            : layoutModel.header === true\n                ? DEFAULT_HEADER_SPEC\n                : { ...DEFAULT_HEADER_SPEC, ...layoutModel.header };\n\n        var headerHeight = header ? header.height : 0;\n\n        const style = {\n            backgroundColor: layoutModel.style.backgroundColor,\n            boxShadow: layoutModel.style.boxShadow\n        }\n\n        const componentStyle = {\n            // backgroundColor: props.style.backgroundColor,\n            position: 'absolute',\n            top: headerHeight,\n            border: 0,\n            padding: 0,\n            margin: 0,\n            // ...childStyle,\n            ...childLayout\n        };\n\n        return (\n            <div id={$path} className={className} style={{ position: 'absolute', ...style, ...layout }}>\n                {header &&\n                    <ComponentHeader ref='header'\n                        title={`${title}`}\n                        style={{ height: header.height }}\n                        menu={header.menu}\n                        onMouseDown={e => this.handleMousedown(e)}\n                        onAction={(key, opts) => this.handleAction(key, opts)}\n                        state={state} />\n                }\n\n                {children.type === 'div'\n                    ? React.cloneElement(children, {\n                        style: {...componentStyle, ...childLayout}\n                    })\n\n                    : React.cloneElement(children, {\n                        ...props,\n                        style: componentStyle, // we may need to merge style attributes from props\n                        width: childLayout.width,\n                        height: childLayout.height,\n                        onLayout: this.handleLayout\n                    })\n                }\n            </div>\n        );\n    }\n\n    componentDidMount() {\n\n        const self = this;\n        if (this.context && this.context.store) {\n            const { store } = this.context;\n            //TODO sort out this mess\n            // be careful the context of store change notification is not 'this'\n            this.unsubscribe = store.subscribe(() => {\n                const myState = self.getState();\n                if (myState && myState !== self.state.c) {\n                    // console.log(`LayoutItem receives store change notification - ITS FOR ME and it has changed \n                    // ${JSON.stringify(myState)}\n                    //${JSON.stringify(self.state.c)}`);\n                    self.setState({ c: myState });\n                }\n\n                // else if (myState && myState === self.state.c){\n                // console.log(`LayoutItem receives store change notification - it's for me BUT it hasn't changed`);\n                // }\n                // else {\n                // console.log(`LayoutItem receives store change notification - it's Not for me :-(`);\n                // }\n            });\n\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.unsubscribe) {\n            this.unsubscribe();\n            this.unsubscribe = null;\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n\n        const { layoutModel, style } = nextProps;\n        // look out for a style change that will require a layout, we will reset layout in state and call\n        // onLayout prop to pass this up chain of command\n\n        if (style && style.flexGrow !== this.props.style.flexGrow) {\n            var fixed = style.flexGrow === 0;\n            this.setState({\n                fixed,\n                header: { title: this.props.title, fixed }\n            });\n        }\n        if (layoutModel && layoutModel !== this.state.layoutModel) {\n            this.setState({ layoutModel });\n        } else if (layoutStyleDiff(this.props.style, style)) {\n            // TODO test this code\n            const {$path, layout} = this.state.layoutModel;\n            const {marginTop=0,marginRight=0,marginBottom=0,marginLeft=0} = this.props.style;\n            const {top, left,width, height} = layout;\n            this.setState({\n                layoutModel: applyLayout(\n                    {\n                        ...this.state.layoutModel,\n                        style\n                    },\n                    { top, left, width: width + marginLeft + marginRight, height: height + marginTop + marginBottom },\n                    $path,\n                    true // FORCE_LAYOUT\n                )\n            }, () => {\n                this.props.onLayout('replace', { model: this.state.layoutModel });\n            });\n\n        }\n    }\n\n    dispatch(action){\n\n        if (typeof action === 'function') {\n            return this.context.store.dispatch(action);\n        }\n        else {\n            const { id, componentId, ...options } = action;\n            if (id && action.type === 'SAVE_CONFIG') {\n                this.context.store.dispatch({ type: 'SAVE_CONFIG', config: { ...options.config, targetId: this.props.layoutModel.$id }, componentId: id });\n            }\n            else if (componentId) {\n                this.context.store.dispatch({ ...options, componentId })\n            }\n            else {\n                this.context.store.dispatch({ ...options, componentId: this.props.layoutModel.$id });\n            }\n        }\n\n    }\n\n    handleLayout(command, options){\n\n        if (command === 'remove' && options === undefined) {\n            // TODO call onLayout\n            this.dispatch(removeFromLayout(this.props.layoutModel));\n        }\n        else {\n            this.props.onLayout(command, options);\n        }\n\n    };\n\n    handleAction(key, opts){\n\n        if (key === 'menu') {\n\n            var { left, top } = opts;\n\n            // the ComponentContextMenu will reach into the hostedComponent to get MenuItems, we should do that here\n            var contextMenu = <ComponentContextMenu component={this} doAction={action => this.handleContextMenuAction(action)} />;\n\n            PopupService.showPopup({ left, top, component: contextMenu });\n        }\n\n        else if (key === 'pin') {\n            var fixed = this.state.fixed;\n            this.setState({ fixed: !fixed });\n            this.props.onConfigChange(this, { fixed: !fixed })\n        }\n    }\n\n    handleMousedown(e){\n        if (this.props.onMouseDown) {\n            this.props.onMouseDown({\n                model: this.props.layoutModel,\n                evt: e,\n                position: ReactDOM.findDOMNode(this).getBoundingClientRect()\n            });\n        }\n        else {\n            this.props.onLayout('drag-start', {\n                model: this.props.layoutModel,\n                evt: e,\n                position: ReactDOM.findDOMNode(this).getBoundingClientRect()\n            });\n        }\n    }\n\n    handleContextMenuAction(action/*, data*/){\n\n        if (action === 'pin') {\n            var fixed = this.state.fixed;\n            this.setState({ fixed: !fixed });\n            this.props.onConfigChange(this, { fixed: !fixed })\n        }\n        else if (action === 'remove') {\n            this.dispatch(removeFromLayout(this.props.layoutModel));\n            // this.props.onLayout('remove', {model:this.props.layoutModel});\n        }\n        else if (action === 'minimize') {\n            this.props.onLayout('minimize', {/*path*/});\n        }\n        else if (action === 'maximize') {\n            this.props.onLayout('maximize', { /*path*/ });\n        }\n        else if (action === 'restore') {\n            this.props.onLayout('restore', { /*path*/ });\n        }\n        else if (action === 'settings') {\n\n            // const dialog = this._component && this._component.getSettingsEditor\n            //     ? this._component.getSettingsEditor()\n            //     : <div style={{\n            //                 width: 300,\n            //                 height: 200,\n            //                 backgroundColor: 'yellow',\n            //                 borderColor: 'red',\n            //                 borderWidth: 5,\n            //                 borderStyle: 'solid'}} />\n\n\n            // this.props.onLayout('dialog',{\n            //     component : dialog \n            // });\n        }\n        else if (typeof action === 'object') {\n            this.dispatch(action);\n        }\n        else {\n            console.log(`LayoutItem.handleContextMenuAction unknown action ${action}`);\n\n        }\n\n    }\n\n}\n\nLayoutItem.displayName = 'LayoutItem';\n\nLayoutItem.defaultProps = {\n    onConfigChange: () => { },\n    style: {},\n    visibility: 'visible'\n};\n","import Konva from 'konva';\nimport './drop-menu.css';\n\nconst COLOURS = ['red', 'green', 'blue', 'yellow'];\n\n// Konva properties\nconst PATH_SETTINGS = {\n    fill: '#00D2FF',\n    strokeWidth: 0\n}\n\nexport default class DropMenu {\n\n    constructor({ layer, hover }) {\n\n        this._group = new Konva.Group();\n\n        this._group.on('mouseleave', () => hover(null));\n\n        layer.add(this._group);\n        \n        this.visible = isVisible => this._group.visible(isVisible)\n\n        this.addPaths = paths => {\n\n            paths.forEach(({ path, dropTarget }) => {\n                this._group.add(path);\n                path.on('mouseenter', () => hover(dropTarget));\n            })\n        }\n\n    }\n\n    computeMenuPosition(dropTarget, measurements, offsetTop = 0, offsetLeft = 0) {\n\n        const { component, pos } = dropTarget;\n        const box = measurements[component.$path];\n\n        const dropTargets = getDropTargets(dropTarget);\n\n        const [x, y] = menuPosition(pos, box, dropTargets.length, offsetTop, offsetLeft);\n\n        this._group.position({ x, y });\n\n        const paths = dropTargets.map((dropTarget, i) => ({\n            path: new Konva.Path({\n                strokeWidth: 0,\n                fill: COLOURS[i],\n                data: pathPosition(pos, i)\n            }),\n            dropTarget\n        }));\n\n        // do we have to care about removing eventlisteners ? Probably not\n        this._group.removeChildren();\n\n        this.addPaths(paths);\n    }\n\n}\n\nfunction pathPosition(pos, idx) {\n\n    const unit = 30;\n    const depth = 32;\n\n    const lo = i => i === 0 ? -unit / 2\n        : i > 0 ? -1 * (unit / 2 + (idx * unit))\n            : unit / 2 + ((-idx - 1) * unit);\n\n    const [top, left, width, height] =\n        pos.position.West ? [lo(idx), 0, depth, unit] :\n            pos.position.East ? [lo(idx), -depth, depth, unit] :\n                pos.position.South ? [-depth, lo(idx), unit, depth] :\n    \t/* North | Header */[0, lo(idx), unit, depth];\n\n    // For pos 0 we draw just one item (the central item), for others we double up\t\n    return `M${left},${top}h${width}v${height}h-${width}v-${height}${idx > 0 ? pathPosition(pos, -idx) : ''}`;\n\n}\n\nfunction menuPosition(pos, box, count, offsetTop, offsetLeft) {\n\n    return pos.position.West ? [box.left - offsetLeft + 26, pos.y - offsetTop]\n        : pos.position.South ? [pos.x - offsetLeft, box.bottom - offsetTop - 26]\n            : pos.position.East ? [box.right - offsetLeft - 26, pos.y - offsetTop]\n        /* North | Header*/ : [pos.x - offsetLeft, box.top - offsetTop + 26];\n\n}\n\n// This might be a method on dropTarget ?\nfunction getDropTargets(dropTarget) {\n\n    const dropTargets = [dropTarget];\n\n    while (dropTarget = dropTarget.nextDropTarget) {\n        dropTargets.push(dropTarget);\n    }\n\n    return dropTargets;\n\n}\n\n\n\n\n","import { Position } from './model/index';\nimport DropMenu from './drop-menu';\nimport { PopupService } from './popup';\nimport Konva from 'konva';\n\nimport './drop-target-canvas.css';\n\nconst NORTH = Position.North;\nconst SOUTH = Position.South;\nconst EAST = Position.East;\nconst WEST = Position.West;\nconst HEADER = Position.Header;\n\nlet _dropTarget = null;\nlet _multiDropOptions = false;\nlet _currentDropTarget;\nlet _dropMenu = false;\nlet _stage;\nlet _layer;\nlet _konvaDropMenu;\nlet _hoverDropTarget = null;\nlet _dropTargetIsTabstrip = false;\nlet _currentTabIndex = -1;\nlet _shiftedTab = null;\n\nexport default class DropTargetCanvas {\n\n    constructor() {\n        const canvas = document.createElement('canvas');\n        canvas.className = 'fullscreen';\n        let container = document.getElementById('thecanvas');\n        let sketchpad;\n\n        if (!container) {\n            const root = document.getElementById('root');\n            container = document.createElement('div');\n            container.id = 'thecanvas';\n            document.body.insertBefore(container, root);\n\n            sketchpad = document.createElement('div');\n            sketchpad.id = 'sketchpad';\n            this.sketchpad = sketchpad;\n            document.body.insertBefore(sketchpad, root);\n        }\n\n        container.appendChild(canvas);\n\n        this.canvas = canvas;\n\n        this.t = 0;\n        this.l = 0;\n        this.w = document.body.clientWidth;\n        this.h = document.body.clientHeight;\n\n        window.addEventListener('resize', () => {\n            this.w = document.body.clientWidth;\n            this.h = document.body.clientHeight;\n        });\n\n        _stage = new Konva.Stage({\n            container: 'sketchpad',   // id of container <div>\n            width: this.w,\n            height: this.h\n        });\n        //then create layer\n        _layer = new Konva.Layer();\n\n        _konvaDropMenu = new DropMenu({\n            layer: _layer,\n            hover: dropTarget => _hoverDropTarget = dropTarget\n        });\n\n        _stage.add(_layer);\n\n    }\n\n    prepare(position) {\n        if (position) {\n            const { left: l, top: t, right: r, bottom: b } = position;\n            const w = r - l;\n            const h = b - t;\n            this.t = t;\n            this.l = l;\n            this.w = w;\n            this.h = h;\n            const cssText = `top:${t}px;left:${l}px;width:${w}px;height:${h}px;z-index:100`;\n            this.canvas.style.cssText = cssText;\n            this.sketchpad.style.cssText = cssText;\n\n            _stage.setWidth(w);\n            _stage.setHeight(h);\n\n        }\n        this.canvas.classList.add(\"ready\");\n        document.body.classList.add(\"drawing\");\n        _currentDropTarget = null;\n\n    };\n\n\n    clear() {\n        document.body.classList.remove(\"drawing\");\n        this.canvas.classList.remove(\"ready\");\n        if (_dropMenu) {\n            PopupService.hidePopup();\n            _dropMenu = false;\n        }\n    }\n\n    get hoverDropTarget() {\n        return _hoverDropTarget;\n    }\n\n    get dropTargetIsTabstrip() {\n        return _dropTargetIsTabstrip;\n    }\n\n    get currentTabIndex() {\n        return _currentTabIndex;\n    }\n\n    draw(dropTarget, measurements, x, y) {\n        const SameDropTarget = _dropTarget !== null &&\n            !_dropTargetIsTabstrip &&\n            _dropTarget.component === dropTarget.component &&\n            _dropTarget.pos.position === dropTarget.pos.position &&\n            _dropTarget.pos.closeToTheEdge === dropTarget.pos.closeToTheEdge;\n\n        const wasMultiDrop = _multiDropOptions;\n\n        if (_hoverDropTarget !== null) {\n            this.drawTarget(_hoverDropTarget, measurements, x, y);\n        }\n        else if (SameDropTarget === false) {\n\n            _dropTarget = dropTarget;\n            _currentDropTarget = null;\n            _multiDropOptions = dropTarget.nextDropTarget != null;\n\n            //onsole.log('draw, _multiDropOptions = ' + _multiDropOptions);\n\n            // if (_dropMenu){\n            //     PopupService.hidePopup();\n            //     _dropMenu = false;\n            // }\n\n            this.drawTarget(dropTarget, measurements, x, y);\n\n        }\n\n        if (_hoverDropTarget !== null) {\n\n\n        }\n        else if (_multiDropOptions) {\n\n            if (!wasMultiDrop) {\n                // onsole.log('show the drop menu');\n                _konvaDropMenu.visible(true);\n            }\n\n            drawDropOptions(this.canvas, dropTarget, measurements, this.w, this.h, this.t, this.l);\n        }\n        else if (_konvaDropMenu.visible()) {\n            // onsole.log('clear the drop menu');\n            _konvaDropMenu.visible(false);\n            _layer.draw();\n        }\n\n    }\n\n    drawTarget(dropTarget, measurements, x, y) {\n        const { canvas, w, h, t: offsetTop, l: offsetLeft } = this;\n\n        setWidth(canvas, w, h);\n\n        var ctx = canvas.getContext('2d');\n\n        if (_currentDropTarget) {\n            _currentDropTarget.active = false;\n        }\n\n        //onsole.log('activate drop target',dropTarget);\t    \n        _currentDropTarget = dropTarget;\n        dropTarget.active = true;\n\n        var rect = measurements[dropTarget.component.$path];\n        var header = rect.header || rect.tabstrip;\n        var pos = dropTarget.pos;\n\n        if (pos.position === HEADER && header) {\n            // this is wrong, only needed because we're manipulating the tabs here\n            const $id = dropTarget.component.$path;\n            drawTabbedOutline(ctx, rect, w, h, offsetTop, offsetLeft, x, y, $id);\n        }\n        else {\n            drawOutline(ctx, pos, rect, w, h, offsetTop, offsetLeft);\n        }\n    }\n}\n\nfunction setWidth(canvas, w, h) {\n    canvas.width = w;\n    canvas.height = h;\n}\n\n\nfunction drawTabbedOutline(ctx, rect, w, h, offsetTop, offsetLeft, mouseX, mouseY, $id) {\n\n    // This is completely the wrong place to be identifying the target tab, should be done in\n    // BoxModel.identifyDropTarget\n    const { tabs } = rect;\n    const tabCount = tabs ? tabs.length : 0;\n    let tab = tabs && tabs.find(({ left, right }) => mouseX >= left && mouseX <= right);\n    if (tab) {\n        _currentTabIndex = tabs.indexOf(tab);\n    } else {\n        const lastTab = tabs && tabs[tabs.length - 1];\n        if (lastTab) {\n            tab = { left: lastTab.right }\n            _currentTabIndex = tabs.length;\n        } else {\n            tab = { left: rect.left };\n            _currentTabIndex = -1;\n        }\n    }\n\n    //====================================== EXPERIMENT\n    if (_currentTabIndex > -1 && _currentTabIndex < tabCount) {\n        const selector = `:scope > .Tabstrip > .tabstrip-inner-sleeve > .tabstrip-inner > .Tab:nth-child(${_currentTabIndex + 1})`;\n        const tab = document.getElementById($id).querySelector(selector);\n        if (tab && tab !== _shiftedTab) {\n            if (_shiftedTab) {\n                _shiftedTab.style.cssText = '';\n            }\n            tab.style.cssText = 'transition:margin-left .4s ease-out;margin-left: 80px';\n            _shiftedTab = tab;\n        }\n    } else if (_shiftedTab) {\n        _shiftedTab.style.cssText = '';\n        _shiftedTab = null;\n\n    }\n\n    //====================================== EXPERIMENT\n\n    _dropTargetIsTabstrip = rect.tabs && rect.tabs.length;\n\n    var header = rect.header;\n\n    var t = Math.round(header.top - offsetTop),\n        l = /*header.name === 'Tabstrip' ? Math.round(header.tabRight) :*/ Math.round(header.left - offsetLeft),\n        r = Math.round(header.right - offsetLeft),\n        b = Math.round(header.bottom - offsetTop),\n        tabLeft = Math.round(tab.left - offsetLeft),\n        tabRight = Math.round(tab.left + 60 - offsetLeft);\n\n    ctx.beginPath();\n\n    var lineWidth = 6;\n    var inset = 0;\n    // var headOffset = (header.top - rect.top) + header.height;\n\n    var gap = Math.round(lineWidth / 2) + inset;\n    var { top, left, right, bottom } = rect;\n\n    setCanvasStyles(ctx, { lineWidth: lineWidth, strokeStyle: 'yellow' });\n    drawTab(ctx, l + gap, t + gap, r, b, top, left - offsetLeft + gap, right - offsetLeft - gap, bottom - offsetTop - gap, tabLeft, tabRight);\n\n    ctx.stroke();\n\n}\n\nfunction drawTab(ctx, l, t, r, b, top, left, right, bottom, tabLeft, tabRight) {\n\n    var radius = 6;\n\n    // var x = l;\n    var y = t + 3;\n    // var width = 100;\n    var height = b - t;\n    var fill = false;\n    var stroke = true;\n\n    ctx.lineJoin = 'round';\n    ctx.beginPath();\n\n    ctx.moveTo(tabLeft + radius, y);\n    ctx.lineTo(tabRight - radius, y);\n    ctx.quadraticCurveTo(tabRight, y, tabRight, y + radius);\n    ctx.lineTo(tabRight, y + height);\n    ctx.lineTo(right, y + height);\n    ctx.lineTo(right, bottom);\n    ctx.lineTo(left, bottom);\n    ctx.lineTo(left, y + height);\n    ctx.lineTo(tabLeft, y + height);\n    ctx.lineTo(tabLeft, y + radius);\n    ctx.quadraticCurveTo(tabLeft, y, tabLeft + radius, y);\n\n\n    //   ctx.moveTo(x, y + height);\n    //   ctx.lineTo(x, y + radius);\n    //   ctx.quadraticCurveTo(x,y,x + radius, y);\n    //   ctx.lineTo(x + width - radius, y);\n    //   ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n    //   ctx.lineTo(x + width, y + height);\n\n    //   ctx.lineTo(right, y + height);\n    //   ctx.lineTo(right, bottom);\n    //   ctx.lineTo(left, bottom);\n    //   ctx.lineTo(left, y+height);\n\n\n    ctx.closePath();\n\n    if (stroke) {\n        ctx.stroke();\n    }\n    if (fill) {\n        ctx.fill();\n    }\n\n}\n\nfunction drawOutline(ctx, pos, rect, w, h, offsetTop = 0, offsetLeft = 0) {\n\n    var targetPosition = pos.position;\n\n    var size = null;\n\n    //onsole.log(`layout=${JSON.stringify(layout)}`);\n\n    if (pos.width) {\n        size = { width: pos.width }\n    }\n    else if (pos.height) {\n        size = { height: pos.height }\n    }\n\n    var t = Math.round(rect.top - offsetTop),\n        l = Math.round(rect.left - offsetLeft),\n        r = Math.round(rect.right - offsetLeft),\n        b = Math.round(rect.bottom - offsetTop);\n\n    var lineWidth = 6;\n\n    setCanvasStyles(ctx, {\n        lineWidth: lineWidth,\n        strokeStyle: 'yellow'\n    });\n\n    ctx.beginPath();\n\n    var inset = 0;\n    var gap = Math.round(lineWidth / 2) + inset;\n\n    switch (targetPosition) {\n\n        case NORTH:\n        case HEADER:\n            var halfHeight = Math.round((b - t) / 2);\n            var sizeHeight = (size && size.height) ? size.height : 0;\n            var height = sizeHeight ? Math.min(halfHeight, Math.round(sizeHeight)) : halfHeight;\n            drawRect(ctx, l + gap, t + gap, r - gap, t + gap + height);\n            break;\n\n        case WEST:\n            var halfWidth = Math.round((r - l) / 2);\n            var sizeWidth = (size && size.width) ? size.width : 0;\n            var width = sizeWidth ? Math.min(halfWidth, Math.round(sizeWidth)) : halfWidth;\n            drawRect(ctx, l + gap, t + gap, l + gap + width, b - gap);\n            break;\n\n        case EAST:\n            // var halfWidth = Math.round((r - l) / 2);\n            // var sizeWidth = (size && size.width) ? size.width : 0;\n            // var width = sizeWidth ? Math.min(halfWidth, Math.round(sizeWidth)) : halfWidth;\n            drawRect(ctx, (r - gap) - width, t + gap, r - gap, b - gap);\n            break;\n\n        case SOUTH:\n            // var halfHeight = Math.round((b - t) / 2);\n            // var sizeHeight = (size && size.height) ? size.height : 0;\n            // var height = sizeHeight ? Math.min(halfHeight, Math.round(sizeHeight)) : halfHeight;\n\n            drawRect(ctx, l + gap, (b - gap) - height, r - gap, b - gap);\n            break;\n\n        default:\n\n            console.log('DropTargetCanvas what are we doing here ?');\n    }\n\n    ctx.closePath();\n    ctx.stroke();\n\n\n    // if (dropTarget.pos.closeToTheEdge == dropTarget.pos.position){\n\n    // \tvar zone = 30;\n\n    //     ctx.beginPath();\n    //     ctx.fillStyle = 'rgba(0,0,0,.25)';\n\n    //     //TODO if op is 'insert' we may not be at the edge - may be \n    //     // somewhere in middle of a tower or terrace - look at index\n    //     var g = 6;\n\n    //     zone = zone - gap;\n\n    //     console.log(_dropTarget.pos.position , dropTarget.pos.position);\n    //     switch (_dropTarget.pos.position ){\n    //         case NORTH: drawRect(ctx,l+g,t+g,r-g,t+g+zone); break;\n    //         case SOUTH: drawRect(ctx,l+g,b-g-zone,r-g,b-g); break;\n    //         case EAST: drawRect(ctx,r-g-zone,t+g,r-g,b-g); break;\n    //         case WEST: drawRect(ctx,l+g,t+g,l+zone,b-g); break;\n    //     }\n\n    //     ctx.closePath();\n    //     ctx.fill();\n\n    // }\n}\n\nfunction drawDropOptions(canvas, dropTarget, measurements, w, h, offsetTop, offsetLeft) {\n\n    // PopupService.showPopup({component : (\n    //         <DropMenu dropTarget={dropTarget} measurements={measurements}\n    //             onMouseOver={handleMouseOver(canvas, measurements, w, h)} /> )});\n\n    // _dropMenu = true;\n\n    _konvaDropMenu.computeMenuPosition(dropTarget, measurements, offsetTop, offsetLeft);\n\n    _layer.draw();\n\n}\n\n\n// function handleMouseOver(canvas, measurements, w, h) {\n//     return function (dropTarget) {\n//         draw(canvas, dropTarget, measurements, w, h, 0, 0, true);\n//     };\n// }\n\n\nfunction setCanvasStyles(ctx, styles) {\n    ctx.strokeStyle = styles.strokeStyle || 'black';\n    ctx.lineWidth = styles.lineWidth || 2;\n    ctx.fillStyle = styles.fillStyle || 'rgba(255,0,0,.5)';\n\n    // if (_multiDropOptions){\n    // \tctx.setLineDash([15,10]);\n    // }\n}\n\nfunction drawRect(ctx, x1, y1, x2, y2) {\n\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y1);\n    ctx.lineTo(x2, y2);\n    ctx.lineTo(x1, y2);\n\n\n}\n\n\n","\n\nimport {BoxModel, positionValues} from './model/boxModel';\nimport {containerOf} from './model/layoutModel';\n\nexport default class DropTarget {\n\n\tconstructor({component, pos/*, closeToTheEdge*/, nextDropTarget}){\n\t    this.component = component; \n\t    this.pos = pos;\n\t    this.nextDropTarget = nextDropTarget;\n\t    this.active = false;       \n\t}\n\n\tactivate(){\n\t    this.active=true;\n\t    return this;\n\t}\n\n\tstatic getActiveDropTarget(dropTarget){\n\t    return dropTarget.active ? dropTarget : DropTarget.getActiveDropTarget(dropTarget.nextDropTarget);\n\t}\n\n\t    // Initial entry to this method is always via the app (may be it should be *on* the app)\n\tstatic identifyDropTarget(x, y, model, dragState, measurements){\n\n\t     let dropTarget = null;\n\t   \n\t    //onsole.log('Draggable.identifyDropTarget for component  ' + box.name + ' (' + box.nestedBoxes.length + ' children)') ;\n        // this could return all boxes containing point, which would make getNextDropTarget almost free\n        // Also, if we are over  atabstrip, it could include the actual tab\n\t    var component = BoxModel.smallestBoxContainingPoint(model, measurements, x, y);\n\t    \n\t    if (component){\n\t        // onsole.log(`%cidentifyDropTarget target path ${component.$path}\n\t        //     position: ${JSON.stringify(component.$position)}\n\t        //     measurements : ${JSON.stringify(_measurements[component.$path])}\n\t        //     `,'color:cornflowerblue;font-weight:bold;');\n\t        const pos = BoxModel.pointPositionWithinRect(x,y,measurements[component.$path]);\n            const nextDropTarget = getNextDropTarget(model, component, pos, dragState.constraint.zone, measurements, x, y);\n\t        dropTarget = new DropTarget({component, pos, nextDropTarget}).activate()\n\t    \n\t        // onsole.log('%c'+printDropTarget(dropTarget),'color:green');\n\n\t    }\n\n\t    //onsole.log(`\\n${printDropTarget(dropTarget)}`);\n\n\t    return dropTarget;\n\t}\n\n}\n\n// must be cleared when we end the drag\n// layout never changes\n// component never changes\n// pos neve changes\n// zone enver changes\n// measurements never change\nexport function getNextDropTarget(layout, component, pos, zone, measurements, x, y){\n\n\tconst {north, south, east, west} = positionValues;\n\tconst eastwest = east+west;\n\tconst northsouth = north+south;\n\n    return next();\n\n    function next(container=containerOf(layout, component)){\n\n        if (pos.position.Header || pos.closeToTheEdge){\n\n            let nextDropTarget = false;\n\n            // experiment...\n            let containerPos = BoxModel.pointPositionWithinRect(x,y,measurements[container.$path]);\n\n            while (container && positionedAtOuterContainerEdge(container, pos, component, measurements)){               \n                //onsole.log(`${component.type} positioned at outer edge of container ${container.type}`);\n                // if its a VBox and we're close to left or right ...\n                if ((isVBox(container) || isTabbedContainer(container)) && (pos.closeToTheEdge & eastwest)){\n                    nextDropTarget = true;\n                    containerPos.width = 120;\n                }\n                // if it's a HBox and we're close to top or bottom ...\n                else if ((isHBox(container) || isTabbedContainer(container)) && (pos.position.Header || (pos.closeToTheEdge & northsouth))){\n                    nextDropTarget = true;\n                    containerPos.height = 120;\n                }\n                if (nextDropTarget){\n                    if (containerPos.position.Header){\n                        containerPos = {...containerPos, position:north};    \n                    }\n                    // For each DropTarget, specify which drop operations are appropriate\n                    return new DropTarget({\n                        component:container, \n                        pos: containerPos, // <<<<  a local pos for each container\n                        nextDropTarget: next(containerOf(layout, container))\n                    });\n                }\n\n                container = containerOf(layout, container);\n            }\n        } \n    }\n}\n\nfunction positionedAtOuterContainerEdge(containingComponent, {closeToTheEdge,position}, component, measurements){\n    \n    const containingBox = measurements[containingComponent.$path]; \n    const box = measurements[component.$path];\n\n    const closeToTop = closeToTheEdge & positionValues.north;\n    const closeToRight = closeToTheEdge & positionValues.east;\n    const closeToBottom = closeToTheEdge & positionValues.south;\n    const closeToLeft = closeToTheEdge & positionValues.west;\n\n    if ((closeToTop || position.Header) && box.top === containingBox.top) return true;\n    if (closeToRight && box.right === containingBox.right) return true;\n    if (closeToBottom && box.bottom === containingBox.bottom) return true;\n    if (closeToLeft && box.left === containingBox.left) return true;\n\n    return false\n}\n\nfunction isTabbedContainer({type}){\n    return type === 'TabbedContainer';\n}\n\nfunction isVBox({type,style:{flexDirection}}){\n    return type === 'FlexBox' &&  flexDirection === \"column\";\n}\n\nfunction isHBox({type, style:{flexDirection}}){\n    return type === 'FlexBox' &&  flexDirection === \"row\";\n}\n\n\n// const w = '  ';\n\n// function printDropTarget(dropTarget, s=w){\n\n// \tconst {pos} = dropTarget;\n// \tconst ctte = pos.closeToTheEdge ? `=>${printClose(pos.closeToTheEdge)}<=` : '';\n//     const size = pos.width ? ` width:${pos.width} ` : pos.height ? ` height:${pos.height} ` : '';\n\n//     var str = `<${dropTarget.component.type}> ${ctte} ${size} $${dropTarget.component.$path}`;\n//     if (dropTarget.nextDropTarget != null){\n//         str += `\\n${s} ${printDropTarget(dropTarget.nextDropTarget,s+w)}` \n//     }\n//     return str;\n// }\n\n// function printClose(val){\n// \tvar s = '';\n// \tif (val & 1) s+= 'N';\n// \tif (val & 4) s+= 'S';\n// \tif (val & 2) s+= 'E';\n// \tif (val & 8) s += 'W';\n// \treturn s;\n// }\n\n","\nimport {BoxModel} from './model/index';\n\nvar SCALE_FACTOR = 0.4;\n\nexport default class DragState {\n\n    constructor(zone, mouseX, mouseY, measurements){\n        this.init(zone, mouseX, mouseY, measurements);\n    }\n\n    init(zone, mouseX, mouseY, rect){\n        \n        var {left: x, top: y} = rect;\n\n        var mousePosition = BoxModel.pointPositionWithinRect(mouseX,mouseY,rect);\n\n        // We are applying a scale factor of 0.4 to the draggee. This is purely a visual\n        // effect - the actual box size remains the original size. The 'leading' values \n        // represent the difference between the visual scaled down box and the actual box.\n\n        var scaleFactor = SCALE_FACTOR;\n\n        var leadX = mousePosition.pctX * rect.width;\n        var trailX = rect.width - leadX;\n        var leadY = mousePosition.pctY * rect.height;\n        var trailY = rect.height - leadY;\n\n        // When we assign position to rect using css. positioning units are applied to the \n        // unscaled shape, so we have to adjust values to take scaling into account.\n        var scaledWidth = rect.width * scaleFactor,\n            scaledHeight = rect.height * scaleFactor;\n\n        var scaleDiff = 1 - scaleFactor;\n        var leadXScaleDiff = leadX * scaleDiff; \n        var leadYScaleDiff = leadY * scaleDiff; \n        var trailXScaleDiff = trailX * scaleDiff; \n        var trailYScaleDiff = trailY * scaleDiff; \n\n        this.constraint = {\n            zone : {\n                x : {\n                    lo: zone.left,\n                    hi: zone.right\n                },\n                y : {\n                    lo: zone.top,\n                    hi: zone.bottom\n                }\n            },\n\n            pos : {\n                x : {\n                    lo: /* left */ zone.left - leadXScaleDiff,\n                    hi: /* right */ zone.right - rect.width + trailXScaleDiff\n                },\n                y : {\n                    lo: /* top */ zone.top - leadYScaleDiff,\n                    hi: /* bottom */ zone.bottom - rect.height + trailYScaleDiff\n                }\n            },\n            mouse :{\n                x : {\n                    lo: /* left */ zone.left + scaledWidth * mousePosition.pctX,\n                    hi: /* right */ zone.right - scaledWidth * (1-mousePosition.pctX)\n                },\n                y: {\n                    lo: /* top */ zone.top + scaledHeight * mousePosition.pctY,\n                    hi: /* bottom */ zone.bottom - scaledHeight * (1-mousePosition.pctY)\n                }\n            }\n        };\n\n        //onsole.log(JSON.stringify(this.constraint,null,2));\n\n        this.x = {pos:x, lo: false, hi: false, mousePos: mouseX, mousePct: mousePosition.pctX};\n        this.y = {pos:y, lo: false, hi: false, mousePos: mouseY, mousePct: mousePosition.pctY};\n\n    }\n\n    outOfBounds(){\n        return this.x.lo || this.x.hi || this.y.lo || this.y.hi;\n    }\n\n    inBounds(){\n        return !this.outOfBounds();\n    }\n\n    dropX(){\n        return dropXY.call(this,'x');\n    }\n\n    dropY(){\n        return dropXY.call(this,'y');\n    }\n\n\n    /*\n     *  diff = mouse movement, signed int\n     *  xy = 'x' or 'y'\n     */\n     //todo, diff can be calculated in here\n    update(xy, mousePos){\n\n        var state = this[xy],\n            mouseConstraint = this.constraint.mouse[xy],\n            posConstraint = this.constraint.pos[xy],\n            previousPos = state.pos;\n\n       var diff = mousePos - state.mousePos;\n\n       //xy==='x' && console.log(`update: state.lo=${state.lo}, mPos=${mousePos}, mC.lo=${mouseConstraint.lo}, prevPos=${previousPos}, diff=${diff} `  );\n\n        if (diff < 0){\n            if (state.lo) {/* do nothing */}\n\n            else if (mousePos < mouseConstraint.lo){\n                state.lo = true;\n                state.pos =  posConstraint.lo;\n            }\n            else if (state.hi){\n                if (mousePos < mouseConstraint.hi){\n                    state.hi = false;\n                    state.pos += diff;\n                }\n            }\n            else {\n                state.pos += diff;\n            }\n        }\n        else if (diff > 0){\n            if (state.hi){/* do nothing */}\n\n            else if (mousePos > mouseConstraint.hi){\n                state.hi = true;\n                state.pos =  posConstraint.hi;\n            }\n            else if (state.lo){\n                if (mousePos > mouseConstraint.lo){\n                    state.lo = false;\n                    state.pos += diff;\n                }\n            }\n            else {\n                state.pos += diff;\n            }\n        }\n\n        state.mousePos = mousePos;\n\n        return previousPos !== state.pos;\n\n    }\n\n}\n\nfunction dropXY(dir){\n\n    var pos = this[dir],\n        rect = this.constraint.zone[dir];\n        // why not do the rounding +/- 1 on the rect initially - this is all it is usef for\n    return pos.lo ? Math.max(rect.lo,pos.mousePos) : pos.hi ? Math.min(pos.mousePos, Math.round(rect.hi) -1) : pos.mousePos;\n\n}\n\n","\nimport ReactDOM from 'react-dom';\nimport DropTargetCanvas from './drop-target-canvas';\nimport DropTarget from './drop-target';\nimport DragState from './drag-state';\nimport { followPath, BoxModel, Position } from './model/index';\n\nvar _dragCallback;\nvar _dragStartX;\nvar _dragStartY;\nvar _dragContainer;\nvar _dragState;\nvar _dragThreshold = 5;\nvar _dropTarget = null;\nvar _measurements;\nvar _simpleDrag;\nvar _dropTargetCanvas = new DropTargetCanvas();\nvar _dragContainers = [];\nvar SCALE_FACTOR = 0.4;\n\nexport class DragContainer {\n\n    static register(path) {\n        // need to decide how to store these\n        _dragContainers.push(path);\n    }\n\n    static unregister(/*path*/) {\n\n    }\n}\n\nfunction getDraggable(component) {\n    var target;\n\n    var header = component.refs.header || component.tabstrip;\n    if (header && header.props.draggable) {\n        target = header;\n    } else if (component.props.draggable) {\n        target = component;\n    }\n    return target;\n}\n\nexport var Draggable = {\n\n    // bound to target components when called\n    componentDidMount() {\n\n        // // can we always rely on dragContainer being available at this point ?\n        // // Might we have to wait for layout ?\n        // if (this.props.dragContainer === true){\n        //     DragContainer.register(this);\n        // }\n\n        var draggable = getDraggable(this);\n        if (draggable) {\n            this.mouseDownHandler = Draggable.handleMousedown.bind(this);\n            ReactDOM.findDOMNode(draggable).addEventListener('mousedown', this.mouseDownHandler, false);\n        }\n    },\n\n    componentWillUnmount() {\n\n        var draggable = getDraggable(this);\n        if (draggable) {\n            ReactDOM.findDOMNode(draggable).removeEventListener('mousedown', this.mouseDownHandler, false);\n            this.mouseDownHandler = null;\n        }\n    },\n\n    // bound to Draggable Component\n    handleMousedown(e, dragStartCallback) {\n\n        _dragCallback = dragStartCallback;\n\n        _dragStartX = e.clientX;\n        _dragStartY = e.clientY;\n\n        window.addEventListener('mousemove', preDragMousemoveHandler, false);\n        window.addEventListener('mouseup', preDragMouseupHandler, false);\n\n        e.preventDefault();\n    },\n\n    initDrag(e, layoutModel, path, { top, left, right, bottom }, dragHandler) {\n\n        _dragCallback = dragHandler;\n\n        return initDrag(e, layoutModel, path, { top, left, right, bottom });\n\n    }\n};\n\nfunction preDragMousemoveHandler(e) {\n\n    var x = true;\n    var y = true;\n\n    let x_diff = x ? e.clientX - _dragStartX : 0;\n    let y_diff = y ? e.clientY - _dragStartY : 0;\n    let mouseMoveDistance = Math.max(Math.abs(x_diff), Math.abs(y_diff));\n\n    // when we do finally move the draggee, we are going to 'jump' by the amount of the drag threshold, should we\n    // attempt to animate this ?    \n    if (mouseMoveDistance > _dragThreshold) {\n\n        window.removeEventListener('mousemove', preDragMousemoveHandler, false);\n        window.removeEventListener('mouseup', preDragMouseupHandler, false);\n\n        if (_dragCallback(e, x_diff, y_diff) !== false) {\n            window.addEventListener('mousemove', dragMousemoveHandler, false);\n            window.addEventListener('mouseup', dragMouseupHandler, false);\n        }\n    }\n}\n\nfunction preDragMouseupHandler() {\n\n    window.removeEventListener('mousemove', preDragMousemoveHandler, false);\n    window.removeEventListener('mouseup', preDragMouseupHandler, false);\n\n}\n\nfunction getDragContainer(layoutModel, path) {\n\n    var pathToContainer = '';\n    var maxSteps = 0;\n\n    // If the model has no path (i.e. it hasn't been dragged out of the existing layout)\n    // hiow do we decide the dragContainer to use (assuming there may be more than 1)\n    if (path === undefined) {\n        pathToContainer = _dragContainers[0];\n    }\n    else {\n        // find the longest container path that matches path (ie the smallest enclosing container); \n        for (var i = 0; i < _dragContainers.length; i++) {\n            if (path.indexOf(_dragContainers[i]) === 0) {\n                var steps = _dragContainers[i].split('.').length;\n                if (steps > maxSteps) {\n                    maxSteps = steps;\n                    pathToContainer = _dragContainers[i];\n                }\n            }\n        }\n    }\n\n    return followPath(layoutModel, pathToContainer);\n\n}\n\nfunction initDrag(evt, layoutModel, path, dragRect) {\n\n    _dragContainer = getDragContainer(layoutModel, path);\n\n    var start = window.performance.now();\n\n    // translate the layout $position to drag-oriented co-ordinates, ignoring splitters\n    _measurements = BoxModel.measure(layoutModel);\n    var end = window.performance.now();\n\n    console.log(`initDrag taking measurements took ${end - start} ms dragContainer version ${_dragContainer.$version}`);\n\n    var { type, $path } = _dragContainer;\n\n    var dragZone = _measurements[$path];\n\n    _dragState = new DragState(dragZone, evt.clientX, evt.clientY, dragRect);\n\n    var pctX = Math.round(_dragState.x.mousePct * 100);\n    var pctY = Math.round(_dragState.y.mousePct * 100);\n\n    if (type === 'Surface') {\n\n        _simpleDrag = true;\n\n        return {};\n\n    } else {\n\n        _simpleDrag = false;\n\n        _dropTargetCanvas.prepare(dragZone);\n\n        return {\n            draggableWidth: dragRect.right - dragRect.left,\n            draggableHeight: dragRect.bottom - dragRect.top,\n            transform: `scale(${SCALE_FACTOR},${SCALE_FACTOR})`,\n            transformOrigin: pctX + \"% \" + pctY + \"%\"\n        };\n    }\n}\n\nfunction dragMousemoveHandler(evt) {\n\n    const x = evt.clientX;\n    const y = evt.clientY;\n    const dragState = _dragState;\n    var currentDropTarget = _dropTarget;\n    var dropTarget;\n\n    var newX, newY;\n\n    if (dragState.update('x', x)) {\n        newX = dragState.x.pos;\n    }\n\n    if (dragState.update('y', y)) {\n        newY = dragState.y.pos;\n    }\n\n    if ((newX === undefined) && (newY === undefined)) {\n        //onsole.log('both x and y are unchanged');\n    } else {\n        _dragCallback.drag(newX, newY);\n    }\n\n    if (_simpleDrag) {\n        return;\n    }\n\n    if (dragState.inBounds()) {\n        dropTarget = DropTarget.identifyDropTarget(x, y, _dragContainer, dragState, _measurements);\n    } else {\n        dropTarget = DropTarget.identifyDropTarget(dragState.dropX(), dragState.dropY(), _dragContainer, dragState, _measurements);\n    }\n\n    // did we have an existing droptarget which is no longer such ...\n    if (currentDropTarget) {\n        if (dropTarget == null || dropTarget.box !== currentDropTarget.box) {\n            _dropTarget = null;\n        }\n    }\n\n    if (dropTarget) {\n\n        _dropTargetCanvas.draw(dropTarget, _measurements, x, y);\n\n        _dropTarget = dropTarget;\n\n        // if (currentDropTarget && \n        //     currentDropTarget.component === dropTarget.component &&\n        //     currentDropTarget.pos.position === dropTarget.pos.position &&\n        //     // experiment...\n        //     currentDropTarget.pos.closeToTheEdge === dropTarget.pos.closeToTheEdge){\n        //     // no change from last turn, don't assign to _dropTarget, we might lose settings\n\n        //     //onsole.log('%cSame Drop Target/Position','color:green');\n\n        //     // BUT, we are going to want to reposition the dropmenu ... \n\n        // }\n        // else {\n\n        //     // redraw position marker\n        //     //onsole.log('%cNew Drop Target/Position','color:red;font-weight:bold;');\n        //     _dropTargetCanvas.draw(dropTarget, _measurements);\n\n        //     _dropTarget = dropTarget;\n\n        // }\n\n    }\n}\n\nfunction dragMouseupHandler(evt) {\n    onDragEnd(evt);\n}\n\nfunction onDragEnd() {\n\n    if (_dropTarget) {\n\n        const dropTarget = _dropTargetCanvas.hoverDropTarget || DropTarget.getActiveDropTarget(_dropTarget);\n        if (_dropTargetCanvas.dropTargetIsTabstrip) {\n            dropTarget.tabIndex = _dropTargetCanvas.currentTabIndex;\n\n            // EXPERIMENT ----------- What is this trying to do ? (cos it's not working)\n            const selector = `:scope > .Tabstrip > .tabstrip-inner-sleeve > .tabstrip-inner > .Tab:nth-child(${dropTarget.tabIndex + 1})`;\n            const tabstrip = document.getElementById(dropTarget.component.$path);\n            if (tabstrip){\n                const tab = tabstrip.querySelector(selector);\n                if (tab){\n                    tab.style.cssText = '';\n                }\n            } else {\n                console.log(`dropTarget indicated to be Tabstrip, but is not`);\n            }\n            //----------------------\n\n        }\n\n        // looking into eliminating this call altogether. We don't need it if we set the dragging index via\n        // top-level layout state\n\n        _dragCallback.drop(dropTarget, _measurements);\n\n        _dropTarget = null;\n    }\n    else {\n        _dragCallback.drop({ component: _dragContainer, pos: { position: Position.Absolute } });\n    }\n\n    _dragCallback = null;\n    _dragContainer = null;\n    _dropTargetCanvas.clear();\n\n    window.removeEventListener('mousemove', dragMousemoveHandler, false);\n    window.removeEventListener('mouseup', dragMouseupHandler, false);\n\n}","import React from 'react';\nimport {registerClass} from './componentRegistry';\nimport {getLayoutModel} from './util/component-utils';\nimport LayoutItem from './layout-item';\nimport {Draggable} from './draggable';\nimport {layout as applyLayout, handleLayout,followPath} from './model/index';\n\nexport default class Container extends React.Component {\n\n   constructor(props){\n        super(props);\n        const layoutModel = this.getLayoutModel();\n        this.state = {\n            layoutModel,\n            ...this.getState()\n        }\n\n        this.handleLayout = this.handleLayout.bind(this);\n    }\n\n    getState(){\n        return {};\n    }\n\n    isLayoutRoot(){\n        return this.props.layoutModel === undefined;\n    }\n\n    render(){\n        var {style} = this.props;\n        var layoutModel = this.getLayoutModel();\n        var {layout, $position=layout} = layoutModel;\n\n        return (\n            <div className={layoutModel.type} style={{...style, position: 'absolute', ...$position}}>\n                {layoutModel.children.map((child,idx) => this.renderChild(child,idx))}\n            </div>\n        );\n    }\n\n    renderChild(layoutModel){\n\n        const {children: child , onLayout} = this.props;\n        const {style} = child.props;\n\n        let props = {\n            layoutModel,\n            onLayout\n        };\n\n        const id = props.layoutModel.$id;\n\n        props.id = id;\n        props.key = id;\n        props.style = {...style, ...props.style};\n\n        if (isLayout(layoutModel.type)){\n            return React.cloneElement(child, props);\n        } else {\n            return <LayoutItem {...child.props} {...props}>{child}</LayoutItem>;\n        }\n\n    }\n\n    componentDidMount(){\n        const {layoutModel=null, onLayoutModel} = this.props;\n        if (layoutModel === null && onLayoutModel){\n            onLayoutModel(this.state.layoutModel);\n        }\n    }\n\n    shouldComponentUpdate(nextProps){\n        // if the Application passes down the dragging flag, do not render, the only rendering\n        // to take place happens on the DragSurface.\n        // if (nextProps.dragging){\n        // onsole.log(`Container ${this.props.layoutModel.type} dragging  so don't update`);\n        // }\n        return nextProps.dragging !== true;\n    }\n\n    getLayoutModel(){\n\n        if (this.isLayoutRoot()){\n            return applyLayout(getLayoutModel(this));\n        } else {\n            return this.props.layoutModel;\n        }\n        \n        // let {layoutModel/*,style*/} = this.props;\n\n        // if (layoutModel === undefined){\n        //     // console.log(`getRootLayoutModel for ${typeOf(this)}`);\n        //     return applyLayout(getLayoutModel(this));\n        // } /*else if (layoutModel.children && layoutModel.children.length === 0){\n        //     alert('it happens')\n        //     console.log(`mutating (appending) layoutModel children. Can this be avoided ?`)\n        //     var children = getLayoutModelChildren(this);\n\n        //     [].push.apply(layoutModel.children, children);\n\n        //     var VISIBLE = style.visibility || 'visible';\n        //     var FORCE_LAYOUT = true;\n\n        //     var width;\n        //     var height;\n        //     var $position = layoutModel.$position;\n\n        //     if (typeof style.width === 'number' && typeof style.height === 'number'){\n        //         width = style.width;\n        //         height = style.height;\n        //     } else if ($position && $position.width !== undefined && $position.height !== undefined){\n        //         width = $position.width;\n        //         height = $position.height;\n        //     } else {\n        //         console.error(`Container.getLayoutModel attempting to initialize a ${layoutModel.type} layoutModel with no sizing attributes`)\n        //     }\n        //     console.log(`apply layout, WITH CHILDREN`)\n        //     var layoutModel2 = applyLayout(layoutModel, {width,height}, layoutModel.$path, VISIBLE, FORCE_LAYOUT);\n\n        //     layoutModel.children = layoutModel2.children;\n\n        // } */\n\n        // return layoutModel;\n\n    }\n\n    getManagedDimension(){\n        return null;\n    }\n\n    handleLayout(command, options){\n\n        // is there some other way we can nominate the layout as a root, other than $path === '0'\n        if (this.state.layoutModel && this.state.layoutModel.$path === '0' /*&& !this.props.layoutModel*/){\n            // This is a top=level layout and the owner has not taken responsibility for layout, so we need to\n            // Note: this will currently work only when the top-level container maintains its layoutModel in \n            // state (FlexBox and TabbedContainer)- other containers CAN be nested. \n            if (command === 'drag-start'){\n                if (this.handleDragStart){\n                    Draggable.handleMousedown(options.evt, this.handleDragStart.bind(this, options));\n                }\n            } else {\n                let layoutModel;\n\n                if (command === 'replace'){\n                    const {model: replacementNode} = options;\n                    const targetNode = followPath(this.state.layoutModel, replacementNode.$path);\n                    layoutModel = handleLayout(this.state.layoutModel, command, {targetNode, replacementNode});\n                } else if (command === 'switch-tab'){\n                    layoutModel = handleLayout(this.state.layoutModel, 'switch-tab', options);\n                } else if (command === 'drop'){\n                    layoutModel = handleLayout(this.state.layoutModel, 'drop', options);\n                } else {\n                    throw Error(`Container: don't know how to handle command ${command}`);\n                }\n                if (layoutModel !== this.state.layoutModel){\n                    this.setState({layoutModel});\n                    if (this.props.onLayoutModel){\n                        this.props.onLayoutModel(layoutModel);\n                    }\n                }\n            }\n        } else if (this.props.onLayout){\n            this.props.onLayout(command, options);\n        }\n    }\n\n}\n\nContainer.defaultProps = {\n    style: {flex: 1}\n}\n\nregisterClass('Container', Container, true);\n","\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport cx from 'classnames';\n\nvar _splitter,\n    _mousedown = false,\n    _direction,\n    _diff = 0;\n\n\nexport default class Splitter extends React.Component {\n\n    render() {\n\n        const { layout } = this.props.layoutModel\n        var { top, left, width, height } = layout;\n\n        // onsole.log(`%c     Splitter ${top},${left},${width},${height}`,`background-color:brown;color:lime;`);\n\n        var className = cx(\n            'Splitter',\n            this.props.className\n        );\n\n        var style = { position: 'absolute', top, left, width, height, cursor: this.props.cursor };\n\n        return <div className={className} style={style} />\n    }\n\n    componentDidMount() {\n        this._mouseDownHandler = this.handleMousedown.bind(this);\n        ReactDOM.findDOMNode(this).addEventListener('mousedown', this._mouseDownHandler, false);\n    }\n\n    componentWillUnmount() {\n        ReactDOM.findDOMNode(this).removeEventListener('mousedown', this._mouseDownHandler, false);\n        this._mouseDownHandler = null;\n    }\n\n    handleMousedown(e) {\n\n        _splitter = this;\n        _mousedown = true;\n        _diff = 0;\n\n        initDrag.call(this, e);\n\n        window.addEventListener(\"mousemove\", mouseMoved, false);\n        window.addEventListener(\"mouseup\", mouseUp, false);\n\n        e.preventDefault();\n    }\n\n}\n\nSplitter.defaultProps = {\n    style: {}\n};\n\nfunction mouseMoved(evt) {\n    return onDrag.call(_splitter, evt)\n}\n\nfunction mouseUp(evt) {\n    return onDragEnd.call(_splitter, evt)\n}\n\nfunction initDrag(e) {\n\n    _direction = this.props.direction;\n\n    var vertical = _direction === \"vertical\";\n    // var dim = vertical ? \"height\" : \"width\";\n\n    this.lastPos = (vertical ? e.clientY : e.clientX);\n\n    this.props.onDragStart(this.props.absIdx);\n\n}\n\nfunction onDrag(evt) {\n\n    var clientPos/*,\n        dimension*/;\n\n    if (_direction === 'vertical') {\n        clientPos = \"clientY\";\n        // dimension = \"height\";\n    }\n    else {\n        clientPos = \"clientX\";\n        // dimension = \"width\";\n    }\n\n    var pos = evt[clientPos],\n        diff = pos - this.lastPos;\n\n\n    // we seem to get a final value of zero\n    if (pos && (pos !== this.lastPos)) {\n        this.props.onDrag(diff);\n    }\n\n    this.lastPos = pos;\n\n}\n\nfunction onDragEnd() {\n\n    _mousedown = false;\n    _splitter = null;\n\n    window.removeEventListener(\"mousemove\", mouseMoved, false);\n    window.removeEventListener(\"mouseup\", mouseUp, false);\n\n    this.props.onDragEnd();\n\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport cx from 'classnames';\nimport Splitter from './splitter';\nimport LayoutItem from './layout-item';\nimport ComponentHeader from './component-header';\nimport Container from './container';\nimport {isLayout} from './util/component-utils'\nimport { registerClass } from './componentRegistry';\nimport {\n    handleLayout as handleModelLayout,\n    layout as applyLayout,\n    layoutStyleDiff\n} from './model/index';\n\nconst NO_STYLE = {}\n\nexport default class FlexBox extends Container {\n\n    render() {\n\n        var { style=NO_STYLE, isSelected, title } = this.props;\n        var { layout, header, style: {boxShadow} } = this.state.layoutModel;\n        if (this.state.layoutModel.$id === 'col-picker'){\n            console.log(`FlexBox.render layout ${JSON.stringify(this.state.layoutModel,null,2)}`);\n        }\n        const {backgroundColor, visibility} = style\n        var className = cx(\n            style.flexDirection === 'row' ? 'Terrace' : 'Tower',\n            this.props.className,\n            isSelected ? 'active' : null\n        );\n\n        if (visibility === 'hidden') {\n            return null;\n        }\n        const position = this.isLayoutRoot()\n            ? 'relative'\n            : 'absolute'; \n\n        return (\n            <div className={className} style={{ position, ...layout, backgroundColor, boxShadow }}>\n                {header &&\n                     <ComponentHeader\n                         title={`${title}`}\n                         onMouseDown={e => this.handleMouseDown(e)}\n                         style={{height: header.height}}\n                         menu={header.menu} />\n                }\n            \n                {this.renderFlexibleChildren()}\n            </div>\n        );\n    }\n\n    renderFlexibleChildren() {\n\n        var { style: { flexDirection }, visibility } = this.props;\n        var cursor = flexDirection === 'column' ? 'ns-resize' : 'ew-resize';\n        var splitterIdx = 0;\n        var {children: layoutChildren} = this.state.layoutModel;\n        const propChildren = Array.isArray(this.props.children)\n            ? this.props.children.filter(child => child)\n            : [this.props.children];\n\n        var results = [];\n\n        for (var idx = 0, childIdx = 0; idx < layoutChildren.length; idx++) {\n\n            var childLayoutModel = layoutChildren[idx];\n\n            if (childLayoutModel.type === 'Splitter') {\n\n                //TODO do we still need the refs ?\n                results.push(\n                    <Splitter ref={'splitter-' + splitterIdx}\n                        key={'splitter-' + childIdx}\n                        idx={childIdx}\n                        absIdx={idx}\n                        direction={flexDirection === 'column' ? 'vertical' : 'horizontal'}\n                        cursor={cursor}\n                        onDragStart={this.splitterDragStart.bind(this)}\n                        onDrag={this.splitterMoved.bind(this)}\n                        onDragEnd={() => this.handleSplitterDragEnd()}\n                        onLayout={this.handleLayout}\n                        layoutModel={childLayoutModel} />\n                );\n\n                splitterIdx += 1;\n\n            } else {\n\n                var child = propChildren[childIdx];\n                var { style = {}, ...childProps } = child.props;\n                var id = childLayoutModel.$id;\n\n                var props = {\n                    id,\n                    key: id,\n                    idx: childIdx,\n                    absIdx: idx,\n                    onLayout: this.handleLayout,\n                    onConfigChange: this.handleConfigChange.bind(this),\n                    layoutModel: childLayoutModel\n                };\n\n                style = { ...style, visibility };\n\n                if (props.dragContainer === true && child.type.displayName !== 'Container') {\n                    //onsole.log(`FlexBox wrapping ${child.type.displayName} with Container `);\n                    const { width, height } = props.layoutModel.$position; // IS HTIS RIGHT ?\n                    results.push(<Container {...childProps} {...props} style={{ flex: style.flex, width, height, visibility }} >{child}</Container>);\n                } else if (isLayout(child)) {\n                    results.push(React.cloneElement(child, { ...props, style }));\n                } else {\n                    results.push(<LayoutItem {...childProps} {...props} style={style}>{child}</LayoutItem>);\n                }\n\n                childIdx += 1;\n\n            }\n        }\n\n        return results;\n\n    }\n\n    componentWillReceiveProps(nextProps) {\n        var { layoutModel } = nextProps;\n        if (layoutModel && layoutModel !== this.state.layoutModel) {\n            this.setState({ layoutModel });\n        } else if (this.state.layoutModel.$path === '0') {\n            // detact changes to style that will affect layout\n            if (layoutStyleDiff(this.props.style, nextProps.style)) {\n                const {width, height} = nextProps.style\n                const VISIBLE = nextProps.style.visibility || 'visible';\n                const FORCE_LAYOUT = true;\n                this.setState({\n                    layoutModel: applyLayout(\n                        {\n                            ...this.state.layoutModel,\n                            style: nextProps.style\n                        },\n                        { width, height },\n                        this.state.layoutModel.$path,\n                        VISIBLE,\n                        FORCE_LAYOUT)\n                });\n            }\n\n        }\n    }\n\n    getManagedDimension() {\n        var { style: { flexDirection } } = this.state.layoutModel;\n        return flexDirection === 'row' ? 'width' : 'height';\n    }\n\n    getDragPermission(component) {\n        if (component.constructor.displayName === 'Splitter') {\n            return this.props.style.flexDirection === 'row' ? { y: false, x: true } : { x: false, y: true };\n        } else {\n            return { x: true, y: true };\n        }\n    }\n\n    // copied from layoutItem\n    handleMouseDown(e){\n        if (this.props.onMouseDown) {\n            this.props.onMouseDown({\n                model: this.props.layoutModel,\n                evt: e,\n                position: ReactDOM.findDOMNode(this).getBoundingClientRect()\n            });\n        } else {\n            this.props.onLayout('drag-start', {\n                model: this.state.layoutModel,\n                evt: e,\n                position: ReactDOM.findDOMNode(this).getBoundingClientRect()\n            });\n        }\n    }\n\n    splitterDragStart(idx) {\n        this.splitChildren = this.identifySplitChildren(idx);\n    }\n\n    splitterMoved(distance) {\n        const [idx1, , idx2] = this.splitChildren;\n        const dim = this.getManagedDimension();\n        let layoutModel = this.state.layoutModel;\n        const measurements = layoutModel.children.map(child => child.layout[dim]);\n        measurements[idx1] += distance;\n        measurements[idx2] -= distance;\n        const RESIZE = 'resize';\n        var options = {\n            path: layoutModel.$path,\n            measurements,\n            dimension: dim\n        };\n        layoutModel = handleModelLayout(layoutModel, RESIZE, options);\n        this.setState({ layoutModel });\n    }\n\n    identifySplitChildren(splitterIdx){\n        const children = this.state.layoutModel.children;\n        let idx1 = splitterIdx - 1;\n        let idx2 = splitterIdx + 1;\n        let child;\n        while ((child = children[idx1]) && !child.resizeable) idx1--;\n        while ((child = children[idx2]) && !child.resizeable) idx2++;\n        return [idx1, splitterIdx, idx2];\n    }\n\n    handleSplitterDragEnd(){\n        this.handleLayout('replace', { model: this.state.layoutModel });\n        this.splitChildren = null;\n    }\n\n    handleConfigChange(component, { fixed }) {\n        if (fixed !== 'undefined') {\n            //TODO we don't need to do this if it has been done already\n            this.props.onLayout('config-change', {\n                dimensions: this.assignExplicitSizeToFlexElements(),\n                fixed,\n                component: component.props.json,\n                container: this.props.json\n            });\n        }\n    }\n\n}\n\nFlexBox.displayName = 'FlexBox';\nFlexBox.defaultProps = {\n    style: { flexDirection: 'column' }\n};\n\n\nregisterClass('FlexBox', FlexBox, true);\n","import React from 'react';\nimport cx from 'classnames';\nimport { PopupService } from './popup';\nimport { ContextMenu, MenuItem } from './context-menu';\nimport './tabstrip.css';\n\nconst OVERFLOW_WIDTH = 24;\n\nfunction handleClick(e,idx, onClick){\n    e.preventDefault();\n    onClick(idx);\n}\n\nexport const Tab = ({idx, text, isSelected, onClick, onMouseDown}) =>\n    <li className={cx('Tab', {'active': isSelected})}\n        onClick={e => handleClick(e, idx, onClick)}\n        onMouseDown={onMouseDown}>\n        <a href=\"#\" className=\"tab-caption\" data-idx={idx}>{text}</a>\n    </li>\n\nconst TabstripOverflow = ({onClick}) =>\n    <div className='TabstripOverflow' onClick={onClick} />;\n\nexport default class Tabstrip extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state = {\n            overflowing: false\n        };\n        this.el = null;\n    }\n\n\n    render() {\n\n        const { style, children, onMouseDown, selected=0 } = this.props;\n        const {overflowing} = this.state;\n        const className = cx('Tabstrip', this.props.className, {overflowing});\n\n        const tabs = children.map((child, idx) => {\n            return (\n                React.cloneElement(child, {\n                    idx,\n                    isSelected: selected === idx,\n                    onClick: i => this.handleTabClick(i)\n                }));\n        });\n\n        return (\n            <div className={className} style={style} onMouseDown={onMouseDown} ref={el => this.el = el}>\n                <div className=\"tabstrip-inner-sleeve\">\n                    <ul className=\"tabstrip-inner\">{tabs}</ul>\n                </div>\n                {overflowing && <TabstripOverflow onClick={() => this.showOverflow()} />}\n            </div>\n        );\n    }\n\n    componentDidMount() {\n        this.checkOverflowState();\n    }\n\n    componentDidUpdate() {\n        this.checkOverflowState();\n        // only necesary if selection has changed or tabstrip has resized\n        // make sure selected tab is in view \n        this.ensureSelectedTabisVisible();\n\n    }\n\n    checkOverflowState() {\n        const freeSpace = this.measureFreeSpace();\n        const {overflowing} = this.state;\n        if (freeSpace < 0 && overflowing === false) {\n            this.setState({ overflowing: true });\n        } else if (freeSpace >= 0 && overflowing === true) {\n            this.setState({ overflowing: false });\n        }\n    }\n\n     handleTabClick(selectedIdx){\n        if (selectedIdx !== this.props.selected) {\n            this.props.onSelectionChange(this.props.selected, selectedIdx);\n        }\n    }\n\n    ensureSelectedTabisVisible() {\n\n        const tabstripInner = this.el.querySelector('.tabstrip-inner');\n        const activeTab = tabstripInner.querySelector('.active.Tab');\n        if (!activeTab) {\n            // eg if dragging;\n            return;\n        }\n\n        const tsBox = this.el.getBoundingClientRect();\n        const tbBox = activeTab.getBoundingClientRect();\n        const ulBox = tabstripInner.getBoundingClientRect();\n\n        const tbOffStageRight = Math.floor(tsBox.right - tbBox.right);\n        const ulOffStageLeft = Math.floor(ulBox.left - tsBox.left);\n        const overflowing = ulBox.right > tbBox.right;\n        let translateX;\n\n        if (ulOffStageLeft === 0 && tbOffStageRight < 0) {\n            translateX = ulOffStageLeft + tbOffStageRight - OVERFLOW_WIDTH;\n            tabstripInner.style.transform = `translate(${translateX}px,0px)`;\n        } else if (ulOffStageLeft < 0 && tbOffStageRight === OVERFLOW_WIDTH) {\n            // no action necessary\n        } else if (ulOffStageLeft < 0 && tbOffStageRight < OVERFLOW_WIDTH) {\n            translateX = ulOffStageLeft + tbOffStageRight - OVERFLOW_WIDTH;\n            tabstripInner.style.transform = `translate(${translateX}px,0px)`;\n        } else if (overflowing && tbOffStageRight < OVERFLOW_WIDTH) {\n            translateX = tbOffStageRight - OVERFLOW_WIDTH;\n            tabstripInner.style.transform = `translate(${translateX}px,0px)`;\n        } else if (ulOffStageLeft < 0) {\n            translateX = Math.min(0, ulOffStageLeft + tbOffStageRight - OVERFLOW_WIDTH);\n            tabstripInner.style.transform = `translate(${translateX}px,0px)`;\n        }\n    }\n\n    measureFreeSpace() {\n        const tabstripInner = this.el.querySelector('.tabstrip-inner');\n        return this.el.clientWidth - tabstripInner.clientWidth;\n    }\n\n    showOverflow(){\n        const overflow = this.el.querySelector('.TabstripOverflow')\n        const { right, bottom } = overflow.getBoundingClientRect();\n        const {children: tabs} = this.props;\n        const menuItems = tabs.map(({props: {text}}) =>\n            <MenuItem key={text} action='setActiveTab' label={text} data={text} />);\n\n        PopupService.showPopup({\n            left: right,\n            top: bottom,\n            position: 'top-bottom-right-right',\n            component: (\n                <ContextMenu component={this} doAction={(action, data) => this.handleContextMenuAction(action, data)}\n                    left='auto' bottom='auto' right={0} top={0}>\n                    {menuItems}\n                </ContextMenu>\n            )\n        });\n    }\n\n    handleContextMenuAction(action, data){\n        if (action === 'setActiveTab'){\n            const idx = this.props.children.findIndex(tab => tab.props.text === data);\n            if (idx !== -1) {\n                this.handleTabClick(idx);\n            }\n        }\n    }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport cx from 'classnames';\nimport Tabstrip, {Tab} from './tabstrip';\nimport LayoutItem from './layout-item';\nimport Container from './container';\nimport {registerClass} from './componentRegistry';\nimport {layout as applyLayout} from './model/index';\n\nconst DEFAULT_TABSTRIP_HEIGHT = 34;\n\nexport default class TabbedContainer extends Container {\n\n    constructor(props){\n        super(props);\n        this.tabstrip = null;\n    }\n\n    render(){\n        var {style, tabstripHeight, children} = this.props;\n        const {layoutModel} = this.state;\n        var {$path, layout, $position=layout, active} = layoutModel;\n\n        // Don't allow either the tabs or the tabstrip itself to be dragged unless it is inside\n        // the DragZone. We might further config-enable this eg. allow tabs but not the tabstrip\n        // to be dragged when the TabbedContainer IS the DragZOne.\n        var isDraggable = true;\n\n        // Note: if key is not assigned here, we will get a React warning, even though it is assigned in Tabstrip !\n        var tabs = children.map((child,idx) => {\n            return <Tab key={idx} text={titleFor(child)} onMouseDown={e => this.handleMouseDown(e,layoutModel.children[idx])} />\n        });\n\n        var className = cx(\n            'TabbedContainer',\n            this.props.className\n        );\n\n        return (\n            <div id={$path} className={className} style={{...style,position: 'absolute',...$position}}>\n                <Tabstrip className='header'\n                    ref={component => this.tabstrip = component}\n                    style={{position: 'absolute',top: 0,left: 0, width: $position.width, height: tabstripHeight}}\n                    draggable={isDraggable}\n                    selected={active}\n                    dragging={this.state.dragging}\n                    onMouseDown={e => this.handleMouseDown(e)}\n                    onSelectionChange={(selected, idx) => this.handleTabSelection(selected, idx)}>{tabs}</Tabstrip>\n                {this.renderChildren()}\n            </div>\n        );\n    }\n\n    renderChildren(){\n\n        const {children, onLayout} = this.props;\n        const {layoutModel: {active=0, children: layoutChildren}} = this.state;\n        const child = children[active]\n\n        var childLayoutModel = layoutChildren[active];\n\n        var {title, style={}, ...childProps} = child.props;\n\n        var id = childLayoutModel.$id;\n\n        style={...style, ...childLayoutModel.style}; // TODO shouldn't layoutModel be the sole source of tryth for style ?\n\n        var props = {\n            id,\n            key: id,\n            container: this,\n            onLayout,\n            onConfigChange: this.handleConfigChange,\n            title: title,\n            layoutModel: childLayoutModel\n        };\n\n        if (isLayout(child)){\n            return React.cloneElement(child, {...props,style});\n        } else {\n            return <LayoutItem {...childProps} {...props} style={style}>{child}</LayoutItem>;\n        }\n    }\n\n    // duplicated from flexBox as an experiment, wh can't this be moved entirely to Container\n    componentWillReceiveProps(nextProps) {\n        var { layoutModel } = nextProps;\n        if (layoutModel && layoutModel !== this.state.layoutModel) {\n            this.setState({ layoutModel });\n        } else if (this.state.layoutModel.$path === '0') {\n        // special handling if we are at the root of a layout\n        // should handle this in Container\n            const {style: {width, height, visibility}} = nextProps;\n            const {style} = this.props;\n            if (width !== style.width || height !== style.height || visibility !== style.visibility) {\n                const VISIBLE = visibility || 'visible';\n                const FORCE_LAYOUT = true;\n                this.setState({\n                    layoutModel: applyLayout(\n                        this.state.layoutModel,\n                        { width, height },\n                        this.state.layoutModel.$path,\n                        VISIBLE,\n                        FORCE_LAYOUT)\n                });\n            }\n\n        }\n    }\n\n    getDragPermission(/* component */){\n        return {x: true,y: true};\n    }\n\n    // getDragBoundingRect(){\n    //     debugger;\n    //     var {top, left, width, height,right, bottom} = ReactDOM.findDOMNode(this).getBoundingClientRect();\n\n    //     var tabstripHeight = this.tabstrip.getDOMNode().clientHeight;\n\n    //     if (this.props.dragContainer === true){\n    //         return {top: top+tabstripHeight, left, width, height: height-tabstripHeight, right, bottom};\n    //     } else {\n    //         return {top, left, width, height, right, bottom};\n    //     }\n    // }\n\n    handleTabSelection(selected, idx){\n        const {onLayout=this.handleLayout} = this.props;\n        const {layoutModel} = this.state;\n        onLayout('switch-tab', {\n            path: layoutModel.$path,\n            idx: this.props.active,\n            nextIdx: idx\n        });\n\n        if (this.props.onTabSelectionChanged){\n            this.props.onTabSelectionChanged(idx);\n        }\n    }\n\n    handleMouseDown(e, model=this.state.layoutModel){\n        e.stopPropagation();\n        const {onLayout=this.handleLayout} = this.props;\n        onLayout('drag-start',{\n            model,\n            evt: e,\n            position: ReactDOM.findDOMNode(this).getBoundingClientRect()});\n    }\n\n}\n\nTabbedContainer.displayName = 'TabbedContainer';\nTabbedContainer.defaultProps = {\n    tabstripHeight: DEFAULT_TABSTRIP_HEIGHT\n}\n\nregisterClass('TabbedContainer', TabbedContainer, true);\n\nfunction titleFor(component){\n\n    var {title, config} = component.props;\n\n    return title || (config && config.title) || 'Tab X';\n\n}\n\nfunction isLayout(element){\n    return element.type.displayName === 'FlexBox' ||\n            element.type.displayName === 'TabbedContainer' ||\n            element.type.displayName === 'DynamicContainer';\n}\n","import React from 'react';\nimport cx from 'classnames';\n\n// need a layout prop and layout state. That way we can accept layout data both via json\n// and vis managing Flexible container\nexport default class Component extends React.Component {\n\n    render() {\n        const className = cx('Component');\n        const {children, id, flexible, onLayout, position, _style, onClick, ...props} = this.props;\n        return (\n            <div className={className} style={this.props.style} onClick={onClick}>\n                {children &&\n                    React.isValidElement(children) && !isHtmlType(children)\n                    ? React.cloneElement(children, { ...props })\n                    : children\n                }\n            </div>\n\n        );\n    }\n}\n\nComponent.defaultProps = {\n    style: {},\n    position: {},\n    _style: {},\n    onClick: () => {}\n}\n\n\nfunction isHtmlType(element){\n    const {type} = element;\n    return typeof type === 'string' && type[0] === type[0].toLowerCase();\n}\n","\nimport React from 'react';\nimport cx from 'classnames';\n\nimport './placeHolder.css';\n\n// Maybe should share a common base with LayoutItem\nexport default class PlaceHolder extends React.Component {\n\n\n    render() {\n\n        var className = cx(\n            \"PlaceHolder\",\n            this.props.className\n        );\n\n        var style = {\n            ...this.props.style,\n            backgroundColor: 'rgb(60,60,60)'\n        }\n\n\n        return (\n            <div className={className} style={style}>\n                <div className=\"close icon-arrow\" onClick={this.handleClose.bind(this)}>\n                    <span>Close</span>\n                </div>\n            </div>\n        );\n    }\n\n    handleClose() {\n        this.props.onLayout('remove');\n    }\n\n\n}\n\nPlaceHolder.defaultProps = {\n    layout: { ready: false }\n};\n","import React from 'react';\nimport Component from '../component';\nimport LayoutItem from '../layout-item';\nimport PlaceHolder from '../placeHolder';\n\nimport { registerClass, ComponentRegistry } from '../componentRegistry';\n\nregisterClass('PlaceHolder', PlaceHolder);\nregisterClass('LayoutItem', LayoutItem);\nregisterClass('Component', Component);\n\nexport function renderDynamicLayout(container, props, layoutModel) {\n\n    var { children, dragContainer, ...remainingProps } = container.props;\n    var { style: propStyle, ...rest } = props;\n    var { active, style: layoutStyle = {} } = layoutModel;\n\n    var finalProps = {\n        ...remainingProps,\n        active,\n        ...rest,\n        layoutModel,\n        style: { ...layoutStyle, ...propStyle }\n    };\n\n    //onsole.log('renderDynamicContainer about to create a new component (fom json) which will be cloned)',layout,finalProps);\n\n    return React.cloneElement(componentFromLayout(layoutModel), finalProps);\n\n}\n\nexport function componentFromLayout(layout) {\n    //onsole.log(`%ccomponentFromLayout\\n${JSON.stringify(json,null,2)}`,'background-color:ivory;color:brown;')\n    return _componentFromLayout(layout);\n}\n\nfunction notSplitterOrLayout(model) {\n    return model.type !== 'Splitter' && model.type !== 'layout';\n}\n\nfunction _componentFromLayout(layoutModel) {\n\n    if (Array.isArray(layoutModel)) {\n        return layoutModel.map(_componentFromLayout);\n    } else if (layoutModel == null) {\n        return null\n    }\n\n    const { $id, $path, type, ...props } = layoutModel;\n    const [ReactType, reactBuiltIn] = getComponentType(type);\n\n    let children;\n\n    if (type === 'Container') {\n        children = null;\n    } else {\n        children = layoutModel.children && layoutModel.children.length\n            ? layoutModel.children.filter(notSplitterOrLayout).map(_componentFromLayout)\n            : null;\n        if (children && children.length === 1) children = children[0];\n    }\n\n    return reactBuiltIn\n        ? <ReactType {...props} key={$id}>{children}</ReactType>\n        : <ReactType {...props} key={$id} layoutModel={layoutModel}>{children}</ReactType>;\n}\n\nfunction getComponentType(type){\n    if (ComponentRegistry[type]){\n        return [ComponentRegistry[type], false];\n    } else if (type === type.toLowerCase()){\n        return [type, true];\n    }\n    throw Error('componentFromLayout: unknown component type: ' + type)\n}\n","import React from 'react';\nimport Container from './container';\nimport { DragContainer } from './draggable';\nimport LayoutItem from './layout-item';\nimport { renderDynamicLayout } from './util/componentFromLayout';\nimport {isLayout} from './util/component-utils'\nimport { registerClass } from './componentRegistry';\n\nexport default class DynamicContainer extends Container {\n\n    componentDidMount(){\n        super.componentDidMount();\n        DragContainer.register(this.state.layoutModel.$path);\n    }\n\n    renderChild(layoutModel, idx) {\n\n        var { layoutModel: { $version }, onLayout } = this.props;\n\n        if ($version === 1 && this.props.children) {\n            // WHAT wa sthis for ?\n            return super.renderChild(layoutModel, idx);\n        }\n\n        var props = {\n            layoutModel,\n            onLayout\n        }\n\n        props.key = props.id = layoutModel.$id;\n\n        if (isLayout(layoutModel.type)) {\n            return this.renderFromLayout(this, props, layoutModel);\n        } else {\n            return <LayoutItem {...props} layout={layoutModel}>{this.renderFromLayout(this, props, layoutModel)}</LayoutItem>;\n        }\n    }\n\n    getState() {\n        return {\n            dragging: -1\n        };\n    }\n\n    // not currently called from FlexBox, but might need to be\n    // routinely called by top-level Container of Application\n    renderFromLayout(element, props, layout) {\n        return renderDynamicLayout(element, props, layout);\n    }\n\n    getLayoutModelChildren() {\n        if (this.props.contentModel) {\n            return [this.props.contentModel];\n        } else {\n            return super.getLayoutModelChildren();\n        }\n    }\n\n    drop(component, dropTarget) {\n\n        this.setState({\n            dragging: -1,\n            tempDimensions: undefined\n        });\n    }\n}\n\nDynamicContainer.displayName = 'DynamicContainer';\nDynamicContainer.defaultProps = {\n    style: { flex: 1 },\n    config: {}\n};\n\n\nregisterClass('DynamicContainer', DynamicContainer, true);\n","import React from 'react';\nimport cx from 'classnames';\nimport LayoutItem from './layout-item';\nimport DynamicContainer from './dynamic-container';\nimport {isLayout} from './util/component-utils';\nimport { handleLayout } from './model/index';\nimport {componentFromLayout} from './util/componentFromLayout';\nimport { registerClass } from './componentRegistry';\nimport { Draggable } from './draggable';\nconst UUID = require('pure-uuid');\n\n\nconst NO_CHILDREN = [];\nconst EMPTY_OBJECT = {};\n\nexport default class Surface extends DynamicContainer {\n\n    constructor(props){\n        super(props);\n        this.handleDragStart = this.handleDragStart.bind(this);\n        this.handleDrag = this.handleDrag.bind(this);\n        this.handleDrop = this.handleDrop.bind(this);\n    }\n\n    getState() {\n        return {\n            dragging: false,\n            draggedIcon: null,\n            draggedComponent: null\n        };\n    }\n\n    render() {\n        var className = cx(\n            this.props.className,\n            'rect-layout',\n            'rect-container',\n            'Surface'\n        );\n\n        const {layoutModel: {children=NO_CHILDREN}, draggedComponent} = this.state;\n        const childrenToRender = draggedComponent\n            ? [...children, draggedComponent]\n            : children\n        \n        return (\n            <div id={this.state.id} className={className} style={this.props.style}>\n                {\n                    childrenToRender.map(\n                        (child, idx) => this.renderChild(child, idx)\n                    )\n                }\n            </div>\n        );\n    }\n\n    renderChild(layoutModel, idx) {\n\n        const { children } = this.props;\n        const child = React.isValidElement(children) && idx === 0\n            ? children\n            : Array.isArray(children) && children[idx]\n                ? children[idx]\n                : componentFromLayout(layoutModel)\n\n        const props = {\n            key: layoutModel.$id,\n            onLayout: this.handleLayout,\n            layoutModel\n        };\n        const dragging = layoutModel === this.state.draggedComponent;\n\n        const style = {\n            ...child.props.style,\n            boxSizing: 'content-box'\n        };\n\n        if (isLayout(child)) {\n            return React.cloneElement(child, { ...props, style });\n        } else {\n            return (\n                <LayoutItem dragging={dragging} {...props} style={style}>{child}</LayoutItem>)\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        const {layoutModel} = nextProps;\n        if (layoutModel && layoutModel !== this.state.layoutModel) {\n            this.setState({layoutModel});\n        } else {\n        // QUESTION: is this reliable ? WOn't the children be different array/\n        // instances, even though nothing has changed ?\n        // how do we update the layoutModel if we aquire/lose children in mid-flight ?\n            // const { children } = nextProps;\n\n            // if (differentChildren(children, this.props.children) && Array.isArray(children)) {\n\n            //     const { layoutModel } = this.state;\n\n            //     // temp hardcoding to test the principal - we need to be able to map \n            //     // children to layoutModel.children\n            //     // this works because sample surface gives ID to all children\n            //     // and new child is aways last\n\n            //     const idx = children.length - 1;\n            //     const lastChild = children[idx];\n\n            //     this.setState({\n            //         layoutModel: {\n            //             ...layoutModel,\n            //             children: [\n            //                 ...layoutModel.children,\n            //                 layout(this.getLayoutModelChild(lastChild), {}, `${layoutModel.$path}.${idx}`)\n            //             ]\n            //         }\n\n            //     });\n            // }\n\n        }\n\n    }\n\n    renderChildren() {\n        return null;\n    }\n\n    getDragPermission(/*component*/) {\n        return { x: true, y: true }\n    }\n\n    handleDragStart({model, position, instructions=EMPTY_OBJECT}, e){\n        var {top,left} = position;\n\n        // Can we find a better way than these clumsy instructions\n\n        const layoutModel = !instructions.DoNotRemove\n            ? handleLayout(this.state.layoutModel,'remove', {targetNode: model})\n            : this.state.layoutModel;\n\n        const {draggableWidth: width,\n            draggableHeight: height,\n            ...dragTransform} = Draggable.initDrag(e, layoutModel, model.$path, position, {\n            drag: this.handleDrag,\n            drop: this.handleDrop\n        });\n\n        var {$path, layout: modelLayout, style, dragAsIcon, ...rest} = model;\n        const layout = modelLayout\n            ? {width, height, ...modelLayout, top, left}\n            : {top, left, width, height}\n\n\n        var draggedIcon = dragAsIcon\n            ? componentFromLayout({\n                type: 'ComponentIcon',\n                color: 'red',\n                style: {...style, position: 'absolute', width: 120, height: 45, visibility: 'visible'},\n                layout\n            })\n            : undefined;\n\n        // what if draggedComponent is a Layout ?    \n        var draggedComponent = dragAsIcon\n            ? {$id: new UUID(1), $path, layout, style, ...rest}\n            : {\n                ...rest,\n                style: {\n                    ...style,\n                    position: 'absolute',\n                    ...(!instructions.DoNotTransform && dragTransform),\n                    visibility: 'visible'\n                },\n                layout,\n                children: [{\n                    type: 'layout', style: {}, layout: {...layout, top: 0, left: 0}\n                }]\n            };\n\n            // don't set dragging yet, it will suppress the final render of app with draggedComonent\n        // removed.\n        this.setState({\n            dragX: left,\n            dragY: top,\n            draggedIcon,\n            draggedComponent,\n            layoutModel\n        });\n\n        return true;\n\n    }\n\n    handleDrag(x,y){\n\n        const {draggedComponent} = this.state;\n        let {layout, style} = draggedComponent;\n\n        if (typeof x === 'number' && x !== layout.left){\n            layout = {...layout, left: x}\n            style = {...style, left: x}\n        }\n\n        if (typeof y === 'number' && y !== layout.top){\n            layout = {...layout, top: y}\n            style = {...style, top: y}\n        }\n\n        if (layout !== draggedComponent.layout){\n            this.setState({\n                dragging: true,\n                draggedComponent: {\n                    ...draggedComponent,\n                    style,\n                    layout\n                }\n            });\n        }\n    }\n\n    handleDrop(dropTarget){\n        const {draggedComponent} = this.state;\n        this.setState({draggedComponent: undefined, draggedIcon: undefined, dragging: false});\n        // TODO need somehow to animate dropped component to final resting place\n        /* \n            perhaps rerender new layout, bt mke new component a placeholder\n            measure new position\n            animate dragged component to new location\n            show new component & hide draggee\n            -- becomes a lot more efficient if we render all to a flat plane\n        */\n        this.handleLayout('drop', {draggedComponent, dropTarget});\n    }\n\n}\nSurface.displayName = 'Surface';\nregisterClass('Surface', Surface, true);\n","import React from 'react';\nimport cx from 'classnames';\nimport LayoutItem from './layout-item';\n\nexport default function DragSurface(props) {\n\n    var { style, children: child, x, y } = props;\n\n    var draggedComponent = null;\n    var visibility = child ? 'visible' : 'hidden';\n\n    if (child) {\n\n        let { style: childStyle/*, ...rest */} = child.props;\n\n        var layoutModel = child.props.layoutModel;\n\n        let childProps = {\n            key: layoutModel.$id,\n            layoutModel\n        };\n\n        childStyle = { // ...rest ?\n            ...childStyle,\n            borderWidth: 3,\n            borderStyle: 'solid',\n            borderColor: '#ccc',\n            boxSizing: 'content-box'\n        };\n\n        if (y !== undefined && x !== undefined) {\n\n            childProps.layoutModel = {\n                ...layoutModel,\n                layout: { ...layoutModel.layout, top: y, left: x }\n            }\n        }\n\n        draggedComponent =\n            <LayoutItem {...childProps} style={childStyle}>\n                {child}\n            </LayoutItem>;\n\n    }\n\n    var className = cx(\n        'DragSurface',\n        'rect-layout',\n        'rect-container',\n        'Surface',\n        props.className);\n\n    return (\n        <div className={className} style={{ ...style, visibility }}>\n            {draggedComponent}\n        </div>\n    );\n\n}\n","import React, {Component} from 'react'\nimport cx from 'classnames';\nimport {registerClass} from '../componentRegistry';\n\nexport default class ComponentIcon extends Component {\n\n\trender(){\n\t\tconst {color, text, style} = this.props;\n\t\tconst className = cx('ComponentIcon', this.props.className);\n\t\tconsole.log(`ComponentIcon color=${color}`);\n\n\t\treturn (\n\t\t\t<div className={className}\n\t\t\t\tstyle={{...style,backgroundColor:color}}>\n\t\t\t\t<span>{text}</span>\n\t\t\t\t{this.props.children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nregisterClass('ComponentIcon', ComponentIcon);\n","import {LAYOUT_MODEL, DROP, LAYOUT_REMOVE, LAYOUT_SWITCH_TAB, LAYOUT_REPLACE} from './actions';\n\nimport {handleLayout} from '../model/index';\n\n// Make sure we don't handle any layout actions before the layoutModel has\n// been initialized\n\nexport default function layoutReducer(state=null, {type, ...action}){\n\t\n\t//onsole.log(`%clayoutReducer ${type} ${JSON.stringify(action)}` ,'color:white;background-color:green;font-weight:bold;');\n\n    switch (type){\n\n    case LAYOUT_MODEL: \treturn action.layoutModel;\n    \n    case LAYOUT_REMOVE: return handleLayout(state, 'remove', action);\n\n    case LAYOUT_REPLACE : return handleLayout(state, 'replace', action);\n    \n    case LAYOUT_SWITCH_TAB : return handleLayout(state, 'switch-tab', action);\n\n    case DROP : return handleLayout(state, 'drop', action); \t\n       \n    default:  return state;\n\n}\n\n\n}\n\nexport const getLayoutModel = state => state.layoutModel;","\nimport React from 'react';\nimport {Surface} from './layoutContainers';\nimport './components/ComponentIcon';\nimport {followPath} from './model/index';\nimport cx from 'classnames';\nimport {\n    switchTab,\n    replace as replaceInLayout\n} from './redux/actions';\nimport {getLayoutModel} from './redux/layoutReducer';\nimport './application.css';\n\nconst UUID = require('pure-uuid');\n\n\n// Redux -------------------------\n// import { createStore, combineReducers, applyMiddleware, compose } from 'redux';\n// import componentState from './redux/componentReducer';\n// import thunk from 'redux-thunk';\n\nconst NO_STYLE = {}\n\nexport default class Application extends React.Component {\n\n    constructor(props){\n        super(props);\n\n        var {width: appWidth, height: appHeight, dialogs=[], style: {width=appWidth, height=appHeight, backgroundColor}=NO_STYLE} = props;\n\n        this.resizeListener = this.resizeListener.bind(this);\n        // const reduxDevTools = window.devToolsExtension ? window.devToolsExtension() : f => f;\n\n        // const reducers = combineReducers({\n        //     ...this.props.reducers,\n        //     componentState,\n        //     layoutModel\n        // });\n\n        // this.store = createStore(\n        //     reducers,\n        //     compose(applyMiddleware(thunk/*, logger*/), reduxDevTools)\n        // );\n\n        // this.store.subscribe(this.handleChange);\n\n        this.state = {\n            height,\n            width,\n            backgroundColor,\n            content: this.props.layout, // REALLY ???\n            draggedComponent: null,\n            dialogs,\n            hasError: false\n            // layoutModel: this.getLayoutModel(width, height)\n        };\n\n        // this.props.bootstrap(this.store.dispatch);\n    }\n\n    componentDidCatch(error, info){\n        console.log(`error`,error)\n        this.setState({hasError: true})\n    }\n\n    render(){\n        // dragging will suppress render in all children except the DragSurface\n        const {width, height, backgroundColor, dragging, hasError} = this.state;\n        const style = {position: 'absolute', top: 0, left: 0,width,height, backgroundColor};\n        const className = cx('Application', this.props.className);\n\n        //TODO make the default Container a Surface, which can host dialogs/popups as well\n        // as root layout. Default style will be 100% x 100%\n        //TODO maybe DragSurface should be part of Surface ?\n\n        // TRY scrap the DragSurface. pass dragging to each child. If it is set and they do not\n        // match do not render. So dialogs can be moved without dom removal. Layout items \n        // will be transplanted to Surface. Means every container and LayoutItem will have to\n        // implement this in shouldComponentUpdate\n        // if (nextProps.dragOperation && nextProps.dragOperation.draggedComponent !== this)\n\n        // we want something like \n        // <Surface dragOperation={{draggedComponent,x,y}}\n\n        if (hasError){\n            return <div style={style} className={className}>Error</div>\n        }\n\n        return (\n            <div style={style} className={className}>\n                <Surface layoutModel={this.props.layoutModel}\n                    style={{width,height}}\n                    dragging={dragging}\n                    onLayout={(command, options) => this.handleLayout(command, options)}\n                    onLayoutModel={this.props.onLayoutModel}>\n                    {this.getContent()}\n                </Surface>\n            </div>\n        );\n    }\n\n    getContent(){\n\n        var {children} = this.props;\n        var {dialogs} = this.state;\n\n        if (React.isValidElement(children)){\n            if (dialogs.length === 0){\n                return children;\n            }\n            else {\n                children = [children];\n            }\n        }\n\n        return children.concat(dialogs);\n\n    }\n\n    // handleChange = () => {\n    //     const layoutModel = getLayoutModel(this.store.getState());\n\n    //     // console.log(`Application.handleChange \n    //     // \tstate version ${this.state ? this.state.layoutModel.$version : 'null'}\n    //     // \tstore version ${layoutModel ? layoutModel.$version : 'null'}`);\n\n    //     if (layoutModel !== null && layoutModel !== this.state.layoutModel){\n    //         //onsole.log(`Application:store change triggers setState EXPECT RENDER`);\n    //         this.setState({layoutModel});\n    //     }\n    // }\n\n    getLayoutModel(width, height, id=new UUID(1)){\n\n        console.log(`%cApplication.getLayoutModel width ${width} height ${height} id ${id}`,'color:blue;font-weight:bold');\n        return {\n            type: 'Surface', // Should it be 'Application' ?\n            $id: id,\n            $path: '0',\n            $version: 1,\n            style: {position: 'absolute', width, height},\n            layout: {top: 0,left: 0, width, height},\n            children: []\n        };\n\n    }\n\n    componentDidMount(){\n        window.addEventListener('resize', this.resizeListener, false);\n        // this.store.dispatch(initializeLayoutModel(this.state.layoutModel));\n    }\n\n    componentWillUnmount(){\n        window.removeEventListener('resize', this.resizeListener, false);\n    }\n\n    componentWillReceiveProps(nextProps){\n        const {dialogs} = nextProps;\n        if (dialogs !== this.props.dialogs){\n            // could this mess with dialogs already in state ?\n            this.setState({dialogs});\n        }\n    }\n\n    shouldComponentUpdate(nextProps, nextState){\n        var {width, height} = this.state;\n\n        return  nextState.width !== width || \n                nextState.height !== height ||\n                nextState.draggedComponent !== undefined ||\n                nextState.dialogs !== this.state.dialogs ||\n                nextState.layoutModel !== this.state.layoutModel;\n    }\n\n    resizeListener(){\n        // var {width, height} = document.body.getBoundingClientRect();\n\n        // if (width !== this.state.width || height !== this.state.height){\n\n        //     const {layoutModel} = this.state;\n\n        //     this.store.dispatch(initializeLayoutModel(layout(layoutModel, {top:0,left:0,width,height}, layoutModel.$path, 'visible', true)));\n\n        //     this.setState({\twidth, height });\n        // }\n\n    }\n\n    handleLayout(command, options) {\n\n        if (command === 'dialog'){\n            // const dialog = componentFromLayout(layout(options.component));\n            const {dialogs} = this.state;\t\n            this.setState({\n                dialogs: dialogs.concat(options.component)\n            });\n        } else {\n            var layoutModel = getLayoutModel(this.store.getState());\n\n            if (command === 'replace'){\n                this.store.dispatch(replaceInLayout(followPath(layoutModel, options.model.$path), options.model));\n            } else if (command === 'switch-tab'){\n                const {path, idx, nextIdx} = options;\n                this.store.dispatch(switchTab(path, idx, nextIdx));\n            } else {\n                console.error(`Application.handleLayout dont't know what to do with ${command}`);\n            }\n\n        }\n\n    }\n\n\t// TODO where does this belong\n    getComponentState(componentId){\n\n        const {componentState} = this.store.getState();\n        return componentState[componentId];\n\n    }\n\n}\n\nApplication.defaultProps = {\n    reducers: {},\n    bootstrap: () => {}\n};\n"],"names":["_containers","ComponentRegistry","isContainer","className","registerClass","component","UUID","require","typeOf","element","type","displayName","name","constructor","LayoutProps","resizeable","header","title","active","tabstripHeight","dragStyle","layoutProps","props","results","Object","entries","forEach","key","value","getLayoutModel","$id","id","style","children","isLayout","getLayoutModelChildren","contentModel","React","isValidElement","Array","isArray","filter","child","map","ComponentHeader","Component","render","fixed","minimized","onMouseDown","menu","e","handleMenuClick","onAction","left","clientX","top","clientY","_dialogOpen","_popups","specialKeyHandler","keyCode","length","closeAllPopups","console","log","ReactDOM","unmountComponentAtNode","document","body","querySelector","outsideClickHandler","popupContainers","querySelectorAll","i","contains","target","popupClosed","popupOpened","indexOf","push","window","addEventListener","pos","splice","removeEventListener","PopupService","showPopup","group","position","width","el","createElement","appendChild","cx","keepWithinThePage","hidePopup","query","Popup","componentDidMount","domNode","findDOMNode","boundingClientRect","parentNode","getBoundingClientRect","show","componentWillUnmount","componentWillReceiveProps","nextProps","depth","pendingTask","clearTimeout","close","targetLeft","targetTop","clientWidth","bottom","targetBottom","setTimeout","container","height","firstChild","w","innerWidth","h","innerHeight","overflowH","parseInt","overflowW","subMenuTimeout","MenuItem","state","hasChildMenuItems","nestedMenu","submenuShowing","doAction","disabled","handleClick","handleMouseOver","label","preventDefault","action","data","onMouseOver","idx","defaultProps","Separator","ContextMenu","submenuIdx","menuItems","menuItem","cloneElement","String","handleMenuAction","handleMenuItemMouseOver","componentWillMount","setState","showSubmenu","ComponentContextMenu","targetComponent","maximized","normal","contextMenuItems","componentMenuItems","text","LAYOUT_REMOVE","LAYOUT_REPLACE","LAYOUT_SWITCH_TAB","remove","targetNode","replace","replacementNode","switchTab","path","nextIdx","positionValues","Position","freeze","_position","str","offset","NaN","valueOf","toString","North","South","East","West","Header","Centre","NorthOrSouth","EastOrWest","NorthOrWest","SouthOrEast","Absolute","NORTH","SOUTH","EAST","WEST","HEADER","CENTRE","BoxModel","measure","model","measurements","addMeasurements","smallestBoxContainingPoint","layout","x","y","pointPositionWithinRect","rect","right","posX","posY","pctX","pctY","closeToTheEdge","borderZone","containsPoint","centerBox","quadrant","preX","preY","componentMeasurements","addClientMeasurements","collectChildMeasurements","$path","start","performance","now","tabMeasurements","measureTabs","end","tabs","isSplitter","components","reduce","arr","all","localPreX","localPosX","localPreY","localPosY","flexDirection","prev","next","n","c","subLayout","from","getElementById","tab","followPath","Error","route","slice","paths","split","undefined","join","followPathToParent","nextStep","pathSoFar","targetPath","finalStep","regex","RegExp","SURFACE","TABBED_CONTAINER","NO_CHILDREN","NO_STYLE","CSS_DIGIT","CSS_MEASURE","CSS_REX","BORDER_REX","ROW","COLUMN","FLEX_DIRECTION","yoga","FLEX_DIRECTION_ROW","FLEX_DIRECTION_COLUMN","LAYOUT","FLEXBOX","SPLITTER","BORDER_STYLES","border","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","BORDER_LIST","keys","LAYOUT_STYLES","margin","marginTop","marginRight","marginBottom","marginLeft","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","LAYOUT_LIST","layoutStyleDiff","style1","style2","some","computeLayout","tree","createTree","layoutModel","createYogaTree","node","calculateLayout","DIRECTION_LTR","setLayout","freeRecursive","normalizeLayoutStyles","expandChildren","splitters","getSplitterPositions","list","flex","backgroundColor","match","exec","error","pos1","pos2","pos3","pos4","pos123","paddinggLeft","normalizeBorderStyle","bs","borderColor","rest","boxShadow","borderStyle","DEFAULT_HEADER","parent","parentIsTabbedContainer","parentIsSurface","display","Node","create","increaseCSSMeasure","setCSSMeasure","setDisplay","DISPLAY_FLEX","setFlexDirection","setAlignItems","ALIGN_STRETCH","DISPLAY_NONE","setFlexGrow","setFlexShrink","setFlexBasis","setMargin","EDGE_TOP","getFlexDirection","flexGrow","flexShrink","flexBasis","setPositionType","POSITION_TYPE_ABSOLUTE","setPosition","EDGE_START","setWidth","setHeight","expandedChild","insertChild","ret","thisFlexible","isFlexible","lastFlexible","getComputedLayout","CSS_MEASURE_SETTERS","CSS_MEASURES","measureTop","measureRight","measureBottom","measureLeft","edge","setMeasure","EDGE_ALL","EDGE_END","EDGE_BOTTOM","EMPTY_OBJECT","containerOf","handleLayout","command","options","resizeLayout","replaceChild","result","removeChild","drop","visibility","force","firstNumber","n1","n2","n3","Math","round","firstDefined","m","flexLayout","isActive","computeLayoutYoga","newContainer","draggedComponent","source","dropTarget","tabIndex","before","after","transform","insert","wrap","dropLayoutIntoContainer","targetContainer","absoluteDrop","isDraggableRoot","withTheGrain","againstTheGrain","nodeToBeInserted","nodeAfterWhichToInsert","nodeBeforeWhichToInsert","nodeSize","op","opts","into","size","oneMoreStepNeeded","flexBox","dim","concat","transformOrigin","modelLayout","getLayoutSpec","childLayout","wrapperStyle","wrapper","dimension","shift","resizedTarget","measurement","newLayout","simpleClone","o1","o2","unversioned","value1","value2","property","versionIncrement","$version","clone","overrides","s1","rest1","s2","rest2","noEffectiveOverrides","properties","getOwnPropertyNames","replacement","isTower","isTerrace","isTabset","DEFAULT_HEADER_SPEC","LayoutItem","applyLayout","bind","dragging","_","isSelected","headerHeight","componentStyle","handleMousedown","handleAction","onLayout","self","context","store","unsubscribe","subscribe","myState","getState","dispatch","componentId","config","targetId","removeFromLayout","contextMenu","handleContextMenuAction","onConfigChange","evt","COLOURS","DropMenu","layer","hover","_group","Konva","Group","on","add","visible","isVisible","addPaths","computeMenuPosition","offsetTop","offsetLeft","box","dropTargets","getDropTargets","menuPosition","Path","strokeWidth","fill","pathPosition","removeChildren","unit","lo","count","nextDropTarget","_dropTarget","_multiDropOptions","_currentDropTarget","_dropMenu","_stage","_layer","_konvaDropMenu","_hoverDropTarget","_dropTargetIsTabstrip","_currentTabIndex","_shiftedTab","DropTargetCanvas","canvas","sketchpad","root","insertBefore","t","l","clientHeight","Stage","Layer","prepare","r","b","cssText","classList","clear","hoverDropTarget","dropTargetIsTabstrip","currentTabIndex","draw","SameDropTarget","wasMultiDrop","drawTarget","drawDropOptions","ctx","getContext","tabstrip","drawTabbedOutline","drawOutline","mouseX","mouseY","tabCount","find","lastTab","selector","tabLeft","tabRight","beginPath","lineWidth","inset","gap","setCanvasStyles","strokeStyle","drawTab","stroke","radius","lineJoin","moveTo","lineTo","quadraticCurveTo","closePath","targetPosition","halfHeight","sizeHeight","min","drawRect","halfWidth","sizeWidth","styles","fillStyle","x1","y1","x2","y2","DropTarget","activate","getActiveDropTarget","identifyDropTarget","dragState","getNextDropTarget","constraint","zone","north","south","east","west","eastwest","northsouth","containerPos","positionedAtOuterContainerEdge","isVBox","isTabbedContainer","isHBox","containingComponent","containingBox","closeToTop","closeToRight","closeToBottom","closeToLeft","SCALE_FACTOR","DragState","init","mousePosition","scaleFactor","leadX","trailX","leadY","trailY","scaledWidth","scaledHeight","scaleDiff","leadXScaleDiff","leadYScaleDiff","trailXScaleDiff","trailYScaleDiff","hi","mouse","mousePos","mousePct","outOfBounds","inBounds","dropX","dropXY","call","dropY","update","xy","mouseConstraint","posConstraint","previousPos","diff","dir","max","_dragCallback","_dragStartX","_dragStartY","_dragContainer","_dragState","_dragThreshold","_measurements","_simpleDrag","_dropTargetCanvas","_dragContainers","DragContainer","register","unregister","getDraggable","refs","draggable","Draggable","mouseDownHandler","dragStartCallback","preDragMousemoveHandler","preDragMouseupHandler","initDrag","dragHandler","x_diff","y_diff","mouseMoveDistance","abs","dragMousemoveHandler","dragMouseupHandler","getDragContainer","pathToContainer","maxSteps","steps","dragRect","dragZone","draggableWidth","draggableHeight","currentDropTarget","newX","newY","drag","onDragEnd","Container","isLayoutRoot","$position","renderChild","onLayoutModel","shouldComponentUpdate","getManagedDimension","handleDragStart","_splitter","_mousedown","_direction","Splitter","cursor","_mouseDownHandler","mouseMoved","mouseUp","onDrag","direction","vertical","lastPos","onDragStart","absIdx","clientPos","FlexBox","JSON","stringify","handleMouseDown","renderFlexibleChildren","splitterIdx","layoutChildren","propChildren","childIdx","childLayoutModel","splitterDragStart","splitterMoved","handleSplitterDragEnd","childProps","handleConfigChange","dragContainer","VISIBLE","FORCE_LAYOUT","getDragPermission","splitChildren","identifySplitChildren","distance","idx1","idx2","RESIZE","handleModelLayout","dimensions","assignExplicitSizeToFlexElements","json","OVERFLOW_WIDTH","onClick","Tab","TabstripOverflow","Tabstrip","overflowing","selected","handleTabClick","showOverflow","checkOverflowState","componentDidUpdate","ensureSelectedTabisVisible","freeSpace","measureFreeSpace","selectedIdx","onSelectionChange","tabstripInner","activeTab","tsBox","tbBox","ulBox","tbOffStageRight","floor","ulOffStageLeft","translateX","overflow","findIndex","DEFAULT_TABSTRIP_HEIGHT","TabbedContainer","isDraggable","titleFor","handleTabSelection","renderChildren","onTabSelectionChanged","stopPropagation","flexible","_style","isHtmlType","toLowerCase","PlaceHolder","handleClose","ready","renderDynamicLayout","remainingProps","propStyle","layoutStyle","finalProps","componentFromLayout","_componentFromLayout","notSplitterOrLayout","ReactType","reactBuiltIn","getComponentType","DynamicContainer","renderFromLayout","tempDimensions","Surface","handleDrag","handleDrop","draggedIcon","childrenToRender","boxSizing","instructions","DoNotRemove","dragTransform","dragAsIcon","color","DoNotTransform","dragX","dragY","DragSurface","childStyle","ComponentIcon","Application","appWidth","appHeight","dialogs","resizeListener","content","hasError","componentDidCatch","info","getContent","nextState","replaceInLayout","getComponentState","componentState","reducers","bootstrap"],"mappings":"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"}